<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.1">Jekyll</generator><link href="https://wechaty.js.org/feed.xml" rel="self" type="application/atom+xml" /><link href="https://wechaty.js.org/" rel="alternate" type="text/html" /><updated>2022-02-21T14:09:50+00:00</updated><id>https://wechaty.js.org/feed.xml</id><title type="html">Wechaty</title><subtitle>Conversational RPA SDK for Chatbot Makers</subtitle><entry><title type="html">2022å¯’å‡-ç‹å¤©ç¿-JuziBoté¡¹ç›®å¼€å‘-æœŸä¸­æŠ¥å‘Š-æ™ºèƒ½ä¿¡æ¯åŠ©ç†</title><link href="https://wechaty.js.org/2022/02/17/second-intern-juzibot-report/" rel="alternate" type="text/html" title="2022å¯’å‡-ç‹å¤©ç¿-JuziBoté¡¹ç›®å¼€å‘-æœŸä¸­æŠ¥å‘Š-æ™ºèƒ½ä¿¡æ¯åŠ©ç†" /><published>2022-02-17T00:00:00+00:00</published><updated>2022-02-17T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/02/17/second-intern-juzibot-report</id><content type="html" xml:base="https://wechaty.js.org/2022/02/17/second-intern-juzibot-report/"><![CDATA[<h2 id="æœŸä¸­æŠ¥å‘Š">æœŸä¸­æŠ¥å‘Š</h2>

<h3 id="é¡¹ç›®å‚ä¸äºº">é¡¹ç›®å‚ä¸äºº</h3>

<ul>
  <li>å¯¼å¸ˆï¼šæ®µæ¸…å</li>
  <li>å­¦ç”Ÿï¼šç‹å¤©ç¿</li>
</ul>

<h3 id="é¡¹ç›®è®¡åˆ’">é¡¹ç›®è®¡åˆ’</h3>

<ol>
  <li>01/13-01/17 : æˆåŠŸè¿è¡Œdingdong botï¼Œè¿è¡Œjuzibot åˆæ­¥äº†è§£juzibot æ¨¡å— å¹¶å­¦ä¹ nodejs</li>
  <li>01/18-01/25 : å¼€å§‹æ ¹æ®ç°æœ‰åŠŸèƒ½ä¹¦å†™æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒæ—¶æ·±å…¥äº†è§£juzibotå¯¹åº”æ¨¡å—åŠŸèƒ½</li>
  <li>01/26-02/11 : ç°æœ‰åŠŸèƒ½çš„å®Œå–„ä¸æµ‹è¯•ç”¨ä¾‹çš„æŒç»­ç¼–å†™</li>
  <li>02/12-02/22 : æŠ“å–çš„å¾®ä¿¡é—®ç­”ä¿¡æ¯ï¼Œå¹¶å®Œæˆæ•°æ®æ¸…æ´—</li>
  <li>02/23-02/27 : å¼€å‘å¥å­ç§’å›å¯¹åº”é—®ç­”æœºå™¨äºº,å®Œæˆå¾®ä¿¡é—®ç­”çš„apiæ¥å…¥å¥å­ç§’å›</li>
</ol>

<h3 id="é¡¹ç›®è¿›åº¦">é¡¹ç›®è¿›åº¦</h3>

<ul>
  <li>æµ‹è¯•æ¨¡å—ç¼–å†™
    <ul>
      <li>æ–‡å­—å‘é‡æœåŠ¡ âœ…</li>
      <li>è¯­éŸ³è½¬æ–‡å­—æœåŠ¡ âœ…</li>
      <li>æ ‡ç­¾åŠŸèƒ½æµ‹è¯• âœ…</li>
      <li>æ„å›¾æµ‹è¯•  âœ…</li>
      <li>åˆ é™¤æµ‹è¯•  âœ…</li>
      <li>æ–‡ä»¶æµ‹è¯•  âœ…</li>
      <li>æ–‡ä»¶åˆ é™¤æµ‹è¯•  âœ…</li>
      <li>å…³é”®å­—æµ‹è¯• âœ…</li>
      <li>æˆ‘çš„æ–‡ä»¶æµ‹è¯• âœ…</li>
      <li>é‡å¯æµ‹è¯• âœ…</li>
    </ul>
  </li>
  <li>å°æ©˜å­ğŸŠæ¥å£ç¼–å†™
    <ul>
      <li>åˆ©ç”¨ SentenceTransformers ç¼–å†™ å¥å­-&gt;å‘é‡ API æ›¿æ¢ CPM âœ…</li>
      <li>æµ‹è¯•æ¡†æ¶ å¹¶å®Œæˆç¼–å†™ è¯­éŸ³-&gt;æ–‡å­— æœåŠ¡ API âœ…</li>
      <li>ç¼–å†™ä¸Šè¿° API æµ‹è¯•ä»£ç å¹¶å®Œæˆ docker å°è£… âœ…</li>
    </ul>
  </li>
  <li>æ•°æ®çˆ¬å–
    <ul>
      <li>å¾®ä¿¡å¹¿å‘Šå¸®åŠ©ä¸­å¿ƒ âœ…</li>
      <li>è…¾è®¯å¹¿å‘Šå¸®åŠ©ä¸­å¿ƒ âœ…</li>
      <li>ä¼ä¸šå¾®ä¿¡å¸®åŠ©ä¸­å¿ƒ âœ…</li>
    </ul>
  </li>
</ul>

<h4 id="ç›¸å…³é“¾æ¥">ç›¸å…³é“¾æ¥</h4>

<ul>
  <li><a href="https://github.com/deepdialog/easy_asr">è‡ªåŠ¨è¯­éŸ³è¯†åˆ«</a></li>
  <li><a href="https://github.com/deepdialog/easy_sts">å¥å­è½¬å‘é‡</a></li>
  <li><a href="https://github.com/tianrking/dont_ban_me/tree/master/app/1%E5%BE%AE%E4%BF%A1%E5%B9%BF%E5%91%8A%E5%B8%AE%E5%8A%A9%E4%B8%AD%E5%BF%83/awesome_version">å¾®ä¿¡å¹¿å‘Šæ•°æ®</a></li>
  <li><a href="https://github.com/tianrking/dont_ban_me/tree/master/app/2%E8%85%BE%E8%AE%AF%E5%B9%BF%E5%91%8A%E5%B8%AE%E5%8A%A9%E4%B8%AD%E5%BF%83">è…¾è®¯å¹¿å‘Šæ•°æ®</a></li>
  <li><a href="https://github.com/tianrking/dont_ban_me/tree/master/app/3%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E5%B8%AE%E5%8A%A9%E4%B8%AD%E5%BF%83/awesome_way">ä¼ä¸šå¾®ä¿¡æ•°æ®</a></li>
</ul>

<h3 id="é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ">é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3>

<h4 id="ä½¿ç”¨ä¸ç†Ÿæ‚‰çš„nodejsè¯­è¨€å®Œæˆä»»åŠ¡">ä½¿ç”¨ä¸ç†Ÿæ‚‰çš„nodejsè¯­è¨€å®Œæˆä»»åŠ¡</h4>

<ul>
  <li>é‡åˆ°é—®é¢˜é¦–å…ˆå»ç§¯æçš„æŸ¥é˜…èµ„æ–™ï¼Œå†è¿›è¡Œå¤šç§å°è¯•ï¼Œç„¶åè¯¢é—®è€å¸ˆï¼ŒåŒæ—¶åœ¨è§£å†³é—®é¢˜åè®°å½•é—®é¢˜ï¼Œ åœ¨æ­¤è¿‡ç¨‹ä¸­å­¦ä¼šå¹¶å®ç°äº†ç›¸å…³ç¼–å†™ï¼Œä¹Ÿæé«˜äº†è§„èŒƒä»£ç çš„æ„è¯†ï¼Œæ„Ÿè°¢è€å¸ˆçš„è€å¿ƒå¸®åŠ©ã€‚</li>
</ul>

<h4 id="xiaojuzi-ä¸-fastapi-äº¤äº’">xiaojuzi ä¸ fastapi äº¤äº’</h4>

<ul>
  <li>
    <p>æ€æ ·å°† wechaty æ¥æ”¶åˆ°çš„ æ–‡å­—/å›¾ç‰‡/è¯­éŸ³ ä¸ fastapi è¿›è¡Œäº¤äº’ ï¼Œ ç¡®ä¿å®ƒçš„ä¼ è¾“é«˜æ•ˆï¼Œå¯ä»¥æ¢å¤ã€‚æˆ‘å»å°è¯•æ„å»ºè¯·æ±‚ï¼Œåˆæ²¡æœ‰è¾ƒå¥½çš„æ¥å—å·¥å…·ç”¨ä»¥ç¡®å®šæ˜¯å¦å‘é€äº†ç†æƒ³çš„æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä¸å¾—ä¸å…ˆä» fastapi ç«¯ç¼–å†™å¼€å§‹, é€šè¿‡å¤šæ¬¡å°è¯•ç¼–å†™å¦‚ä¸‹</p>

    <p>python3</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">Item_audio</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
      <span class="n">lol</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
      <span class="n">audio_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
      <span class="n">audio_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    
  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">"/api/audio/"</span><span class="p">)</span>
  <span class="k">async</span> <span class="k">def</span> <span class="nf">create_item</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Item_audio</span><span class="p">):</span>
   
  <span class="n">gg</span><span class="o">=</span><span class="n">item</span><span class="p">.</span><span class="n">audio_data</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"data:audio/silk;base64,"</span><span class="p">,</span><span class="s">""</span><span class="p">)</span>
  <span class="n">audio_data</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">gg</span><span class="p">))</span>
    
</code></pre></div>    </div>

    <p>nodejs</p>

    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">audioFileBox</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">toFileBox</span><span class="p">()</span>
      <span class="kd">const</span> <span class="nx">audio_dir</span> <span class="o">=</span> <span class="nx">audioFileBox</span><span class="p">.</span><span class="nx">name</span>
      <span class="k">await</span> <span class="nx">audioFileBox</span><span class="p">.</span><span class="nx">toFile</span><span class="p">(</span><span class="nx">audioFileBox</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
      <span class="kd">const</span> <span class="nx">body</span> <span class="o">=</span> <span class="p">{</span>
          <span class="na">audio_name</span><span class="p">:</span> <span class="nx">audioFileBox</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
          <span class="na">audio_data</span><span class="p">:</span> <span class="dl">"</span><span class="s2">data:audio/silk;base64,</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">audio_dir</span><span class="p">,</span> <span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">};</span>
      <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">/api/audio/</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">),</span>
          <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span> <span class="p">}</span>
      <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="ç¼–å†™ä¸€ä¸ªé€æ˜çš„dockerfile-çš„å°æŠ€å·§">ç¼–å†™ä¸€ä¸ªâ€é€æ˜â€çš„Dockerfile çš„å°æŠ€å·§</h4>

<ul>
  <li>
    <p>ç¼–å†™ stså’Œasr apiæ—¶å€™å› ä¸ºç¨‹åºè¿è¡Œåˆæ¬¡éœ€è¦ä¸‹è½½æ¨¡å‹, éš¾ä»¥åšåˆ°å¼€ç®±å³ç”¨ï¼Œä½¿ç”¨ COPYå‘½ä»¤åœ¨dockerhubä¸Šæ˜¾ç¤ºä¸€ä¸ªä¸æ˜æ–‡ä»¶ç§»å…¥ ä¸å¤Ÿé€æ˜ å®¹æ˜“ç»™å…¶ä»–äººä½¿ç”¨é€ æˆå›°æƒ‘ï¼Œ æœ€ååˆ©ç”¨shellå†…çš„æ–¹å¼æ¥å®ç°</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  RUN <span class="o">(</span><span class="nb">echo</span> <span class="s2">"py codeâ€œï¼‰ | python3 
</span></code></pre></div>    </div>
  </li>
</ul>

<h4 id="ç¼–å†™çˆ¬è™«çš„è¿‡ç¨‹">ç¼–å†™çˆ¬è™«çš„è¿‡ç¨‹</h4>

<ul>
  <li>
    <p>åœ¨ç¼–å†™xiaojuziçš„è¯­éŸ³è½¬æ–‡å­—æ¨¡å—æ—¶å€™ï¼Œå­¦ä¼šäº† nodejs ä¸‹ fetchçš„ä½¿ç”¨ï¼Œ ä¹Ÿå¯¹ post/get è¯·æ±‚æœ‰äº†ä¸€å®šè®¤è¯†ï¼Œ ç¼–å†™çˆ¬è™«çš„æ—¶å€™ å› ä¸ºç•Œé¢æ˜¯ç”±javascriptæ¸²æŸ“å¾—åˆ°çš„æ— æ³•ä¹‹é—´requestç½‘å€ï¼Œä¹Ÿå°±æ— æ³•å®Œæˆè§£æã€‚</p>
  </li>
  <li>
    <p>èµ·åˆæˆ‘æƒ³ç”¨webscrapyæ’ä»¶æŠ“å–  ä½†æ˜¯æ•ˆç‡å¾ˆä½ ä¹Ÿä¸æ–¹ä¾¿åœ¨æ²¡æœ‰GUIçš„vpsä¸Šæ“ä½œ è¿˜éœ€è¦äººç‚¹å‡»æ˜¾ç„¶ä¸æ˜¯ç†æƒ³çš„è§£å†³æ–¹æ¡ˆ</p>
  </li>
  <li>
    <p>æŸ¥é˜…èµ„æ–™åæˆ‘å†³å®šé€‰ç”¨ selenium æ¡†æ¶æ¥æ¸²æŸ“ç½‘é¡µ ç„¶åä½¿ç”¨ beautifulsoup lxml è¿›è¡Œçˆ¬å–å’Œè§£æ è™½ç„¶å¯ä»¥é€šè¿‡ â€œâ€“headlessâ€ æ–¹å¼ åœ¨vpsä¸Š è¿è¡Œ ä½†æ˜¯ä¸ºäº†ç¡®ä¿ selenium å¯ä»¥å®Œæ•´åŠ è½½å®Œä¸€ä¸ªç•Œé¢ æˆ‘éœ€è¦æ¯æ¬¡éƒ½åŠ ä¸Šè¿›äº”ç§’ç­‰å¾…æ—¶é—´ è¿™æ ·å°±ä¼šå¯¼è‡´çˆ¬å–æ—¶é—´è¿‡é•¿ è€Œä¸”æœ¬èº«æˆ‘å¹¶ä¸çŸ¥é“éœ€è¦å…·ä½“çš„æŠ“å–é‚£äº›url</p>

    <p>selenium é…ç½®</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
  <span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>

  <span class="n">options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
  <span class="n">options</span><span class="p">.</span><span class="n">headless</span> <span class="o">=</span> <span class="bp">True</span>
  <span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--window-size=1920x1080"</span><span class="p">)</span>
  <span class="c1"># options.add_argument("window-size=1920x3000");
</span>  <span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--disable-notifications"</span><span class="p">)</span>

  <span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--headless'</span><span class="p">)</span>
  <span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--disable-gpu'</span><span class="p">)</span><span class="c1">#è°·æ­Œæ–‡æ¡£æåˆ°éœ€è¦åŠ ä¸Šè¿™ä¸ªå±æ€§é¿å…ä½¿ç”¨gpuäº§ç”Ÿbug
</span>    
  <span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'disable-infobars'</span><span class="p">)</span><span class="c1">#éšè—"Chromeæ­£åœ¨å—åˆ°è‡ªåŠ¨è½¯ä»¶çš„æ§åˆ¶"
</span>  <span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'lang=zh_CN.UTF-8'</span><span class="p">)</span>      <span class="c1"># è®¾ç½®ä¸­æ–‡
</span>  <span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'window-size=1920x3000'</span><span class="p">)</span> <span class="c1"># æŒ‡å®šæµè§ˆå™¨åˆ†è¾¨ç‡
</span>  <span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--hide-scrollbars'</span><span class="p">)</span>     <span class="c1"># éšè—æ»šåŠ¨æ¡, åº”å¯¹ä¸€äº›ç‰¹æ®Šé¡µé¢
</span>
  <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="s">"/Users/mac/Desktop/chromedriver"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</code></pre></div>    </div>

    <p>æŠ“å– å¹¶ åˆæ­¥æå–æ•°æ®</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">driver</span><span class="p">.</span><span class="n">title</span><span class="p">)</span>
  <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">driver</span><span class="p">.</span><span class="n">page_source</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'guide__title'</span><span class="p">})):</span>            
      <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'guide__title'</span><span class="p">})))</span>
      <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">","</span><span class="p">)</span>
      <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
      <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
  <span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>    </div>

    <p>è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°é—®é¢˜,è¿™æ—¶å€™å°±å¯ä»¥æ‰“å° selenium æŠ“å–æ—¶å€™çš„ç½‘é¡µæˆªå›¾</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">driver</span><span class="p">.</span><span class="n">get_screenshot_as_file</span><span class="p">(</span><span class="s">'1.png'</span><span class="p">)</span>
</code></pre></div>    </div>

    <p>ä¸ç¨³å®š ï¼Œ è€Œä¸”ä½æ•ˆ</p>
  </li>
  <li>
    <p>çˆ¬è™«çš„ç›®çš„æ˜¯æŠ“å–æ•°æ® æ—¢ç„¶éš¾ä»¥æ¸²æŸ“å¾—åˆ°æ¸²æŸ“ç•Œé¢ ä¸å¦‚ç›´æ¥ä»æ•°æ®è¯·æ±‚åˆ†æçš„è§’åº¦æ¥å¯»æ‰¾è§£å†³æ€è·¯ ï¼Œ äºæ˜¯å°±å†³å®šå°è¯•æŠ“åŒ…å¯»æ‰¾è§£å†³æ–¹æ¡ˆ. é¦–å…ˆé€šè¿‡ æŠ“åŒ…çš„åˆ° post åˆ°æ•°æ® æ„é€  curlè¯·æ±‚ æµ‹è¯•æ˜¯å¦å¯ä»¥çš„åˆ°æ­£ç¡®çš„å“åº”ã€‚</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  curl <span class="s1">'https://open.work.weixin.qq.com/help2/getQusList?lang=zh_CN&amp;ajax=1&amp;f=json&amp;random=310321'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'authority: open.work.weixin.qq.com'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="98", "Microsoft Edge";v="98"'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'accept: application/json, text/plain, */*'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'sec-ch-ua-mobile: ?0'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36 Edg/98.0.1108.51'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'sec-ch-ua-platform: "macOS"'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'origin: https://open.work.weixin.qq.com'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'sec-fetch-site: same-origin'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'sec-fetch-mode: cors'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'sec-fetch-dest: empty'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'referer: https://open.work.weixin.qq.com/help2/pc/15405?person_id=1'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'accept-language: zh-TW,zh-CN;q=0.9,zh;q=0.8,en;q=0.7,en-GB;q=0.6,en-US;q=0.5,zh-HK;q=0.4'</span> <span class="se">\</span>
      <span class="nt">-H</span> <span class="s1">'cookie: pgv_pvid=3686684000; pac_uid=0_3cbd911c9ce83; pgv_info=ssid=s2798911544; pgv_pvi=4654092288; pgv_si=s6420471808; wwrtx.ref=direct; wwrtx.c_gdpr=0; wwrtx.refid=413075501944711; __utma=114362329.896737070.1644833346.1644833346.1644833346.1; __utmc=114362329; __utmz=114362329.1644833346.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); Hm_lvt_f2ba645ba13636ba52b0234381f51cbc=1644833347; Hm_lpvt_f2ba645ba13636ba52b0234381f51cbc=1644833970; uin=o0508195902; skey=@sEUq3VJWl; RK=hA9xBYtEcN; ptcz=f4917937db9babf5c19203049471a3e4d45ea1fe7b770ef9ea93e47e33c0c0f5; wwrtx.i18n_lan=cht'</span> <span class="se">\</span>
      <span class="nt">--data-raw</span> <span class="s1">'{"person_id":1,"doc_id":15405}'</span> <span class="se">\</span>
      <span class="nt">--compressed</span>
</code></pre></div>    </div>

    <p>è¿™æ˜¯æ¯”è¾ƒæ‚ä¹±å¤æ‚çš„ï¼Œæˆ‘å°è¯•ç»™å®ƒç®€åŒ– åˆ å»å¯¹äºè·å–æ•°æ®è€Œè¨€ä¸å¿…è¦çš„éƒ¨åˆ†ï¼Œçš„åˆ°ä¸‹é¢çš„æ–¹æ³•</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c">#https://open.work.weixin.qq.com/help2/getQusList?lang=zh_CN&amp;ajax=1&amp;f=json&amp;random=569866 è¿™ä¸ªæ˜¯æµè§ˆå™¨è®¿é—®çš„ç½‘å€ ä¸‹é¢æ˜¯å®é™…çš„è¯·æ±‚</span>
  curl <span class="s1">'https://open.work.weixin.qq.com/help2/getQusList?lang=zh_CN&amp;ajax=1&amp;f=json&amp;random=310321'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36 Edg/98.0.1108.51'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'referer: https://open.work.weixin.qq.com/help2/pc/15405?person_id=1'</span> <span class="se">\</span>
  <span class="nt">--data-raw</span> <span class="s1">'{"person_id":1,"doc_id":15405}'</span> 
</code></pre></div>    </div>

    <p>ä¸ºäº†ç¡®ä¿å¯é æ€§ï¼Œ curlå¤åˆ¶ç²˜è´´éå¸¸æ–¹ä¾¿ï¼Œ åœ¨å¦ä¸€å°vpsä¸Šä¹Ÿè¿›è¡Œäº†æµ‹è¯•ï¼Œçš„ç¡®å¯ä»¥çš„åˆ°æ­£ç¡®çš„æ•°æ®è¿”å›ï¼Œä¸‹é¢å°±æ˜¯æŠŠå®ƒè½¬æ¢æˆ requests çš„è¯·æ±‚ èå…¥åˆ°ä»£ç é‡Œã€‚</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  headers <span class="o">=</span> <span class="o">{</span>
  <span class="s1">'user-agent'</span>: <span class="s1">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36 Edg/98.0.1108.51'</span>,
  <span class="s1">'referer'</span>: <span class="s1">'https://open.work.weixin.qq.com/help2/pc/15405?person_id=1'</span>,
  <span class="o">}</span>

  params <span class="o">=</span> <span class="o">(</span>
      <span class="o">(</span><span class="s1">'lang'</span>, <span class="s1">'zh_CN'</span><span class="o">)</span>,
      <span class="o">(</span><span class="s1">'ajax'</span>, <span class="s1">'1'</span><span class="o">)</span>,
      <span class="o">(</span><span class="s1">'f'</span>, <span class="s1">'json'</span><span class="o">)</span>,
      <span class="o">(</span><span class="s1">'random'</span>, <span class="s1">'310321'</span><span class="o">)</span>,
  <span class="o">)</span>

  data <span class="o">=</span> <span class="s1">'{"person_id":1,"doc_id":15405}'</span>
</code></pre></div>    </div>

    <p>æ­¤æ—¶å°±å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹åˆ°è¯·æ±‚çš„ç»“æ„ï¼Œå¤§æ¦‚ç‡å¯ä»¥çŒœåˆ° è¦ä¹ˆè¿™ä¸ª random æ˜¯ä¸ªå‡çš„ random å®é™…ä¸Šæ˜¯åšæ–‡ä»¶ç´¢å¼•çš„ï¼Œ è¦ä¹ˆå®ƒæ˜¯ä¸ªçœŸçš„random åšé˜²æ­¢çˆ¬è™«æ£€æµ‹ç”¨ï¼Œè€Œæˆ‘ä»¬è¦çš„å¯¹åº”æ–‡æ¡£å­˜å‚¨å°±ä¸º doc_id ã€‚ é€šè¿‡è„šæœ¬æµ‹è¯•ä¸€ä¸‹ï¼Œå¾ˆå¿«å°±ç¡®å®šäº† doc_id å¯¹åº”çš„çœŸçš„æ˜¯doc è€Œrandomä¹Ÿæ˜¯çœŸçš„éšæœº ğŸ˜‚ğŸ˜‚ğŸ˜‚ğŸ˜‚ğŸ˜‚ äºæ˜¯ æˆ‘ä»¬å¯ä»¥åœ¨æœ€ç®€çš„åŸºç¡€ä¸Šå†ååŠ å›ä¹‹å‰çš„å‚æ•° ä½œç”¨æ˜¯ä¼ªè£…çš„æ›´çœŸå® é˜²æ­¢è¢«ban å¾—åˆ°ä¸‹è¾¹æœ€ç»ˆæ„é€ ä»£ç </p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">import</span> <span class="nn">requests</span>
  <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">'authority'</span><span class="p">:</span> <span class="s">'open.work.weixin.qq.com'</span><span class="p">,</span>
      <span class="s">'sec-ch-ua'</span><span class="p">:</span> <span class="s">'" Not A;Brand";v="99", "Chromium";v="98", "Microsoft Edge";v="98"'</span><span class="p">,</span>
      <span class="s">'accept'</span><span class="p">:</span> <span class="s">'application/json, text/plain, */*'</span><span class="p">,</span>
      <span class="s">'content-type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
      <span class="s">'sec-ch-ua-mobile'</span><span class="p">:</span> <span class="s">'?0'</span><span class="p">,</span>
      <span class="s">'user-agent'</span><span class="p">:</span> <span class="s">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36 Edg/98.0.1108.51'</span><span class="p">,</span>
      <span class="s">'sec-ch-ua-platform'</span><span class="p">:</span> <span class="s">'"macOS"'</span><span class="p">,</span>
      <span class="s">'origin'</span><span class="p">:</span> <span class="s">'https://open.work.weixin.qq.com'</span><span class="p">,</span>
      <span class="s">'sec-fetch-site'</span><span class="p">:</span> <span class="s">'same-origin'</span><span class="p">,</span>
      <span class="s">'sec-fetch-mode'</span><span class="p">:</span> <span class="s">'cors'</span><span class="p">,</span>
      <span class="s">'sec-fetch-dest'</span><span class="p">:</span> <span class="s">'empty'</span><span class="p">,</span>
      <span class="s">'referer'</span><span class="p">:</span> <span class="s">'https://open.work.weixin.qq.com/help2/pc/15405?person_id=1'</span><span class="p">,</span>
      <span class="s">'accept-language'</span><span class="p">:</span> <span class="s">'zh-TW,zh-CN;q=0.9,zh;q=0.8,en;q=0.7,en-GB;q=0.6,en-US;q=0.5,zh-HK;q=0.4'</span><span class="p">,</span>
      <span class="s">'cookie'</span><span class="p">:</span> <span class="s">'pgv_pvid=3686684000; pac_uid=0_3cbd911c9ce83; pgv_info=ssid=s2798911544; pgv_pvi=4654092288; pgv_si=s6420471808; wwrtx.ref=direct; wwrtx.c_gdpr=0; wwrtx.refid=413075501944711; __utma=114362329.896737070.1644833346.1644833346.1644833346.1; __utmc=114362329; __utmz=114362329.1644833346.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); Hm_lvt_f2ba645ba13636ba52b0234381f51cbc=1644833347; Hm_lpvt_f2ba645ba13636ba52b0234381f51cbc=1644833970; uin=o0508195902; skey=@sEUq3VJWl; RK=hA9xBYtEcN; ptcz=f4917937db9babf5c19203049471a3e4d45ea1fe7b770ef9ea93e47e33c0c0f5; wwrtx.i18n_lan=cht'</span><span class="p">,</span>
  <span class="p">}</span>

  <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
      <span class="p">(</span><span class="s">'lang'</span><span class="p">,</span> <span class="s">'zh_CN'</span><span class="p">),</span>
      <span class="p">(</span><span class="s">'ajax'</span><span class="p">,</span> <span class="s">'1'</span><span class="p">),</span>
      <span class="p">(</span><span class="s">'f'</span><span class="p">,</span> <span class="s">'json'</span><span class="p">),</span>
      <span class="p">(</span><span class="s">'random'</span><span class="p">,</span> <span class="s">'22340'</span><span class="p">),</span>
  <span class="p">)</span>

  <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
      <span class="c1">## num ç¼–å·ä¸ºä¸»æ–‡æ¡£å¯¹åº”åºå·
</span>      <span class="n">data</span> <span class="o">=</span> <span class="s">'{"person_id":1,"doc_id":%s}'</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

      <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://open.work.weixin.qq.com/help2/getQusList'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

</code></pre></div>    </div>

    <p>è¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„éå†äº†ï¼Œä½†æ˜¯ æˆ‘ä»¬ä¸çŸ¥é“åˆ°åº•å“ªäº›URLæ‰æœ‰æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œäºæ˜¯å°±éœ€è¦è¿›è¡Œæš´åŠ›éå†ï¼Œ è¿™æ—¶å€™ python çš„å¼‚å¸¸å¤„ç†æ¨¡å—å˜å¾—éå¸¸é€‚ç”¨ ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­ æ˜¯å¦è¿”å›å€¼æ­£å¸¸ è‹¥å¼‚å¸¸ç›´æ¥è¯·æ±‚ä¸‹ä¸€ä¸ªå³å¯ï¼Œ ç„¶åå°†æ­£ç¡®çš„æ•°æ®åˆ©ç”¨pandasç›´æ¥æ•´ç†æˆcsv</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="k">try</span><span class="p">:</span>
          <span class="n">Q</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'helpdocument'</span><span class="p">][</span><span class="s">'qusList'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'title'</span><span class="p">]</span>
          <span class="n">A_md</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'helpdocument'</span><span class="p">][</span><span class="s">'qusList'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'content_md'</span><span class="p">]</span>
          <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
                  <span class="p">[</span><span class="n">Q</span><span class="p">,</span><span class="n">A_md</span><span class="p">]],</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Q'</span><span class="p">,</span><span class="s">'A'</span><span class="p">],</span>
                  <span class="p">)</span>
          <span class="n">df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data_all_in_one/QA_7k.csv'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'a'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            
      <span class="k">except</span><span class="p">:</span>
          <span class="k">continue</span>
</code></pre></div>    </div>

    <p>æ­¤æ—¶ åŸºæœ¬çš„éƒ¨åˆ†å·²ç»å®Œæˆï¼Œ ä½†æ˜¯é€ä¸ªéå†é€Ÿåº¦è¿˜æ˜¯å¤ªæ…¢ äºæ˜¯èå…¥äº†å¤šçº¿ç¨‹</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">request_api</span><span class="p">(</span><span class="n">T_name</span><span class="p">,</span><span class="n">begin</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
      <span class="n">xxx</span>
  <span class="k">try</span><span class="p">:</span>
      <span class="n">begin</span> <span class="o">=</span> <span class="mi">13000</span>
      <span class="c1"># 15000-16000 1k  # 16000-17000 2k # 17000-18000 3k # 18000-19000 4k
</span>      <span class="c1"># 19000-20000 5k # 14000-15000 6k $ 13000-14000 7k
</span>      <span class="n">end</span> <span class="o">=</span> <span class="mi">14000</span>
      <span class="nb">sum</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">begin</span>
      <span class="n">step</span> <span class="o">=</span> <span class="mi">4</span>
      <span class="n">time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">sum</span> <span class="o">/</span> <span class="n">step</span><span class="p">)</span>

      <span class="c1">## è¿™é‡Œå¯ä»¥å¾ªç¯ ä½†æ˜¯æ²¡å¿…è¦ 
</span>      <span class="n">_thread</span><span class="p">.</span><span class="n">start_new_thread</span><span class="p">(</span><span class="n">request_api</span><span class="p">,</span> <span class="p">(</span><span class="s">"Thread-1"</span><span class="p">,</span> <span class="mi">0</span><span class="o">+</span><span class="n">begin</span> <span class="p">,</span> <span class="n">begin</span><span class="o">+</span><span class="n">time</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">_thread</span><span class="p">.</span><span class="n">start_new_thread</span><span class="p">(</span><span class="n">request_api</span><span class="p">,</span> <span class="p">(</span><span class="s">"Thread-2"</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">time</span> <span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">time</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">_thread</span><span class="p">.</span><span class="n">start_new_thread</span><span class="p">(</span><span class="n">request_api</span><span class="p">,</span> <span class="p">(</span><span class="s">"Thread-3"</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">time</span><span class="o">*</span><span class="mi">2</span> <span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">time</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> 
      <span class="n">_thread</span><span class="p">.</span><span class="n">start_new_thread</span><span class="p">(</span><span class="n">request_api</span><span class="p">,</span> <span class="p">(</span><span class="s">"Thread-4"</span><span class="p">,</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">time</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span>  <span class="n">begin</span> <span class="o">+</span> <span class="n">time</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">except</span><span class="p">:</span>
      <span class="k">print</span> <span class="p">(</span><span class="s">"Error: æ— æ³•å¯åŠ¨çº¿ç¨‹"</span><span class="p">)</span>
</code></pre></div>    </div>

    <p>æ­¤æ—¶ä¸€ä¸ªå¤šçº¿ç¨‹çš„çˆ¬è™«å°±å®ç°äº† ï¼Œ ç›¸æ¯” selenium æ–¹æ³• é€Ÿåº¦å¿«äº†æ•°åå€ ï¼Œæ•°æ®å¹²å‡€çš„å¤šï¼Œ è€Œä¸”ä»£ç éå¸¸ç®€æ´ ä½¿ç”¨æ—¶å€™ä¿®æ”¹ begin end å°±å¯ä»¥å•¦ã€‚ é•¿æ—¶é—´çˆ¬å–å®¹æ˜“è¢«å°ï¼Œæ‰€ä»¥å°±æ²¡æœ‰ç»™å®ƒåšæˆå…¨è‡ªåŠ¨çš„ã€‚ çˆ¬å»å®Œæ•°æ® æœ€å¥½æ£€æµ‹ä¸€ä¸‹ csvã€‚</p>

    <p>åˆ†æ®µçˆ¬å–å¹¶æ•´ç†æˆcsvå å¯ä»¥ç®€å•çš„ç”¨pandaså†æ¬¡æ¸…æ´—å¹¶åˆå¹¶çš„åˆ°æœ€æ€»æ•°æ®</p>

    <p>å¦å¤–ä¸¤ä¸ªç½‘ç«™çˆ¬å»çš„æ€è·¯ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä¸åŒçš„æ˜¯æ•°æ®åˆæ­¥æ¸…æ´—çš„è¿‡ç¨‹ä¸ä¸€æ ·ï¼Œæœ‰è¶£çš„æ˜¯ï¼Œå¾®ä¿¡å¹¿å‘Šå¸®åŠ©ä¸­å¿ƒ è¯·æ±‚åç›´æ¥ä¸‹è½½åŒ…å«æ‰€æœ‰ä¿¡æ¯çš„json åœ¨æµè§ˆå™¨é‡Œé¢è®¿é—®æ—¶å€™è½¬åœˆ æ˜¾ç¤ºå‡ºæ¥åç‚¹å‡»æŠ“åŒ… æ˜¯æ— æ³•æŠ“å–çš„ å› ä¸ºæ ¹æœ¬å°±æ²¡æœ‰ è¯·æ±‚æ•°æ®çš„è¯·æ±‚ åªæœ‰ç»Ÿè®¡ç‚¹å‡»çš„è¯·æ±‚ æ‰€æœ‰çš„æ•°æ®éƒ½åœ¨åŠ è½½æ—¶å€™ä¸‹è½½å®Œå•¦ æ‰€ä»¥åªéœ€è¦</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  url <span class="o">=</span> <span class="s1">'https://ad.weixin.qq.com/openapi/acms_files/get?filename=data'</span>
  rec <span class="o">=</span> requests.get<span class="o">(</span>url<span class="o">)</span>
  f <span class="o">=</span> open<span class="o">(</span><span class="s1">'data_all.txt'</span>,<span class="s1">'w'</span><span class="o">)</span>
  f.write<span class="o">(</span>rec.text<span class="o">)</span>
  f.close<span class="o">()</span>
</code></pre></div>    </div>

    <p>å†ç”¨ json æå– å’Œ pandas æ¸…æ´—å°±okäº†</p>
  </li>
</ul>

<h3 id="è§†é¢‘å±•ç¤º">è§†é¢‘å±•ç¤º</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://www.youtube.com/embed/TdCtdefyNm4" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="ç­”è¾©æŠ¥å‘Š">ç­”è¾©æŠ¥å‘Š</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="/assets/js/viewer-js/#/assets/2022/02-second-intern-juzibot-report/w0x7ce_gg.pdf" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="é¡¹ç›®é“¾æ¥">é¡¹ç›®é“¾æ¥</h3>

<ul>
  <li>
    <p>é¡¹ç›®é“¾æ¥ï¼š<a href="https://github.com/deepdialog/xiaojuzi">https://github.com/deepdialog/xiaojuzi</a></p>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>è”ç³»æ–¹å¼ï¼šTelegram: @qozob</td>
          <td>Email: me@w0x7ce.eu</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<blockquote>
  <p>Author: <a href="https://github.com/tianrking">@tianrking</a>
Code: <a href="https://github.com/tianrking/xiaojuzi">@tianrking/juzibot</a></p>
</blockquote>]]></content><author><name>tianrking</name></author><category term="article" /><category term="juzibot" /><summary type="html"><![CDATA[æœŸä¸­æŠ¥å‘Š]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/02-second-intern-juzibot-report/cover.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/02-second-intern-juzibot-report/cover.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">2022-åŸºäº5Gå¹³å°å¼€å‘puppetæ¨¡å—æ¥å…¥wechaty</title><link href="https://wechaty.js.org/2022/02/17/wechaty-puppet-walnut-final-report/" rel="alternate" type="text/html" title="2022-åŸºäº5Gå¹³å°å¼€å‘puppetæ¨¡å—æ¥å…¥wechaty" /><published>2022-02-17T00:00:00+00:00</published><updated>2022-02-17T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/02/17/wechaty-puppet-walnut-final-report</id><content type="html" xml:base="https://wechaty.js.org/2022/02/17/wechaty-puppet-walnut-final-report/"><![CDATA[<h2 id="åŸºäº-5g-å¹³å°å¼€å‘-puppet-æ¨¡å—æ¥å…¥-wechaty">åŸºäº 5G å¹³å°å¼€å‘ puppet æ¨¡å—æ¥å…¥ wechaty</h2>

<ul>
  <li>é¡¹ç›®åç§°ï¼šåŸºäº5Gæ¶ˆæ¯çš„ Wechaty Puppet æ¨¡å—çš„è®¾è®¡ä¸å®ç°</li>
  <li>å­¦ç”Ÿï¼šé²è€€é¾™</li>
  <li>å¯¼å¸ˆï¼šè‹ç•…</li>
  <li>é¡¹ç›®ä»‹ç»ï¼š<a href="https://github.com/juzibot/intern/issues/1">https://github.com/juzibot/intern/issues/1</a></li>
  <li>ä»£ç åœ°å€ï¼š<a href="https://github.com/wechaty/puppet-walnut">https://github.com/wechaty/puppet-walnut</a></li>
</ul>

<h3 id="èƒŒæ™¯ä»‹ç»">èƒŒæ™¯ä»‹ç»</h3>

<ul>
  <li>Wechaty ç¤¾åŒºç›®å‰å·²ç»æ”¯æŒå¾®ä¿¡ã€Whatsappã€ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦ç­‰å¸¸è§æµè¡Œå³æ—¶é€šè®¯å·¥å…·ï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡å¤šè¯­è¨€ SDK ï¼ˆæ¯”å¦‚ Python Wechatyï¼‰ è¿›è¡Œè°ƒç”¨ã€‚</li>
  <li><a href="https://wechaty.js.org/2021/03/27/rcs-messaging-chatbot/">5G Chatbot (RCS)</a> æ˜¯è¿‘æœŸä¸­å›½ç”µä¿¡è¿è¥å•†åŸºäº 5G çš„æ¶ˆæ¯æˆ˜ç•¥è½åœ°å¹³å°ï¼Œæœªæ¥çš„ 5G æ‰‹æœºå°†ä¼šå†…ç½® RCS æ¶ˆæ¯çš„å¤„ç†èƒ½åŠ›ã€‚</li>
  <li><a href="https://www.5g-msg.com/#/">ç¡¬æ ¸æ¡ƒç¤¾åŒº</a> çš„ <a href="https://wechaty.js.org/2021/03/27/rcs-messaging-chatbot/">ç”µä¿¡è¿è¥å•†å•†5G Chatbot</a> å¹³å°ã€‚</li>
</ul>

<h3 id="ç›®æ ‡è®¡åˆ’">ç›®æ ‡è®¡åˆ’</h3>

<ul>
  <li>åŸºäº 5G å¹³å°çš„å¼€æ”¾ api è¿›è¡Œå°è£…ï¼Œå®ç°å¯ä»¥æ”¶å‘æ¶ˆæ¯çš„æœºå™¨äºº botã€‚</li>
  <li>ä¸°å¯Œæœºå™¨äººçš„æ‰©å±•æ€§åŠŸèƒ½ï¼Œå®Œå–„å¯¹äº Wechaty çš„ api é€‚é…ã€‚</li>
</ul>

<h3 id="é¡¹ç›®è¿›å±•">é¡¹ç›®è¿›å±•</h3>

<ul>
  <li>åŸºäº 5G å¹³å°çš„å¼€æ”¾ api è¿›è¡Œå°è£…ï¼Œå®ç°ç®€å•çš„<code class="language-plaintext highlighter-rouge">ding-dong-bot</code>ã€‚</li>
  <li>ä¸°å¯Œ 5G çš„æ¶ˆæ¯æ¨¡å¼ï¼Œå®ç°æ”¯æŒå¯Œæ–‡æœ¬ã€æ–‡ä»¶ã€cssç­‰å¤šæ ·æ¶ˆæ¯æ ¼å¼çš„ puppetã€‚</li>
</ul>

<h3 id="éœ€æ±‚åˆ†æä¸è®¾è®¡">éœ€æ±‚åˆ†æä¸è®¾è®¡</h3>

<h4 id="1-wechatyä¸puppetçš„äº¤äº’">1. <code class="language-plaintext highlighter-rouge">Wechaty</code>ä¸<code class="language-plaintext highlighter-rouge">Puppet</code>çš„äº¤äº’</h4>

<p><img src="/assets/2022/02-wechaty-puppet-walnut-final-report/wechatypuppetwalnut.webp" alt="WechatyPuppetWalnut" /></p>

<ul>
  <li>å¼€å‘è€…é€šè¿‡<code class="language-plaintext highlighter-rouge">Wechaty</code>æä¾›çš„ Api æ¥è¿›è¡Œå…·ä½“çš„äº¤äº’æ“ä½œã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">Wechaty</code>åªéœ€è¦å…·ä½“è°ƒç”¨<strong>å¼€å‘è€…æŒ‡å®šçš„<code class="language-plaintext highlighter-rouge">Puppet</code></strong>å³æ­¤å¤„çš„<code class="language-plaintext highlighter-rouge">Walnut</code>æ¥å®ç°å¼€å‘è€…éœ€è¦çš„é€»è¾‘ã€‚</li>
  <li>æˆ‘ä»¬çš„<code class="language-plaintext highlighter-rouge">Walnut</code>ç»§æ‰¿äºæŠ½è±¡çš„<code class="language-plaintext highlighter-rouge">Puppet</code>çˆ¶ç±»ï¼Œå®ç°å…¶é¢„å®šä¹‰çš„æŠ½è±¡æ–¹æ³•æ¥å®ç°å…·ä½“çš„èƒ½åŠ›ã€‚</li>
  <li>å…·ä½“çš„<code class="language-plaintext highlighter-rouge">Walnut</code>ä¼šå’Œ<code class="language-plaintext highlighter-rouge">5G</code>å¹³å°è¿›è¡Œæ•°æ®äº¤äº’ä»è€Œå®ç°çœŸæ­£çš„ ChatBotã€‚</li>
</ul>

<h4 id="2-æŠ½è±¡æ–¹æ³•çš„å®ç°">2. æŠ½è±¡æ–¹æ³•çš„å®ç°</h4>

<p>åœ¨ç»§æ‰¿äº†æŠ½è±¡çˆ¶ç±»ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§è‡ªå·±éœ€è¦å»å®ç°å…·ä½“çš„æ–¹æ³•ã€‚</p>

<ol>
  <li>
    <p>messageMixin: æ¶ˆæ¯ç›¸å…³çš„æŠ½è±¡æ–¹æ³•</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">abstract</span> <span class="nx">messageContact</span>      <span class="p">(</span><span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>                       <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageFile</span>         <span class="p">(</span><span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>                       <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">FileBoxInterface</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageImage</span>        <span class="p">(</span><span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">imageType</span><span class="p">:</span> <span class="nx">ImageType</span><span class="p">)</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">FileBoxInterface</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageMiniProgram</span>  <span class="p">(</span><span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>                       <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">MiniProgramPayload</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageUrl</span>          <span class="p">(</span><span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>                       <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">UrlLinkPayload</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageLocation</span>     <span class="p">(</span><span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>                       <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">LocationPayload</span><span class="o">&gt;</span>
   
<span class="kd">abstract</span> <span class="nx">messageForward</span>         <span class="p">(</span><span class="nx">conversationId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,)</span>                     <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span> <span class="o">|</span> <span class="kr">string</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageSendContact</span>     <span class="p">(</span><span class="nx">conversationId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>                      <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span> <span class="o">|</span> <span class="kr">string</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageSendFile</span>        <span class="p">(</span><span class="nx">conversationId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">file</span><span class="p">:</span> <span class="nx">FileBoxInterface</span><span class="p">)</span>                 <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span> <span class="o">|</span> <span class="kr">string</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageSendMiniProgram</span> <span class="p">(</span><span class="nx">conversationId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">miniProgramPayload</span><span class="p">:</span> <span class="nx">MiniProgramPayload</span><span class="p">)</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span> <span class="o">|</span> <span class="kr">string</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageSendText</span>        <span class="p">(</span><span class="nx">conversationId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">text</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">mentionIdList</span><span class="p">?:</span> <span class="kr">string</span><span class="p">[])</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span> <span class="o">|</span> <span class="kr">string</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageSendUrl</span>         <span class="p">(</span><span class="nx">conversationId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">urlLinkPayload</span><span class="p">:</span> <span class="nx">UrlLinkPayload</span><span class="p">)</span>         <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span> <span class="o">|</span> <span class="kr">string</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">messageSendLocation</span>    <span class="p">(</span><span class="nx">conversationId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">locationPayload</span><span class="p">:</span> <span class="nx">LocationPayload</span><span class="p">)</span>       <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span> <span class="o">|</span> <span class="kr">string</span><span class="o">&gt;</span>
   
<span class="kd">abstract</span> <span class="nx">messageRecall</span> <span class="p">(</span><span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>contactMixin: è”ç³»äººç›¸å…³çš„æŠ½è±¡æ–¹æ³•</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">abstract</span> <span class="nx">contactSelfName</span> <span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>           <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactSelfQRCode</span> <span class="p">()</span>                     <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">string</span> <span class="cm">/* QR Code Value */</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactSelfSignature</span> <span class="p">(</span><span class="nx">signature</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactAlias</span> <span class="p">(</span><span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>                       <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactAlias</span> <span class="p">(</span><span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">alias</span><span class="p">:</span> <span class="kr">string</span> <span class="o">|</span> <span class="kc">null</span><span class="p">)</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactAvatar</span> <span class="p">(</span><span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span>                <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">FileBoxInterface</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactAvatar</span> <span class="p">(</span><span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">file</span><span class="p">:</span> <span class="nx">FileBoxInterface</span><span class="p">)</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactPhone</span> <span class="p">(</span><span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">phoneList</span><span class="p">:</span> <span class="kr">string</span><span class="p">[])</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactCorporationRemark</span> <span class="p">(</span><span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">corporationRemark</span><span class="p">:</span> <span class="kr">string</span> <span class="o">|</span> <span class="kc">null</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactDescription</span> <span class="p">(</span><span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">description</span><span class="p">:</span> <span class="kr">string</span> <span class="o">|</span> <span class="kc">null</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactList</span> <span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">[]</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactRawPayload</span> <span class="p">(</span><span class="nx">contactId</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">any</span><span class="o">&gt;</span>
<span class="kd">abstract</span> <span class="nx">contactRawPayloadParser</span> <span class="p">(</span><span class="nx">rawPayload</span><span class="p">:</span> <span class="kr">any</span><span class="p">)</span> <span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ContactPayload</span><span class="o">&gt;</span>
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="3-ç¼“å­˜æ¨¡å—">3. ç¼“å­˜æ¨¡å—</h4>

<ol>
  <li>
    <p>å½“æˆ‘ä»¬çš„ sever ç›‘å¬åˆ°æœ‰ç”¨æˆ·å‘é€æ¶ˆæ¯ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦å»å¯¹æ¶ˆæ¯çš„å…·ä½“å†…å®¹åšä¸€ä¸ªç¼“å­˜ã€‚</p>

    <p>è¿™é‡Œæˆ‘ä»¬éœ€è¦è‡ªå·±å®ç°ä¸€ä¸ªç¼“å­˜æ¨¡å—ï¼Œå°† message çš„å…·ä½“å†…å®¹å­˜å‚¨è¿›å»ï¼Œå¹¶ä¸”è¿”å› idã€‚</p>

    <blockquote>
      <p>æ¨èæå“æ¡“è€å¸ˆå¼€å‘çš„ç¼“å­˜ç»„ä»¶ï¼š<strong>flash-store</strong>ã€‚ <a href="https://github.com/huan/flash-store">https://github.com/huan/flash-store</a></p>
    </blockquote>
  </li>
  <li>
    <p>ç„¶åæˆ‘ä»¬ç”¨ Puppet è§¦å‘ä¸€ä¸ª message äº‹ä»¶ï¼ŒæŠŠæˆ‘ä»¬æœ¬åœ°ç¼“å­˜çš„ id ä¼ å‡ºå»ã€‚</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">messageId</span><span class="p">:</span> <span class="nx">messageId</span> <span class="p">})</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>è¿™æ—¶å€™ Wechaty å·²ç»æ‹¿åˆ°æˆ‘ä»¬æ¶ˆæ¯çš„ id ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæ ¹æ®ä¸€ä¸ªéœ€è¦æˆ‘ä»¬å®ç°çš„æŸ¥è¯¢æ–¹æ³•æ¥è·å–æœ¬åœ°ç¼“å­˜ã€‚</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">override</span> <span class="k">async</span> <span class="nx">messageRawPayload</span> <span class="p">(</span><span class="nx">messageId</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">WalnutMessagePayload</span> <span class="o">|</span> <span class="kc">undefined</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="nx">log</span><span class="p">.</span><span class="nx">verbose</span><span class="p">(</span><span class="dl">'</span><span class="s1">PuppetWalnut</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">messageRawPayload(%s)</span><span class="dl">'</span><span class="p">,</span> <span class="nx">messageId</span><span class="p">)</span>
  <span class="c1">// è¿™é‡Œæ ¹æ® id å»ç¼“å­˜ä¸­æŸ¥å‡ºæ¥åˆšåˆšå­˜å…¥çš„æ¶ˆæ¯</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>å½“æŸ¥å‡ºå…·ä½“çš„æ¶ˆæ¯å†…å®¹åï¼Œå…¶å®å’Œæˆ‘ä»¬ Wechaty ä¸­é¢„å®šä¹‰çš„æ¶ˆæ¯ç»“æ„å¯èƒ½ä¸å¤ªä¸€è‡´ï¼Œéœ€è¦æˆ‘ä»¬è¿›è¡Œä¸€ä¸ªè½¬æ¢ã€‚</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">override</span> <span class="k">async</span> <span class="nx">messageRawPayloadParser</span> <span class="p">(</span><span class="nx">rawPayload</span><span class="p">:</span> <span class="nx">WalnutMessagePayload</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">PUPPET</span><span class="p">.</span><span class="nx">payloads</span><span class="p">.</span><span class="nx">Message</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="c1">// è¿™é‡Œå®ç°è½¬æ¢è§„åˆ™ï¼šWalnutMessagePayload ===&gt; PUPPET.payloads.Message</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>ä¸è¿‡è¿™é‡Œè¦æ³¨æ„ï¼Œåœ¨æ¯æ¬¡è¿›è¡Œæ”¶å‘æ¶ˆæ¯çš„æ—¶å€™ Wechaty éƒ½ä¼šå»åŠ è½½ä¸€éæˆ‘ä»¬çš„è”ç³»äººç¼“å­˜ã€‚
æ‰€ä»¥å¯¹åº”çš„è”ç³»äººç¼“å­˜çš„æ¨¡å—ä¹Ÿéœ€è¦å®ç°ï¼š</p>

    <ul>
      <li>contactRawPayloa</li>
      <li>contactRawPayloadParser</li>
    </ul>
  </li>
</ol>

<h3 id="é¡¹ç›®æˆæœ">é¡¹ç›®æˆæœ</h3>

<h4 id="1-contact-api-æ”¯æŒ">1. Contact Api æ”¯æŒ</h4>

<ul>
  <li>
    <h4 id="properties"><a href="https://wechaty.js.org/docs/api/contact#properties">Properties</a></h4>

    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Support</th>
          <th>Details</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
          <td><code class="language-plaintext highlighter-rouge">string</code></td>
          <td>Get Contact id. This function is depending on the Puppet Implementation, see <a href="https://github.com/wechaty/wechaty/wiki/Puppet#3-puppet-compatible-table">puppet-compatible-table</a></td>
          <td>âœ…</td>
          <td>Phone number</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <h4 id="instance-methods"><a href="https://wechaty.js.org/docs/api/contact#instance-methods">Instance Methods</a></h4>

    <table>
      <thead>
        <tr>
          <th>Instance Methods</th>
          <th>Return type</th>
          <th>Support</th>
          <th>Details</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>say(text Or Contact Or File)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>âš Contact not Support</td>
        </tr>
        <tr>
          <td>name()</td>
          <td><code class="language-plaintext highlighter-rouge">String</code></td>
          <td>âœ…</td>
          <td>Phone number</td>
        </tr>
        <tr>
          <td>alias(newAlias)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>friend()</td>
          <td><code class="language-plaintext highlighter-rouge">Boolean or null</code></td>
          <td>âœ…</td>
          <td>True</td>
        </tr>
        <tr>
          <td>type()</td>
          <td><code class="language-plaintext highlighter-rouge">ContactType.Unknown or ContactType.Personal or ContactType.Official</code></td>
          <td>âœ…</td>
          <td>ContactType.Personal</td>
        </tr>
        <tr>
          <td>gender()</td>
          <td><code class="language-plaintext highlighter-rouge">ContactGender.Unknown or ContactGender.Male or ContactGender.Female</code></td>
          <td>âœ…</td>
          <td>ContactGender.Unknown</td>
        </tr>
        <tr>
          <td>province()</td>
          <td><code class="language-plaintext highlighter-rouge">String or null</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>city()</td>
          <td><code class="language-plaintext highlighter-rouge">String or null</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>avatar()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Default avatar</td>
        </tr>
        <tr>
          <td>sync()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>self()</td>
          <td><code class="language-plaintext highlighter-rouge">Boolean</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
      </tbody>
    </table>

    <blockquote>
      <p>Default avatar ğŸ‘‰ <a href="https://raw.githubusercontent.com/wechaty/puppet-walnut/main/docs/images/avatar.webp">https://raw.githubusercontent.com/wechaty/puppet-walnut/main/docs/images/avatar.webp</a></p>
    </blockquote>
  </li>
  <li>
    <h4 id="static-methods"><a href="https://wechaty.js.org/docs/api/contact#static-methods">Static Methods</a></h4>

    <table>
      <thead>
        <tr>
          <th>Static Methods</th>
          <th>Return Type</th>
          <th>Support</th>
          <th>Detail</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>find(query)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise &lt;Contact | null&gt;</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>findAll(Query Arguements)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise &lt;Contact []&gt;</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h4 id="2-message-api-æ”¯æŒ">2. Message Api æ”¯æŒ</h4>

<ul>
  <li>
    <h4 id="instance-methods-1"><a href="https://wechaty.js.org/docs/api/message#instance-methods">Instance Methods</a></h4>

    <table>
      <thead>
        <tr>
          <th>Instance methods</th>
          <th>Return type</th>
          <th>Support</th>
          <th>Detail</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>from()</td>
          <td><code class="language-plaintext highlighter-rouge">Contact</code> or <code class="language-plaintext highlighter-rouge">null</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>to()</td>
          <td><code class="language-plaintext highlighter-rouge">Contact</code> or <code class="language-plaintext highlighter-rouge">null</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>room()</td>
          <td><code class="language-plaintext highlighter-rouge">Room</code> or <code class="language-plaintext highlighter-rouge">null</code></td>
          <td>âœ…</td>
          <td>null</td>
        </tr>
        <tr>
          <td>text()</td>
          <td><code class="language-plaintext highlighter-rouge">string</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>say(text Or Contact Or File)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>âš Contact not Support</td>
        </tr>
        <tr>
          <td>type()</td>
          <td><code class="language-plaintext highlighter-rouge">MessageType</code></td>
          <td>âœ…</td>
          <td>Message.Text</td>
        </tr>
        <tr>
          <td>self()</td>
          <td><code class="language-plaintext highlighter-rouge">boolean</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>mention()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>mentionSelf()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>forward(to)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>date()</td>
          <td><code class="language-plaintext highlighter-rouge">Date</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>age()</td>
          <td><code class="language-plaintext highlighter-rouge">Number</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>toFileBox()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>toContact()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>toUrlLink()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <h4 id="static-method"><a href="https://wechaty.js.org/docs/api/message#static-method">Static Method</a></h4>

    <table>
      <thead>
        <tr>
          <th>Static Methods</th>
          <th>Return type</th>
          <th>Support</th>
          <th>Detail</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>find()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>findAll()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h4 id="3-æ¶ˆæ¯æ ¼å¼æ”¯æŒ">3. æ¶ˆæ¯æ ¼å¼æ”¯æŒ</h4>

<table>
  <thead>
    <tr>
      <th>æ¶ˆæ¯ç±»å‹</th>
      <th>ä»å±(æ ¹æ®æ¥å£è¿”å›)</th>
      <th>è·å–æ–¹å¼</th>
      <th>æ¥æ”¶</th>
      <th>å‘é€</th>
      <th>ç¾¤èŠ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>æ–‡æœ¬</td>
      <td><code class="language-plaintext highlighter-rouge">text</code></td>
      <td><code class="language-plaintext highlighter-rouge">message.text</code></td>
      <td>âœ…</td>
      <td>âœ…</td>
      <td>âŒ</td>
    </tr>
    <tr>
      <td>å›¾ç‰‡</td>
      <td><code class="language-plaintext highlighter-rouge">image</code></td>
      <td><code class="language-plaintext highlighter-rouge">message.toImage()</code></td>
      <td>âœ…</td>
      <td>âœ…</td>
      <td>âŒ</td>
    </tr>
    <tr>
      <td>è§†é¢‘</td>
      <td><code class="language-plaintext highlighter-rouge">video</code></td>
      <td><code class="language-plaintext highlighter-rouge">message.toFilebox()</code></td>
      <td>âœ…</td>
      <td>âŒ</td>
      <td>âŒ</td>
    </tr>
    <tr>
      <td>éŸ³é¢‘</td>
      <td><code class="language-plaintext highlighter-rouge">audio</code></td>
      <td><code class="language-plaintext highlighter-rouge">message.toFilebox()</code></td>
      <td>âœ…</td>
      <td>âŒ</td>
      <td>âŒ</td>
    </tr>
    <tr>
      <td>ä½ç½®</td>
      <td><code class="language-plaintext highlighter-rouge">location</code></td>
      <td><code class="language-plaintext highlighter-rouge">message.toLocation()</code></td>
      <td>âŒ</td>
      <td>âŒ</td>
      <td>âŒ</td>
    </tr>
    <tr>
      <td>æ–‡ä»¶</td>
      <td><code class="language-plaintext highlighter-rouge">other</code></td>
      <td><code class="language-plaintext highlighter-rouge">message.toFilebox()</code></td>
      <td>âœ…</td>
      <td>âŒ</td>
      <td>âŒ</td>
    </tr>
    <tr>
      <td>è”ç³»äºº</td>
      <td><code class="language-plaintext highlighter-rouge">other</code></td>
      <td><code class="language-plaintext highlighter-rouge">message.toContact()</code></td>
      <td>âœ…</td>
      <td>âŒ</td>
      <td>âŒ</td>
    </tr>
  </tbody>
</table>

<h3 id="è§†é¢‘å±•ç¤º">è§†é¢‘å±•ç¤º</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://www.youtube.com/embed/gqR2Mbouc4E" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="ç­”è¾©æŠ¥å‘Š">ç­”è¾©æŠ¥å‘Š</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="/assets/2022/02-wechaty-puppet-walnut-final-report/wechaty-puppet-walnut-final-report" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="æœªæ¥ä¸å±•æœ›">æœªæ¥ä¸å±•æœ›</h3>

<ul>
  <li>å¯¹ walnut è¿›è¡Œç»†èŠ‚çš„è¡¥å……å’Œå®Œå–„ã€‚</li>
  <li>å°½å¯èƒ½å¢åŠ å¯¹å…¶ä»–åŠŸèƒ½çš„æ”¯æŒã€å¹¶ä¸”æŒåºç»´æŠ¤ã€‚</li>
</ul>

<blockquote>
  <p>Author: <a href="https://github.com/fabian4">@fabian</a></p>
</blockquote>]]></content><author><name>fabian</name></author><category term="project" /><category term="5g" /><category term="puppet-walnut" /><category term="chatbot" /><category term="ecosystem" /><category term="plan" /><summary type="html"><![CDATA[åŸºäº 5G å¹³å°å¼€å‘ puppet æ¨¡å—æ¥å…¥ wechaty]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/02-wechaty-puppet-walnut-final-report/puppet-walnut.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/02-wechaty-puppet-walnut-final-report/puppet-walnut.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">åŸºäºWechatyçš„é”€å”®åŠ©ç†æœºå™¨äººâ€“é¡¹ç›®ç»“é¡¹æŠ¥å‘Š</title><link href="https://wechaty.js.org/2022/02/10/sales-assistant-final/" rel="alternate" type="text/html" title="åŸºäºWechatyçš„é”€å”®åŠ©ç†æœºå™¨äººâ€“é¡¹ç›®ç»“é¡¹æŠ¥å‘Š" /><published>2022-02-10T00:00:00+00:00</published><updated>2022-02-10T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/02/10/sales-assistant-final</id><content type="html" xml:base="https://wechaty.js.org/2022/02/10/sales-assistant-final/"><![CDATA[<!-- markdownlint-disable MD033 -->

<h2 id="æ‘˜è¦">æ‘˜è¦</h2>

<p>ç»è¿‡ä¸¤ä¸ªæœˆçš„è¿­ä»£ï¼Œé”€å”®åŠ©ç†æœºå™¨äººé€æ¸æˆä¸ºä¸€æ¬¾å¯ç”¨ã€å®ç”¨çš„äº§å“ã€‚æ­¤å ±å‘Šå°‡æ¢³ç†é …ç›®ç”¢å‡ºï¼Œé …ç›®å¯¦ç¾ã€ä»¥åŠéç¨‹ä¸­ç¢°åˆ°å€¼å¾—å­¸ç¿’çš„å•é¡Œã€‚</p>

<h3 id="å½±ç‰‡">å½±ç‰‡</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://www.youtube.com/embed/i45SQ4CrsdE" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="æŠ¥å‘Š">æŠ¥å‘Š</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="/assets/js/viewer-js/#/assets/2022/02-sales-assistant-final/sales-assitant-final-1.pdf" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h2 id="ä¸€å·²å®ç°åŠŸèƒ½è¯´æ˜">ä¸€ã€å·²å®ç°åŠŸèƒ½è¯´æ˜</h2>

<h3 id="ç¸½é…ç½®æµç¨‹">ç¸½é…ç½®æµç¨‹</h3>

<ol>
  <li>
    <p>ã€ç®¡ç†è€…ã€‘åŸ·è¡Œ<a href="https://k0auuqcihb.feishu.cn/docs/doccnKLFrlLJ7kcJIZHDdUhhWGx#jTI2lW">ã€ç”¢å“æº–å‚™1ã€‘</a>å’Œ<a href="https://k0auuqcihb.feishu.cn/docs/doccnKLFrlLJ7kcJIZHDdUhhWGx#yKsQ0A">ã€ç”¢å“æº–å‚™2ã€‘</a>ï¼Œå¾—åˆ°ã€å”®å‰å”®å¾Œåå–®, ä¼æ¥­åç¨±ï¼Œè­¦å ±é…ç½®ï¼Œ2å€‹Vikaè¡¨å–®çš„IDã€‘</p>
  </li>
  <li>
    <p>ã€æŠ€è¡“äººå“¡ã€‘æ ¹æ“šã€å”®å‰å”®å¾Œåå–®, ä¼æ¥­åç¨±ï¼Œè­¦å ±é…ç½®ï¼Œ2å€‹Vikaè¡¨å–®çš„IDã€‘åŸ·è¡Œ<a href="https://k0auuqcihb.feishu.cn/docs/doccnKLFrlLJ7kcJIZHDdUhhWGx#Ry88le">ã€éƒ¨ç½²ç³»çµ±ã€‘</a>ï¼Œä½¿ç³»çµ±ä¸Šç·šï¼Œé€šçŸ¥ã€ç®¡ç†è€…ã€‘ï¼Œæ­£å¼é‹è¡Œ</p>
  </li>
</ol>

<h3 id="åŠŸèƒ½æ¨¡å—1-æ¶ˆæ¯è­¦æŠ¥æœºå™¨äºº">åŠŸèƒ½æ¨¡å—1: æ¶ˆæ¯è­¦æŠ¥æœºå™¨äºº</h3>

<h4 id="åŠŸèƒ½æè¿°">åŠŸèƒ½æè¿°</h4>

<ol>
  <li>æœºå™¨äººåœ¨é£ä¹¦æ¨é€ä¸åŒç­‰çº§çš„æ¶ˆæ¯å¡ç‰‡ï¼Œæé†’é”€å”®ä¹…æœªå›å¤çš„ç¾¤èŠï¼Œé™ä½é”€å”®ä¸ç®¡ç†è€…é™ä½è´Ÿæ‹…ï¼Œå¹¶æé«˜ä¼šè¯æ»¡æ„åº¦ã€‚</li>
  <li>é€šè¿‡JSONæ–‡ä»¶é…ç½®ç»†ç²’åº¦é…ç½®æ¶ˆæ¯å¡ç‰‡ã€è­¦æŠ¥å‘¨æœŸç­‰å‚æ•°ï¼Œå¹¶æ”¯æŒé”€å”®ä¸å”®ååˆ†åˆ«é…ç½®ã€‚ä¾‹å¦‚ï¼š
    <ol>
      <li>è¶…æ—¶ 5ï¼Œ10åˆ†é’Ÿæ¨é€ç»¿ã€é»„è­¦æŠ¥è‡³é£ä¹¦ç§äººç¾¤</li>
      <li>è¶…æ—¶ 20ï¼Œ30ï¼Œ40 åˆ†é’Ÿæ¨é€æ©™ã€çº¢ã€ç´«è­¦æŠ¥è‡³é£ä¹¦ç§äººç¾¤ä¸å…¬å…±ç¾¤</li>
      <li>è¶…å‡º 40 åˆ†é’Ÿåï¼Œæ¯éš”10åˆ†é’Ÿæ¨é€ç°è‰²è­¦æŠ¥ï¼Œç›´åˆ°è¶…æ—¶1000åˆ†é’Ÿ</li>
    </ol>
  </li>
</ol>

<p><img src="/assets/2022/02-sales-assistant-final/1.webp" style="zoom:50%;" /></p>

<h3 id="åŠŸèƒ½æ¨¡å—2-é€šè¿‡vikaè¡¨æ ¼è¿›è¡Œäº¤äº’å¼ä¼šè¯ä¸ç»©æ•ˆç®¡ç†">åŠŸèƒ½æ¨¡å—2: é€šè¿‡Vikaè¡¨æ ¼è¿›è¡Œäº¤äº’å¼ä¼šè¯ä¸ç»©æ•ˆç®¡ç†</h3>

<ol>
  <li>å®æ—¶æ›´æ–°ä»Šæ—¥æ´»è·ƒç¾¤ä¿¡æ¯</li>
  <li>å¤šé˜¶æ®µç¾¤èŠç®¡ç†ï¼ˆå”®å‰ã€å”®åï¼‰</li>
  <li>å¯å±•ç¤ºç¾¤èŠçš„å›å¤æƒ…å†µã€ä»¥åŠè¶…æ—¶å›å¤æ—¶é•¿</li>
  <li>å¯æç¤ºæœªè¢«æŒ‡æ´¾é”€å”®çš„ç¾¤ï¼ˆå®¹é”™ï¼‰</li>
  <li>å¯¹äºç‰¹æ®Šæƒ…å†µï¼Œä¾‹å¦‚å®¢æˆ·å›å¤â€œå¥½â€çš„è¶…æ—¶æƒ…å†µï¼Œç®¡ç†å‘˜å¯ä»¥å–æ¶ˆè®¡æ—¶ï¼ˆå®¹é”™ï¼‰</li>
  <li>æ²‰æ·€è¯¸å¤šä¼šè¯ç®¡ç†æŒ‡æ ‡ï¼Œæ–¹ä¾¿é”€å”®å›¢é˜Ÿå¤ç›˜</li>
  <li>å¯é€šè¿‡JSONæ–‡ä»¶é…ç½®æ›´æ–°é¢‘ç‡</li>
</ol>

<h4 id="åŠŸèƒ½æ¨¡å—2-1-ç¾¤èŠæ€»è¡¨">åŠŸèƒ½æ¨¡å—2-1: ç¾¤èŠæ€»è¡¨</h4>

<ol>
  <li>åœ¨ç¾¤èŠæ€»è¡¨-ç¾¤èŠæ€»è¡¨å†…ç®¡ç†æ‰€æœ‰ç¾¤èŠçš„çŠ¶æ€
<img src="/assets/2022/02-sales-assistant-final/2-1.webp" alt="2-1" /></li>
  <li>é”€å”®äº¤æ¥å”®åæ—¶ï¼Œå°†ã€è´Ÿè´£äººã€‘æ”¹ä¸ºå”®ååï¼Œå°†ã€ç¾¤èŠé˜¶æ®µã€‘æ”¹ä¸º after-salesï¼Œç­‰å¾…ç®¡ç†å‘˜ç¡®è®¤
<img src="/assets/2022/02-sales-assistant-final/2-1.2.webp" alt="2-1.2" /></li>
  <li>(æ¯æ—¥) åœ¨ç¾¤èŠæ€»è¡¨-å¾…æ ¸å‡†åˆ—è¡¨ï¼Œå‹¾é€‰ã€æ ¸å‡†è¿›å…¥å”®åé˜¶æ®µã€‘æ ¸å‡†ç¾¤èŠ</li>
  <li>åœ¨ç¾¤èŠæ€»è¡¨-<strong>æ— è´Ÿè´£äººç¾¤èŠ</strong>åˆ—è¡¨å†…ï¼Œåœ¨å¾®ä¿¡ç¾¤æŸ¥çœ‹æ˜¯å¦æ²¡æœ‰è´Ÿè´£äººï¼Œå¹¶é‡æ–°æŒ‡æ´¾ä¸€ä¸ªè´Ÿè´£äººä¸ç¾¤èŠé˜¶æ®µ
<img src="/assets/2022/02-sales-assistant-final/2-1.3.webp" alt="2-1.3" /></li>
</ol>

<h4 id="åŠŸèƒ½æ¨¡å—2-2-ä»Šæ—¥ç¾¤èŠ">åŠŸèƒ½æ¨¡å—2-2: ä»Šæ—¥ç¾¤èŠ</h4>

<ol>
  <li>åœ¨ä»Šæ—¥ç¾¤èŠ-æ€»è¡¨å†…ï¼Œå¯çœ‹åˆ°ä»Šæ—¥æ´»è·ƒç¾¤</li>
  <li>å¯¹äºè¶…æ—¶å›å¤çš„æ¶ˆæ¯ï¼Œå¯çœ‹åˆ°æœ€åä¸€å¥å¯¹è¯ã€‚å¯æŸ¥çœ‹ã€æœ€åè¯´è¯è€…ã€‘ã€ã€æœ€åä¸€å¥è¯ã€‘ï¼Œè§†æƒ…å†µå‹¾é€‰ã€æ¶ˆé™¤æœªæ¢å¤è®°å½•ã€‘ï¼Œä»¥å–æ¶ˆæŠ¥è­¦æç¤º</li>
</ol>

<ul>
  <li>ä¾‹å¦‚ï¼šçœ‹åˆ°è¶…æ—¶88 åˆ†é’Ÿçš„ç¾¤èŠï¼Œä¸”å®¢æˆ·å›å¤â€˜å¥½çš„â€™ï¼Œå¯å‹¾é€‰ã€æ¶ˆé™¤æœªæ¢å¤è®°å½•ã€‘</li>
</ul>

<p><img src="/assets/2022/02-sales-assistant-final/2-2.1.webp" alt="2-2.1" /></p>
<ol>
  <li>ç­‰å¾…1åˆ†é’Ÿå†…ï¼Œç³»ç»Ÿå°†æ˜¾ç¤ºã€å·²æ¶ˆé™¤æœªå›è¦†è®°å½•ã€‘ï¼Œè¶…æ—¶æ—¶é—´å½’é›¶ï¼Œé£ä¹¦å°†ä¸­æ–­æ¨é€è¯¥ç¾¤è¶…æ—¶æé†’</li>
</ol>

<p><img src="/assets/2022/02-sales-assistant-final/2-2.2.webp" alt="2-2.2" /></p>
<ol>
  <li>å¯åœ¨æœ«å°¾çš„å‚æ•°å¤„ï¼ŒæŸ¥çœ‹è¯¥ç¾¤çš„å„ç§æŒ‡æ ‡ã€‚å…¬å¼ä¸ºï¼šæ€»å›å¤æ•°= ï¼ˆå”®å‰+å”®å+é¡¾å®¢+å…¶ä»–å‘˜å·¥ï¼‰ çš„å›å¤æ•°</li>
</ol>

<p><img src="/assets/2022/02-sales-assistant-final/2-2.3.webp" alt="2-2.3" /></p>

<h3 id="åŠŸèƒ½æ¨¡å—3-ä¼™ä¼´äº‘å¯è§†åŒ–">åŠŸèƒ½æ¨¡å—3: ä¼™ä¼´äº‘å¯è§†åŒ–</h3>

<p>ä»Vikaä¸‹è½½ç”Ÿæˆçš„æ•°æ®ï¼Œä»ä¼ä¸šå¾®ä¿¡å¯¼å…¥ä¼™ä¼´äº‘ï¼Œå»ºç«‹å¯è§†åŒ–å›¾è¡¨ï¼Œå¯¹æ¯ä¸ªé”€å”®çš„å½“æ—¥/å½“å‘¨å›è¦†è´¨é‡è¿›è¡Œå¯è§†åŒ–ã€‚ç›®å‰éœ€è¦æ‰‹åŠ¨åœ°å¯¼å…¥ã€æ„å»ºå›¾è¡¨ï¼Œè¿˜æ˜¯éœ€è¦èŠ±è´¹æ¯”è¾ƒå¤šçš„æ—¶é—´ã€‚ä¸‹ä¸€æ­¥å°†ä¼šé€è¿‡APIå®æ—¶æ˜¾ç¤ºç»©æ•ˆè¡¨å•å‡ºæ¥ã€‚</p>

<p><img src="/assets/2022/02-sales-assistant-final/3-1.webp" alt="image-20220212000332848" /></p>

<p><img src="/assets/2022/02-sales-assistant-final/3-2.webp" alt="image-20220212000104323" /></p>

<h2 id="äºŒå®ç°">äºŒã€å®ç°</h2>

<p>æˆ‘å€‘å°‡ç³»çµ±è§£æ§‹æˆå‰ç«¯ã€puppetã€å¾Œç«¯ä»£ç¢¼ã€ä»¥åŠæ•¸æ“šåº«ã€‚</p>

<p>é¦–å…ˆï¼Œç”¨æˆ¶å’ŒéŠ·å”®æ¯æ—¥æœƒæœ‰è¨±å¤šæ–°ç¾¤èˆ‡æ–°æ¶ˆæ¯ï¼Œé€™äº›æ¶ˆæ¯é€éWechatyæ•ç²ï¼Œåœ¨<code class="language-plaintext highlighter-rouge">sales-bot.js</code>ä¸­çµ±ä¸€å­˜å…¥<code class="language-plaintext highlighter-rouge">msg_db</code>ï¼ŒåŒæ™‚é€²è¡Œé‚è¼¯åˆ¤æ–·ï¼Œè‹¥æœ‰æ–°å»ºç«‹çš„ç¾¤ï¼Œå‰‡æœƒè¨˜éŒ„åœ¨<code class="language-plaintext highlighter-rouge">room_db</code>å…§ã€‚</p>

<p>æ¥è‘—ï¼Œ<code class="language-plaintext highlighter-rouge">update-vika.js</code> æœƒå¯¦æ™‚æŠ“å–ç¾¤èŠæ•¸æ“šèˆ‡æ¶ˆæ¯æ•¸æ“šï¼Œè¨ˆç®—ç•¶æ—¥æ‰€æœ‰æ´»èºç¾¤çš„ç‹€æ…‹ï¼Œä¸¦å³æ™‚é¡¯ç¤ºåœ¨Vikaè¡¨æ ¼ä¸Šã€‚ç®¡ç†è€…å¯é€éVikaæŸ¥çœ‹æ‰€æœ‰ç¾¤èŠç‹€æ…‹ã€æ‰¾åˆ°å•é¡Œã€ä¸¦åŸ·è¡Œä¸€äº›æ“ä½œã€‚ç•¶å”®å‰å®Œæˆä»»å‹™ï¼Œé€éVikaæ”¹è®Šç¾¤èŠéšæ®µèˆ‡è² è²¬äººï¼Œä¸¦äº¤ç”±ç®¡ç†è€…å¯©æ ¸é€šéã€‚é€™äº›å°ç¾¤èŠç‹€æ…‹çš„æ”¹è®Šï¼Œå°‡ç”± <code class="language-plaintext highlighter-rouge">vika-update-roomdb.js</code> æª¢æŸ¥æ˜¯å¦åˆæ³•ï¼Œè‹¥åˆæ³•å‰‡æ›´æ–°æ•¸æ“šåº«ï¼Œå¦å‰‡æœƒé¡¯ç¤ºå ±éŒ¯çš„ç³»çµ±ä¿¡æ¯ã€‚</p>

<p>æœ€å¾Œï¼Œ<code class="language-plaintext highlighter-rouge">vika-to-feishu.js</code> æœƒå¯¦æ™‚æŠ“å– vika çš„ç¾¤èŠæ•¸æ“šï¼Œè² è²¬å°‡ä¸åŒç¨‹åº¦çš„è¶…æ™‚å›è¦†ï¼Œè½‰æˆä¸åŒé¡è‰²çš„è­¦ç¤ºå¡ç‰‡ï¼Œé€é Lark Puppet æ¥å…¥é£›æ›¸ï¼Œæ ¹æ“šåš´é‡ç¨‹åº¦æ¨é€åˆ°ç§äººç¾¤æˆ–å¤§ç¾¤ï¼Œä½¿éŠ·å”®èˆ‡ç®¡ç†è€…æŒæ¡å›è¦†çš„ç‹€æ…‹ã€‚</p>

<p>è‹¥è¦æ”¹è®ŠéŠ·å”®åå–®ï¼Œå‰‡ç”±é–‹ç™¼è€…æ”¹è®Š <code class="language-plaintext highlighter-rouge">default.json</code> ï¼Œå†åŸ·è¡Œ <code class="language-plaintext highlighter-rouge">update-name.js</code>ï¼Œå³å¯ã€‚è‹¥ç®¡ç†è€…å¸Œæœ›æ”¹è®Šæ¶ˆæ¯æ¨é€çš„é »ç‡ã€è¶…æ™‚æ™‚é•·èˆ‡å°æ‡‰çš„è­¦å ±ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹ <code class="language-plaintext highlighter-rouge">default.json</code> ä¸¦é‡å•Ÿç³»çµ±ã€‚æ­¤å¤–é‚„æœ‰ç³»çµ±çš„è«¸å¤šé…ç½®ï¼Œä¹Ÿæ˜¯å¾é€™è£¡ä¿®æ”¹ã€‚</p>

<p><img src="/assets/2022/02-sales-assistant-final/structure.webp" alt="image-20220212011240626" /></p>

<h3 id="æŒ‘æˆ°">æŒ‘æˆ°</h3>

<p>é‡æ§‹ä»£ç¢¼çµæ§‹ ï¼ˆéåŒæ­¥è®€å¯«ï¼‰</p>

<p>å¾é …ç›®çµæ§‹ä¸­ä¸é›£ç™¼ç¾ï¼Œæ¨¡å¡Šä¹‹é–“æœ‰å¤šç¨®äº¤äº’ã€‚ä¸€é–‹å§‹æˆ‘æŠŠæ‰€æœ‰åŠŸèƒ½éƒ½æ··åœ¨å…©ä»½ä»£ç¢¼è£¡ï¼Œè¤‡é›œåº¦è®Šå¾—å¾ˆé«˜ï¼Œè€Œä¸”é›£åˆ¤æ–·æ•¸æ“šæ˜¯å¦æ­£ç¢ºï¼šå¦‚æœä½¿ç”¨è€…å¾Vikaæ”¹å‹•æ•¸æ“šï¼Œé‚£éº¼å¾ˆå¯èƒ½æœƒæ±¡æŸ“æ•¸æ“šåº«ã€‚æ‰€ä»¥æˆ‘å˜—è©¦å°ä»£ç¢¼è§£è€¦ï¼Œä¾æ“šå‰ç«¯ã€å¾Œç«¯ã€èˆ‡æ•¸æ“šåº«çš„ä¸‰å€‹ç¶­åº¦æ‹†åˆ†å„å€‹æ¨¡å¡Šï¼Œæœ€å¾Œæˆç‚ºä¸Šè¿°çš„çµæ§‹ã€‚æœ€é¡¯è‘—çš„å„ªå‹¢æ˜¯ï¼Œæ¯ä»½ä»£ç¢¼éƒ½è®Šå¾—å¾ˆçŸ­ã€‚ç¬¬äºŒå€‹å¤§çš„å„ªå‹¢æ˜¯ï¼Œèƒ½çœ‹å‡ºæŸæ®µä»£ç¢¼å°æŸé¡æ•¸æ“šï¼Œæ˜¯è®€é‚„æ˜¯å¯«çš„é—œä¿‚ï¼Œé€™å¾ˆå¤§åœ°ä¿è­‰äº†æ•¸æ“šçš„ä¸€è‡´æ€§ã€‚ç¬¬ä¸‰å€‹å„ªå‹¢æ˜¯ï¼Œé€™æ¨£çš„è¨­è¨ˆå¯ä»¥ç‚ºå¾ŒçºŒçš„æ‹“å±•æä¾›æ˜ç¢ºçš„æŒ‡å°ï¼Œä¾‹å¦‚è‹¥æˆ‘å¸Œæœ›å¢åŠ é£›æ›¸æ¨é€çš„è¦å‰‡ï¼Œæˆ‘å¯ä»¥çŸ¥é“æˆ‘è¦å¯«åœ¨å“ªè£¡ã€ä»¥åŠå¤§æ¦‚æ€éº¼å¯«ã€‚</p>

<h3 id="ç³»çµ±å´©æ½°">ç³»çµ±å´©æ½°</h3>

<p>åœ¨ä½¿ç”¨ wechaty ä¼æ¥­å¾®ä¿¡ç‰ˆæœ¬æ™‚ï¼Œæˆ‘åœ¨èª¿ç”¨ API å¾Œæ™‚å¶çˆ¾æœƒç¢°åˆ°é€™å€‹ Bugï¼Œä½¿å¾—ç³»çµ±å´©æ½°ã€‚é€™å€‹å•é¡Œå¾ˆè‡´å‘½ï¼Œå› ç‚ºç•¶ç³»çµ±å´©æ½°å¾Œï¼Œsales-bot å°±ç„¡æ³•æ”¶é›†æ–°çš„ç¾¤èŠèˆ‡æ¶ˆæ¯ï¼Œç„¡æ³•ç¶­è­·æ¶ˆæ¯èˆ‡æˆ¿é–“çš„æ­£ç¢ºæ€§ã€‚åœ¨å¾Œé¢çš„é–‹ç™¼ä¸­ï¼Œæˆ‘åœ¨Vika ä¸Šé¡¯ç¤ºæ¯å€‹ç¾¤èŠèˆ‡æ¶ˆæ¯çš„ç‹€æ…‹ï¼Œä½¿ç®¡ç†å“¡å¯ä»¥æ•æ‰åˆ°æ‰€æœ‰ç¾¤èŠçš„ç‹€æ…‹ï¼Œç®—æ˜¯è§£æ±ºä¸Šè¿°å•é¡Œä»¥åŠå…¶ä»–äººç‚ºç–å¤±æ‰€å¸¶ä¾†çš„æ•¸æ“šéŒ¯èª¤ã€‚ä½†æ¯æ—¥è² è²¬ä¸Šåƒæ¢æ¶ˆæ¯çš„ sales-bot è‹¥æŒçºŒç”¢ç”ŸéŒ¯èª¤æ•¸æ“šï¼Œå¿…ç„¶æœƒé€ æˆå¾ˆå¤§çš„äººå·¥æˆæœ¬ï¼Œæ‰€ä»¥è‚¯å®šéœ€è¦æœ‰æ–¹æ³•ä¿è­‰å®ƒèƒ½åœ¨å´©æ½°å¾Œç›¡å¿«ä¸Šç·šã€‚</p>

<p><img src="/assets/2022/02-sales-assistant-final/crash.webp" alt="crash" /></p>

<p>é¦–å…ˆï¼Œæˆ‘å…ˆä½¿ç”¨ Js è‡ªå·±çš„ error catching æ–¹æ³•ä¾†æ•æ‰éŒ¯èª¤æ¶ˆæ¯ï¼Œä¸¦åœ¨çµæŸç¨‹åºå‰å¾é£›æ›¸æé†’æˆ‘ã€‚</p>

<p><img src="/assets/2022/02-sales-assistant-final/alert.webp" alt="image-20220211115312363" /></p>

<p>ä½†é€™é‚„æ˜¯éœ€è¦äººåŠ›ä¾†åšã€‚ä¸€å€‹äººä¸å¯èƒ½éš¨æ™‚çœ‹é£›æ›¸æ¶ˆæ¯ï¼Œå°±ç®—çœ‹åˆ°ä¹Ÿä¸è¦‹å¾—èƒ½å³æ™‚é‡å•Ÿã€‚æ‰€ä»¥æ¥ä¸‹ä¾†æˆ‘ç¹¼çºŒæ‰¾è‡ªå‹•é‡å•Ÿçš„æ–¹æ³•ã€‚é¦–å…ˆæˆ‘å˜—è©¦ä½¿ç”¨ forever.js , ä½†åœ¨è·‘äº†ä»–çš„ example å¾Œæˆ‘çŸ­æ™‚é–“æ²’æœ‰è©¦æˆåŠŸã€‚å¾Œä¾†æˆ‘å€‘å°±å˜—è©¦æŠŠé€™ä»½ä»£ç¢¼æ”¾åˆ° docker ä¸Šè·‘ï¼Œè®“å®ƒä¾†è‡ªå‹•é‡å•Ÿå´©æ½°çš„ä»£ç¢¼ã€‚å¦å¤– dockerizing é‚„å¸¶ä¾†äº†å…¶ä»–çš„å¥½è™•ï¼Œåƒæ˜¯æä¾›ä¸€å€‹ç©©å®šçš„é‹è¡Œç’°å¢ƒï¼Œå¹«åŠ©å¾ŒçºŒçš„è¦æ¨¡åŒ–ã€‚</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Dockerfile</span>
<span class="k">FROM</span><span class="s"> node:16</span>
<span class="k">WORKDIR</span><span class="s"> /root/bot</span>
<span class="k">COPY</span><span class="s"> . .</span>
<span class="k">RUN </span>npm i <span class="nt">--registry</span><span class="o">=</span>https://registry.npmmirror.com
<span class="k">CMD</span><span class="s"> npm start</span>
</code></pre></div></div>

<p>åœ¨é€™æ®µ dockerfile ä¸­ï¼Œæˆ‘å€‘å…ˆå°‡æ•´å€‹é …ç›®æ–‡ä»¶è¤‡è£½åˆ°containerä¸­ï¼Œå®‰è£ä¾è³´ï¼Œå†é‹è¡Œã€‚ä½†å•é¡Œæ˜¯æ¯æ¬¡éƒ½éœ€è¦é‡æ–°å®‰è£ npm åŒ…ï¼Œé€™å€‹æ™‚é–“éå¸¸é•·ï¼Œå¤šå¯ä»¥åˆ° 7,8 åˆ†é˜ã€‚</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Dockerfile</span>
<span class="k">FROM</span><span class="s"> node:16</span>
<span class="k">WORKDIR</span><span class="s"> /root/bot</span>
<span class="k">COPY</span><span class="s"> ./package.json ./package.json</span>
<span class="k">COPY</span><span class="s"> ./package-lock.json ./package-lock.json</span>
<span class="k">RUN </span>npm i <span class="nt">--registry</span><span class="o">=</span>https://registry.npmmirror.com
<span class="k">COPY</span><span class="s"> . .</span>
<span class="k">CMD</span><span class="s"> npm start</span>
</code></pre></div></div>

<p>ä¸€å€‹è§£æ±ºçš„æŠ€å·§æ˜¯ï¼Œå…ˆå°‡<code class="language-plaintext highlighter-rouge">package.json</code> èˆ‡ <code class="language-plaintext highlighter-rouge">package-lock.json</code>æ¬é‹éå»ã€‚è‹¥é€™å…©ä»½æ–‡ä»¶æ²’æœ‰æ”¹å‹•ï¼Œäº¦å³æ²’æœ‰æ–°çš„ä¾è³´ï¼Œé‚£å°±ä¸éœ€è¦é‡æ–°å®‰è£ã€‚ä½†å³ä¾¿å¦‚æ­¤ï¼Œç•¶å®‰è£äº†æ–°ä¾è³´æ™‚ä»ç„¶è¦å¿å—é•·æ™‚é–“çš„å®‰è£ã€‚æœ‰æ²’æœ‰å¯èƒ½è®“ node åªå®‰è£å¤šå‡ºä¾†çš„ä¾è³´ï¼Œè€Œéå…¨éƒ¨å‘¢ï¼Ÿé€™æ˜¯å¾ˆå€¼å¾—æ€è€ƒçš„å•é¡Œã€‚</p>

<h2 id="ä¸‰çµæœèˆ‡å•é¡Œåˆ†æ">ä¸‰ã€çµæœèˆ‡å•é¡Œåˆ†æ</h2>

<p>ç¶“éå•å·èˆ‡è¨ªè«‡ï¼Œå¤§éƒ¨åˆ†éŠ·å”®ç¿’æ…£ç›´æ¥å¾ä¼æ¥­å¾®ä¿¡ä¸Šå›è¦†ï¼Œå¾é£›æ›¸æ¥å…¥è­¦å ±åªæœ‰å°‘éƒ¨åˆ†çš„æ™‚é–“å¹«åŠ©ä»–å€‘ã€‚å¦å¤–ï¼Œå› ç‚ºéŠ·å”®çš„åº•å±¤æ©Ÿåˆ¶æ˜¯ï¼Œç•¶å®¢æˆ¶ç™¼é€æ¶ˆæ¯å¾Œé–‹å§‹è¨ˆæ™‚ï¼Œä½†ç•¶ç¢°åˆ°å®¢æˆ¶å›è¦†ã€Œå¥½çš„ã€æˆ–ã€ŒOKã€çš„çµæŸèªè€ŒéŠ·å”®æ²’æœ‰å›è¦†æ™‚ï¼Œç³»çµ±å°‡ä¸æ–·å¢åŠ è¶…æ™‚æ™‚é–“è€Œä¸æ–·å ±è­¦ã€‚å› æ­¤æˆ‘å€‘å¢åŠ äº†ã€Œå–æ¶ˆè¶…æ™‚ã€åŠŸèƒ½ï¼Œè®“ç®¡ç†è€…æˆ–éŠ·å”®åœ¨ç¢°åˆ°é€™ç¨®æƒ…æ³æ™‚é—œé–‰è¨ˆæ™‚ã€‚</p>

<p>å¦å¤–ï¼ŒéŠ·å”®æœ‰æ™‚è™•æ–¼å°ˆæ³¨ç‹€æ…‹ï¼Œé€™æ™‚è‹¥è¦æ±‚å³æ™‚å›è¦†ï¼Œå°‡å¾ˆå¤§ç¨‹åº¦å½±éŸ¿å°ˆæ³¨ç‹€æ…‹ã€‚æ‰€ä»¥éŠ·å”®æ©Ÿå™¨äººæœªä¾†éœ€è¦èƒ½æ ¹æ“šç‹€æ…‹ï¼Œä¾†æ±ºå®šæ˜¯å¦è¦è¨ˆæ™‚ã€‚5åˆ†é˜è­¦å ±çš„åŸæ„æ˜¯ï¼Œå¸Œæœ›å®¢æˆ¶ç™¼é€çš„æ¯å¥è©±éƒ½å¯ä»¥æ¯”è¼ƒå¿«åœ°æœ‰å›éŸ³ï¼Œè‹¥éœ€è¦1å°æ™‚æ‰èƒ½å›è¦†çš„å•é¡Œï¼Œä¹Ÿå¯ä»¥åœ¨5åˆ†é˜å…§å…ˆå›è¦†é€™å€‹ç‹€æ…‹ã€‚ä½†è‘£æ£®èªç‚ºï¼Œå›è¦†å®¢æˆ¶ã€Œç¨ç­‰ã€é€™é¡ä¿¡æ¯çš„ç¸½æ•ˆç›Šï¼ˆå®¢æˆ¶ç²ç›Š-éŠ·å”®æˆæœ¬ï¼‰ä¸è¦‹å¾—æ˜¯æœ€é«˜çš„ï¼Œè€ƒæ…®åˆ°éŠ·å”®æ™‚å¸¸æ˜¯æ»¿è¼‰çš„æƒ…æ³ã€‚</p>

<p>æœ‰è¶£çš„æ˜¯ï¼Œå”®å‰çš„è‘£æ£®å’Œå”®å¾Œçš„æ¦®ç”Ÿï¼Œä»–å€‘æ¯æ—¥å›è¦†çš„æ¶ˆæ¯é‡éƒ½é è¶…éå…¶ä»–çš„éŠ·å”®å’Œå”®å¾Œï¼Œä¹Ÿæ°å¥½åœ¨å•å·è£¡åå°éé »ç¹çš„æé†’ã€‚</p>

<p>ç‚ºä½•éœ€è¦é€™éº¼å¿«é€Ÿã€é«˜æ•ˆåœ°å›è¦†å®¢æˆ¶ï¼Ÿåœ¨èˆ‡å¸‚å ´éƒ¨çš„å¼µä½³ã€ä»¥åŠéŠ·å”®ç¸½ç›£ç¥¥å®‡è¨è«–å¾Œï¼Œäº†è§£åˆ°å¦‚æœæ²’æœ‰å³æ™‚å›è¦†ï¼Œå¾ˆå¯èƒ½å®¢æˆ¶å°±è·‘äº†ã€‚ä½†é€™ä¸åªæ˜¯å›å¾©å¿«æ…¢çš„å•é¡Œï¼Œå›è¦†çš„å…§å®¹èˆ‡ç­–ç•¥ä¹Ÿå¾ˆé‡è¦ã€‚éŠ·å”®éœ€è¦åˆ¤æ–·ä¸€å€‹å®¢æˆ¶æ˜¯å¦æ¯”è¼ƒå¯èƒ½è²·å–®ï¼Œä¸¦æŠŠä»–å€‘æ’åœ¨æ›´é«˜çš„å„ªå…ˆç´šã€‚å¦å¤–ï¼Œéäº†ä¸€æ®µæ™‚é–“ï¼ˆä¾‹å¦‚7å¤©ï¼‰æ²’äº¤æµçš„ç¾¤éœ€é‡æ–°è·Ÿé€²ã€‚å¯ä»¥çœ‹å‡ºï¼Œå”®å‰æ˜¯éå¸¸é—œéµèˆ‡æŠ€å·§æ€§çš„éŠ·å”®ç’°ç¯€ã€‚é€™æ¬¡éŠ·å”®æ©Ÿå™¨äººåªé—œæ³¨ã€Œå›è¦†æ™‚é•·ã€ï¼Œç®—æ˜¯è·‘é€šä¸€å€‹åŸºç¤çš„æ¡†æ¶ï¼Œçˆ²å¾ŒçºŒæ›´æ™ºèƒ½çš„å°è©±ç®¡ç†åšé‹ªå¢Šã€‚</p>

<p>å°æ–¼ç®¡ç†è€…è€Œè¨€ï¼Œé€™å€‹é …ç›®çš„æ„ç¾©åœ¨æ–¼è§£æ±ºä¸€å€‹å¾ˆç—›çš„é»ï¼šè‹¥ç®¡ç†è€…å¸Œæœ›æŸ¥çœ‹æŸéŠ·å”®æˆ–æŸç¾¤èŠçš„ç‹€æ…‹ï¼Œéœ€è¦æ‰‹å‹•ç¿»æ‰¾ç¾¤èŠä¿¡æ¯ï¼ŒèŠ±è²»å¤§é‡æ™‚é–“ï¼Œæ›´ä¸ç”¨èªªèƒ½çµ±è¨ˆå‡ºç¸¾æ•ˆäº†ã€‚åœ¨Vikaä¸Šå±•ç¤ºäº†æ‰€æœ‰ç¾¤èŠæœ€é—œéµçš„ä¿¡æ¯ï¼Œåƒæ˜¯å¤šä¹…æ²’å›è¦†ï¼Œå°è©±ä¸Šä¸‹æ–‡ã€ç¸½ç¾¤èŠã€ç¾¤èŠéšæ®µç­‰ç­‰ï¼Œç¬é–“æœ‰ä¸€ç¨®æ‰“é–‹è¦–é‡çš„æ˜äº®æ„Ÿã€‚å¦å¤–å¾HRçš„è§’åº¦ï¼Œé€™äº›æ²ˆæ¾±ä¸‹ä¾†çš„æ•¸æ“šï¼Œä¹Ÿå¯ä»¥ä½œç‚ºå®šç›®æ¨™èˆ‡ç¸¾æ•ˆçš„æ¨™æº–ã€‚</p>

<h2 id="å››ç¸½çµ">å››ã€ç¸½çµ</h2>

<p>éŠ·å”®æ©Ÿå™¨äººæ˜¯æˆ‘çš„ç¬¬ä¸€ä»½å¯¦ç¿’å·¥ä½œã€‚åœ¨é€™ä¸‰å€‹å¤šæœˆä¸­ï¼Œæˆ‘æ ¹æ“šä¸€é–‹å§‹ç®¡ç†è€…çµ¦æˆ‘çš„å•é¡Œèˆ‡ç”¢å“éœ€æ±‚ï¼Œè·‘é€šåŸºç¤å¯ç”¨çš„ç³»çµ±ï¼Œæ ¹æ“šå„ç¨®è¡ä¼¸çš„å•é¡Œä¸æ–·è¿­ä»£ï¼Œä¸¦æ›´æ·±å…¥åœ°äº†è§£éŠ·å”®å ´æ™¯ï¼Œæœ€å¾Œå¾—åˆ°ä¸€å€‹å¯æŠ•ç”¢çš„åŸºç¤ç‰ˆæœ¬ã€‚é€™å€‹ç¶“é©—å¯¦åœ¨æ˜¯éå¸¸å¯¶è²´ï¼Œå¾ˆæ„Ÿè¬ä½³èŠ®åœ¨å»å¹´10æœˆåº•ä»‹ç´¹æˆ‘é€™å€‹æ©Ÿæœƒã€‚åœ¨èˆ‡ä½³èŠ®äº¤æµæ™‚ï¼Œèƒ½æ„Ÿå—åˆ°å¾ˆå¼·çƒˆå°ç›®æ¨™èˆ‡ç”¢å‡ºçš„å°ˆæ³¨ï¼Œä»¥åŠå°ç”¢å“ã€æ¥­å‹™ã€æŠ€è¡“å•é¡Œå…¨é¢çš„æŠŠæ¡ã€‚æ¸…è¯æ˜¯å¾ˆæ£’çš„mentorå’Œæœ‹å‹ï¼Œåœ¨å’Œä»–äº¤æµå•é¡Œæ™‚ï¼Œå­¸åˆ°å¾ˆå¤šå°bugçš„åˆ¤æ–·èˆ‡æ¨ç†ï¼Œå°äº‹é …å„ªå…ˆç´šçš„æ’åºï¼Œä»¥åŠå°å·¥å…·èˆ‡æ–¹æ³•çš„é¸æ“‡ã€‚åº·é¾ä½œç‚ºä¸€å€‹å°CEOçµ¦æˆ‘å¾ˆå¤šçš„æ”¯æŒï¼Œå¹«åŠ©æˆ‘çš„é …ç›®æ–¹å‘èˆ‡ä½³èŠ®çš„æƒ³æ³•å¯ä»¥ä¸€è‡´ï¼Œè®“æˆ‘èƒ½æ›´å¿«è§£æ±ºå•é¡Œï¼›ä»–å’Œæˆ‘åŒé„°ï¼Œå»èƒ½ä¸€å€‹äººåšé‚£éº¼å¤šäº‹ï¼Œä¸¦åšå¾—å¾ˆæˆç†Ÿã€‚æ€è·åœ¨æˆ‘å‰›å…¥è·çš„æ™‚å€™çµ¦æˆ‘è¨±å¤šç¶“é©—ï¼Œè®“æˆ‘é¿æ‰äº†è¨±å¤šå‘ã€‚å’Œç¿”å®‡èˆ‡ä½³å“¥è¨è«–éŠ·å”®å ´æ™¯æ™‚ï¼Œæ™‚å¸¸èƒ½æœ‰å¾ˆæ·±å…¥çš„äº¤æµï¼Œæ”¶ç©«éå¸¸å¤šã€‚æœ€å¾Œï¼Œåœ¨èˆ‡éŠ·å”®å€‘äº¤æµç”¢å“å•é¡Œæ™‚ï¼Œæ™‚å¸¸èƒ½å¾—åˆ°å¾ˆè±å¯Œçš„åé¥‹ã€‚ç¸½é«”è€Œè¨€ï¼Œåœ¨å¥å­äº’å‹•çœ‹åˆ°å¤§å®¶å¾ˆæœ‰ç†±æƒ…ã€å¾ˆå¿«é€Ÿåœ°æˆé•·ï¼Œå¹´è¼•çš„ç®¡ç†å±¤é©…å‹•å¤§å®¶çœ‹åˆ°å•é¡Œä¸¦ä¸æ–·è›»è®Šã€‚åŒæ™‚ä¹Ÿè¦ºå¾—å‰µæ¥­å…¬å¸çš„å£“åŠ›éå¸¸å¤§ï¼Œæ™‚å¸¸çœ‹åˆ°åŒäº‹å¾ˆæ™šæ‰ä¸‹ç­ã€‚å¥å­çš„æŠ€è¡“åœ˜éšŠï¼Œå¾ˆå¸¸é‡åˆ°æœªçŸ¥çš„çªç™¼ç‹€æ³ï¼Œç„¶å¾Œé å¤§å®¶ç¥ç¶“ç¹ƒç·Šä¸€èµ·è§£æ±ºã€‚æˆ‘è¦ºå¾—æŠ€è¡“çš„teamå¿ƒè‡ŸçœŸçš„è¦å¾ˆå¤§é¡†ï¼Œå› ç‚ºè‚©ä¸Šæ¹è² ä¸€å€‹å·¨å¤§çš„ã€ä¸æ–·é‹è½‰çš„ç³»çµ±ã€‚é€™ä¹Ÿè®“æˆ‘çœ‹åˆ°ã€Œè·å ´ã€èˆ‡ã€Œå­¸æ ¡ã€æ˜¯å¤šéº¼çš„ä¸åŒã€‚åœ¨å­¸æ ¡åªéœ€è¦æŠŠä½œæ¥­æäº¤å³å¯ï¼Œåœ¨è·å ´éœ€è¦å°å®¢æˆ¶ã€ä»¥åŠæ•´å¥—ç³»çµ±è² è²¬ã€‚é€™ä½¿æˆ‘å°å‰µæ¥­å…¬å¸çš„æ‹¼å‹ä»¥åŠ working ethic éå¸¸å°Šæ•¬ï¼Œå¸Œæœ›æœªä¾†å¯ä»¥æˆé•·æˆé€™æ¨£çš„è§’è‰²ã€‚</p>]]></content><author><name>kevintung</name></author><category term="project" /><category term="productivity" /><summary type="html"><![CDATA[]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/02-sales-assistant-final/sales-meme.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/02-sales-assistant-final/sales-meme.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">åŸºäºwechatyå¼€å‘çš„åŒ»ç–—å°åŠ©æ‰‹</title><link href="https://wechaty.js.org/2022/02/02/wechaty-medical-bot/" rel="alternate" type="text/html" title="åŸºäºwechatyå¼€å‘çš„åŒ»ç–—å°åŠ©æ‰‹" /><published>2022-02-02T00:00:00+00:00</published><updated>2022-02-02T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/02/02/wechaty-medical-bot</id><content type="html" xml:base="https://wechaty.js.org/2022/02/02/wechaty-medical-bot/"><![CDATA[<h2 id="1-å‰è¨€">1. å‰è¨€</h2>

<p>éšç€ç§»åŠ¨äº’è”ç½‘å³æ—¶é€šè®¯å·¥å…·çš„å‘å±•å’Œæ™®åŠï¼Œäººä¸äººä¹‹é—´çš„äº¤æµè¶Šæ¥è¶Šä¾èµ–é€šè®¯å·¥å…·ï¼Œæ¯”å¦‚<code class="language-plaintext highlighter-rouge">Wechat</code>æˆä¸ºå„ç§å·¥ä½œåœºæ™¯çš„é‡è¦æ²Ÿé€šå·¥å…·ã€‚åŒ»ç–—ä½œä¸ºç‰¹æ®Šè¡Œä¸šï¼ŒåŒ»ç”Ÿä¸åŒ»ç”Ÿã€åŒ»ç”Ÿä¸æŠ¤å£«ä»¥åŠåŒ»ç”Ÿä¸æ‚£è€…ç­‰ä¹‹é—´çš„æ²Ÿé€šå¯¹ç–¾ç—…è¯Šæ–­ã€æ²»ç–—ã€éšè®¿ç­‰å°¤å…¶é‡è¦ã€‚ä½œä¸ºä¸“ç§‘åŒ»ç”Ÿï¼Œå¤šæ•°æ‚£è€…éƒ½å› æŸç§å¸¸è§ç–¾ç—…å°±è¯Šï¼Œå¾ˆå¤šæ—¶å€™æ²Ÿé€šå†…å®¹éƒ½æ˜¯é‡å¤çš„ï¼Œå¦‚ä½•é€šè¿‡æœºå™¨æˆ–ç¨‹åºå¸®åŠ©æˆ‘ä»¬å®Œæˆé‡å¤å†…å®¹çš„æ²Ÿé€šï¼Œä»è€Œæé«˜å·¥ä½œæ•ˆç‡å‘¢ï¼Ÿæ­¤å¤–ï¼ŒåŒ»ç–—çŸ¥è¯†å¤šè€Œç¹æ‚ï¼Œå¦‚ä½•é€šè¿‡æœºå™¨æˆ–ç¨‹åºå¸®åŠ©æˆ‘ä»¬æ›´å¥½è®°å¿†å‘¢ï¼Ÿ</p>

<h2 id="2-ä½é™¢æ€»åŒ»å¸ˆä¸ä¸´åºŠå·¥ä½œç®€ä»‹">2. ä½é™¢æ€»åŒ»å¸ˆä¸ä¸´åºŠå·¥ä½œç®€ä»‹</h2>

<p>ç¬”è€…ä¸ºæŸåŒ»é™¢å¤–ç§‘åŒ»ç”Ÿï¼Œçˆ±å¥½ç¼–ç¨‹ï¼Œå¤§å­¦æœŸé—´è‡ªå­¦pythonï¼Œç”¨äºæ•°æ®è‡ªåŠ¨åŒ–å¤„ç†ã€ç—…å†èµ„æ–™è‡ªåŠ¨åŒ–æ”¶é›†ã€ç§‘ç ”ç»Ÿè®¡ä¸ä½œå›¾ç­‰ï¼Œæå¤§æé«˜äº†ç¬”è€…çš„å·¥ä½œæ•ˆç‡ä»¥åŠæ•°æ®çš„å‡†ç¡®æ€§ã€‚ç›®å‰æ‹…ä»»<strong>ä½é™¢æ€»åŒ»å¸ˆ</strong>ï¼ˆç®€ç§°<code class="language-plaintext highlighter-rouge">ä½é™¢æ€»</code>ï¼‰ï¼Œç›¸ä¿¡å¤§å®¶éƒ½å¬è¿‡<code class="language-plaintext highlighter-rouge">996</code>å·¥ä½œåˆ¶åº¦ï¼Œè€Œä½é™¢æ€»å·¥ä½œä¸ºæœŸ1-2å¹´ï¼Œæ¯å¤©24å°æ—¶å‡åœ¨ç—…åŒºï¼Œä»¥ä¾¿éšcalléšåˆ°ï¼Œæœ‰äº›åŒ»é™¢å¯èƒ½æœ‰1å‘¨ä¼‘æ¯1å¤©ã€‚ä½é™¢æ€»çš„å·¥ä½œå¼ºåº¦ï¼Œç»å¯¹æ˜¯æœ‰è¿‡ä¹‹è€Œæ— ä¸åŠã€‚ä½é™¢æ€»æ˜¯ä½é™¢åŒ»å¸ˆåŸ¹å…»çš„é«˜çº§é˜¶æ®µï¼Œæ˜¯ä½é™¢åŒ»å¸ˆå‘ä¸»æ²»åŒ»å¸ˆæˆé•¿è¿‡ç¨‹ä¸­å¿…è¦çš„é˜¶æ®µã€‚ä¸€èˆ¬ä½é™¢æ€»è´Ÿè´£ç§‘å®¤æ‰€æœ‰äº‹æƒ…ï¼ŒåŒ…æ‹¬ä½†ä¸ä»…é™äºç§‘å®¤æ’ç­ï¼Œè´Ÿè´£è¿›ä¿®åŒ»ç”Ÿã€è½®ç§‘åŒ»å¸ˆã€å®ä¹ åŒ»å¸ˆçš„ä¸´åºŠè½®è½¬å®‰æ’ã€å‡ºç§‘è€ƒè¯•ï¼›è½¬è¾¾åŒ»é™¢çš„å„ç§æ–‡ä»¶ã€æŒ‡ä»¤ï¼›å„ç§‘å®¤æ™®é€šå’Œæ€¥è¯Šä¼šè¯Šï¼Œç‰¹åˆ«æ˜¯æ€¥è¯Šä¼šè¯Šï¼Œéšcalléšåˆ°ï¼›è´Ÿè´£ç—…æˆ¿æŠ¢æ•‘å·¥ä½œç­‰ã€‚å¦å¤–ï¼Œå¤–ç§‘ä½é™¢æ€»éœ€å‚åŠ æ‰‹æœ¯ï¼Œå¯èƒ½åœ¨æ‰‹æœ¯æ—¶å°±é”™è¿‡äº†é‡è¦äº‹æƒ…çš„æé†’ã€‚å…¶æ¬¡ï¼Œè¿›ä¿®åŠè½®ç§‘åŒ»ç”Ÿæ˜¯å®šæœŸè½®è½¬ï¼Œæ¯æ¬¡æ›´æ¢æ–°å­¦å‘˜éƒ½éœ€é‡å¤æé†’ã€æŒ‡å¯¼å’Œæ•™å­¦ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å°±ä¼šæ¶‰åŠåˆ°å¾ˆå¤šé‡å¤ã€é‡è¦çš„æ¶ˆæ¯æé†’ã€æ–‡ä»¶è½¬è¾¾ã€ä¸´åºŠå·¥ä½œæ³¨æ„äº‹é¡¹æç¤ºç­‰ï¼Œå¦‚ä½•å‡è½»ä½é™¢æ€»çš„å·¥ä½œå‹åŠ›ã€ååŠ©è®°å¿†ã€æé«˜å·¥ä½œæ•ˆç‡å‘¢ï¼Ÿ</p>

<p>äºæ˜¯åŸºäº<code class="language-plaintext highlighter-rouge">wechaty</code>å¼€å‘äº†ä¸€ä¸ª<strong>åŒ»ç–—å°åŠ©æ‰‹</strong>ï¼Œç”±äºç¬”è€…ç¼–ç¨‹èƒ½åŠ›æœ‰é™ï¼Œæ­¤æ–‡åªåšç®€å•ä»‹ç»ï¼Œå…·ä½“ä»£ç å‚è€ƒ<a href="https://github.com/wechaty/wechaty">wechatyå®˜ç½‘</a>ã€‚</p>

<h2 id="3-åŒ»ç–—å°åŠ©æ‰‹ç›®å‰å·²å®ç°çš„åŠŸèƒ½">3. åŒ»ç–—å°åŠ©æ‰‹ç›®å‰å·²å®ç°çš„åŠŸèƒ½</h2>

<h3 id="31-ä¸ªæ€§åŒ–æé†’ç”¨äºæé†’è½®ç§‘åŒ»ç”Ÿä¸´åºŠå·¥ä½œæ³¨æ„äº‹é¡¹">3.1 ä¸ªæ€§åŒ–æé†’ï¼Œç”¨äºæé†’è½®ç§‘åŒ»ç”Ÿä¸´åºŠå·¥ä½œæ³¨æ„äº‹é¡¹</h3>

<p>å…¥é™¢è¯Šæ–­ã€ä¸´åºŠè·¯å¾„å½•å…¥
<img src="/assets/2022/02-wechaty-medical-bot/new-admission-dignosis.webp" alt="new-admission-dignosis" /></p>

<p>æ–°å…¥é™¢æ³¨æ„äº‹é¡¹
<img src="/assets/2022/02-wechaty-medical-bot/new-admission.webp" alt="new-admission" /></p>

<p>ç—…ç¨‹ä¹¦å†™æ³¨æ„äº‹é¡¹
<img src="/assets/2022/02-wechaty-medical-bot/soap.webp" alt="soap" /></p>

<p>æ—©æŸ¥æˆ¿åº”å…³æ³¨çš„é¡¹ç›®å’Œå†…å®¹
<img src="/assets/2022/02-wechaty-medical-bot/pre-wardround.webp" alt="pre-wardround" />
<img src="/assets/2022/02-wechaty-medical-bot/recall.webp" alt="recall" /></p>

<p>æ¢è¯å’Œæ“ä½œååŒ»ç–—åƒåœ¾åˆ†ç±»
<img src="/assets/2022/02-wechaty-medical-bot/debridement.webp" alt="debridement" /></p>

<p>å‡ºé™¢æ³¨æ„äº‹é¡¹ä»¥åŠæœ¯åå¤æŸ¥
<img src="/assets/2022/02-wechaty-medical-bot/discharge.webp" alt="discharge" /></p>

<p>ç—…æ¡ˆæäº¤
<img src="/assets/2022/02-wechaty-medical-bot/file-submit.webp" alt="file-submit" /></p>

<p>å‘¨æœ«äº¤æ¥ç­
<img src="/assets/2022/02-wechaty-medical-bot/weekend.webp" alt="weekend" />
<img src="/assets/2022/02-wechaty-medical-bot/exchange.webp" alt="exchange" /></p>

<h3 id="32-ä¸“ä¸šçŸ¥è¯†æŸ¥è¯¢">3.2 ä¸“ä¸šçŸ¥è¯†æŸ¥è¯¢</h3>

<p>æœ¯åè¡¥æ¶²åŸåˆ™
<img src="/assets/2022/02-wechaty-medical-bot/fluid.webp" alt="fluid" /></p>

<p>å¸¸è§é•‡ç—›è¯ç‰©
<img src="/assets/2022/02-wechaty-medical-bot/analgesia.webp" alt="analgesia" /></p>

<p>æŠ¢æ•‘è¯ç‰©
<img src="/assets/2022/02-wechaty-medical-bot/life-saving.webp" alt="life-saving" /></p>

<h3 id="33-å…¶ä»–">3.3 å…¶ä»–</h3>

<p><img src="/assets/2022/02-wechaty-medical-bot/light.webp" alt="light" /></p>

<p><img src="/assets/2022/02-wechaty-medical-bot/post-blood-check.webp" alt="post-blood-check" /></p>

<p><img src="/assets/2022/02-wechaty-medical-bot/tue-note.webp" alt="tue-note" /></p>

<h2 id="4-æ•ˆæœ">4. æ•ˆæœ</h2>

<p>è™½ç„¶åŒ»ç–—å°åŠ©æ‰‹ç›®å‰ä»…æœ‰éƒ¨åˆ†åŠŸèƒ½ï¼Œä½†å¾ˆå¤§ç¨‹åº¦ç¼“è§£äº†æœ¬äººä½é™¢æ€»å·¥ä½œè´Ÿæ‹…ï¼Œå®šæœŸæé†’å’Œæ¨é€æé«˜äº†å„ä½åŒ»ç”Ÿçš„è‡ªè§‰æ€§ã€‚ç›®å‰ç—…æ¡ˆè§„å®šå¤©æ•°å†…æäº¤ç‡100%ï¼Œæ¢è¯è½¦ä»¥åŠæ¢è¯å®¤åŒ»ç–—åƒåœ¾å‡æŒ‰è§„å®šåˆ†ç±»ä¸¢å¼ƒç­‰ã€‚</p>

<h2 id="5-å¾…å¼€å‘åŠŸèƒ½ä¸å±•æœ›">5. å¾…å¼€å‘åŠŸèƒ½ä¸å±•æœ›</h2>

<p>é™äºä¸ªäººä¸´åºŠå·¥ä½œå¿™ä»¥åŠç¼–ç¨‹èƒ½åŠ›æœ‰é™ï¼Œç›®å‰åŒ»ç–—å°åŠ©æ‰‹åŠŸèƒ½è¾ƒå°‘ï¼Œä½†è‡ªå·±åˆ¶å®šäº†ä¸€äº›ç›®æ ‡ï¼Œä»¥åå¼€å‘æ›´å¤šçš„åŠŸèƒ½ï¼Œè‹¥æœ‰æœºä¼šåç»­å†è·Ÿå¤§å®¶åˆ†äº«ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶æå®è´µæ„è§(<code class="language-plaintext highlighter-rouge">smartnikocj@gmail.com</code>)ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">å¾…å¼€å‘åŠŸèƒ½</code>ï¼š</p>

<ul>
  <li>è½®ç§‘åŒ»ç”Ÿæ’ç­ä¸è€ƒå‹¤</li>
  <li>é€šè®¯å½•ï¼ˆæ¯æœˆè½®è½¬åŒ»ç”Ÿä¸åŒï¼Œå®šæœŸæ›´æ–°é€šè®¯å½•ï¼Œéšæ—¶æŸ¥è¯¢ï¼Œæ–¹ä¾¿æ²Ÿé€šï¼‰</li>
  <li>ç—…æ¡ˆä¹¦å†™æ³¨æ„äº‹é¡¹ï¼ˆå®šæœŸæ¨é€ç—…æ¡ˆä¹¦å†™çŸ¥è¯†ç‚¹ï¼‰</li>
  <li>ä¸“ä¸šçŸ¥è¯†å®šæœŸæ¨é€ï¼ˆå½¢æˆçŸ¥è¯†ç½‘ç»œï¼Œå®šæœŸæ¨é€ï¼Œéšæ—¶æŸ¥è¯¢ï¼Œè®©è¿›ä¿®åŠè½®ç§‘åŒ»ç”Ÿå­¦ä¹ æ›´å¤šæœ¬ä¸“ä¸šçŸ¥è¯†ï¼‰</li>
  <li>å¸¸ç”¨è¯ç‰©ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼ˆå¦‚å®šæœŸæ¨é€æœ¬ç§‘å¸¸ç”¨è¯ç‰©é…ä¼ç¦å¿Œï¼‰</li>
  <li>æŠ¢æ•‘æµç¨‹åŠè¯ç‰©ï¼ˆå®šæœŸæ¨é€ï¼Œåå¤å­¦ä¹ ï¼Œå½“é‡åˆ°æŠ¢æ•‘æ—¶èƒ¸æœ‰æˆç«¹ï¼‰</li>
  <li>åŒ»æ‚£æ²Ÿé€šï¼ˆå›ç­”æ‚£è€…å¸¸è§æé—®ç­‰ï¼‰</li>
  <li>ç­‰ç­‰</li>
</ul>

<h2 id="6-è‡´è°¢">6. è‡´è°¢</h2>

<p>æ„Ÿè°¢<a href="https://wechaty.js.org/">wechaty</a>ç¤¾åŒºå¼€å‘è€…ä»¬çš„è¾›å‹¤ä»˜å‡ºï¼Œæ„Ÿè°¢<a href="https://github.com/huan">Huan</a>çš„å®è´µå»ºè®®ã€‚å¸Œæœ›æœ¬é¡¹ç›®å¯ä»¥æŒç»­å‘å±•ä¸‹å»ã€‚</p>]]></content><author><name>smartnikocj</name></author><category term="article" /><category term="assistant" /><category term="wechat" /><category term="medicine" /><category term="improve-efficiency" /><summary type="html"><![CDATA[1. å‰è¨€]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/02-wechaty-medical-bot/title-image.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/02-wechaty-medical-bot/title-image.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Authing å›¢é˜Ÿç®¡ç† + Wechaty æœºå™¨äºº = æ— é™å¯èƒ½</title><link href="https://wechaty.js.org/2022/01/29/authing-wechaty-intergration/" rel="alternate" type="text/html" title="Authing å›¢é˜Ÿç®¡ç† + Wechaty æœºå™¨äºº = æ— é™å¯èƒ½" /><published>2022-01-29T00:00:00+00:00</published><updated>2022-01-29T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/01/29/authing-wechaty-intergration</id><content type="html" xml:base="https://wechaty.js.org/2022/01/29/authing-wechaty-intergration/"><![CDATA[<h2 id="ç”¨æˆ·æ•…äº‹">ç”¨æˆ·æ•…äº‹</h2>

<p>å…¶å®ç”¨ Authing å›¢é˜Ÿç®¡ç† + Wechaty æœºå™¨äººèƒ½å¤Ÿå®ç°å¾ˆå¤šåŠŸèƒ½ï¼Œæ¥æé«˜ä¼ ç»Ÿäººäº‹ç®¡ç†çš„æ•ˆç‡ã€‚ç”šè‡³è¿˜å¯ä»¥åšä¸€äº›æ•°æ®çš„åˆ†æã€ç»Ÿè®¡ï¼Œæ¥è¾…åŠ©å†³ç­–ã€‚è¿™é‡Œæˆ‘å°±åˆ—äº†å‡ ä¸ªç®€å•çš„ç°å®åœºæ™¯ï¼Œå¸Œæœ›èƒ½å¸®åŠ©å¤§å®¶ç†è§£ã€‚</p>

<h3 id="ä»¥-authing-ä½œä¸ºä¸Šæ¸¸æ•°æ®æº">ä»¥ Authing ä½œä¸ºä¸Šæ¸¸æ•°æ®æº</h3>

<p>åŒæ­¥æ•°æ®åˆ°å…¶ä»–å¹³å°ï¼Œå‰æœŸä¸ºé£ä¹¦å’Œå¾®ä¿¡ã€‚åˆ›å»ºå®Œç”¨æˆ·åï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ‰‹æœºå·ç›´æ¥ç™»å½•é£ä¹¦ã€‚ä¸ªäººå¾®ä¿¡æ·»åŠ  Wechaty Botï¼Œé€šè¿‡æ¶ˆæ¯å‘é€æ‰‹æœºå·è¿›è¡Œç”¨æˆ·å…³è”ç»‘å®šã€‚åœ¨ Authing ä¸­åˆ›å»ºç»„ç»‡æ¶æ„ï¼ŒåŒæ­¥å¯¹åº”åˆ›å»ºé£ä¹¦çš„éƒ¨é—¨å’Œå¾®ä¿¡çš„ç¾¤ç»„ã€‚åŒæ­¥åˆ é™¤é£ä¹¦ç”¨æˆ·ã€å¾®ä¿¡ç¾¤ç§»é™¤ç¾¤èŠã€‚</p>

<h3 id="åŸæœ‰é£ä¹¦ç»„ç»‡æ¥å…¥å¾®ä¿¡">åŸæœ‰é£ä¹¦ç»„ç»‡æ¥å…¥å¾®ä¿¡</h3>

<p>é£ä¹¦ä½œä¸ºä¸Šæ¸¸æ•°æ®æºã€‚å¾®ä¿¡æ·»åŠ  Wechat Botï¼Œé€šè¿‡æ¶ˆæ¯å‘é€æ‰‹æœºå·è¿›è¡Œç”¨æˆ·å…³è”ç»‘å®šã€‚
åœ¨é£ä¹¦ä¸­æ·»åŠ ã€åˆ é™¤ç”¨æˆ·ï¼Œï¼ˆå…ˆè®¾ç½®å¥½åŒæ­¥é¢‘ç‡ï¼Œæ¯”å¦‚æ¯ 10 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼‰ï¼Œå¯¹åº”å¾®ä¿¡ç¾¤ä¸­è¿›è¡Œé‚€è¯·åŠ å…¥æˆ–è€…ç§»é™¤ã€‚åœ¨é£ä¹¦ä¸­è¿›è¡Œéƒ¨é—¨ï¼ˆç»„ç»‡ï¼‰ç®¡ç†ï¼ŒåŒæ­¥åœ¨å¾®ä¿¡ä¸­åˆ›å»ºå¯¹åº”çš„ç¾¤èŠï¼ˆæ‰å¹³åŒ–ï¼Œæ— å±‚çº§ï¼‰ï¼Œå¹¶åŒæ­¥ç¾¤æˆå‘˜ç®¡ç†ï¼ˆæ·»åŠ /ç§»é™¤ï¼‰ã€‚</p>

<h3 id="åŸæœ‰å¾®ä¿¡ç¾¤ç»„å¹¶æ¥å…¥é£ä¹¦">åŸæœ‰å¾®ä¿¡ç¾¤ç»„å¹¶æ¥å…¥é£ä¹¦</h3>

<p>é€‰æ‹©ä¸€ä¸ªå…¨å‘˜å¾®ä¿¡ç¾¤è¿›è¡Œæ¥å…¥ï¼Œé¦–å…ˆ Wechaty Bot ä¼šä¸ºè¯¥ç¾¤ä¸­æ‰€æœ‰æˆå‘˜åˆ›å»º Authing ç”¨æˆ·ã€‚å¾®ä¿¡æ·»åŠ  Wechaty Bot æˆ–è€… @æåŠçš„æ–¹å¼å‘é€æ¶ˆæ¯æ‰‹æœºå·è¿›è¡Œç”¨æˆ·å…³è”ç»‘å®šï¼Œç»‘å®šæ‰‹æœºå·çš„æˆå‘˜å¯ä»¥é€šè¿‡è¯¥æ‰‹æœºå·è¿›è¡Œé£ä¹¦çš„ç™»å½•ã€‚
åœ¨åŸæœ‰å¾®ä¿¡å¤§ç¾¤ä¸­æ·»åŠ ã€åˆ é™¤ç”¨æˆ·ï¼Œï¼ˆå…ˆè®¾ç½®å¥½åŒæ­¥é¢‘ç‡ï¼Œæ¯”å¦‚æ¯ 10 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼‰ï¼Œå¯¹åº”é£ä¹¦ç”¨æˆ·æ·»åŠ æˆ–è€…ç§»é™¤ã€‚</p>

<h2 id="æ’¸ä¸€ä¸ª-wechaty-authing-çš„æ’ä»¶">æ’¸ä¸€ä¸ª Wechaty Authing çš„æ’ä»¶</h2>

<p>ä¹Ÿå¯ä»¥é€šè¿‡æ’ä»¶çš„ä»‹ç»é¡µé¢ç›´æ¥å»äº†è§£æ’ä»¶çš„ä½¿ç”¨è¯´æ˜ã€‚è¯¥æ’ä»¶å¼€æºä»£ç ä»“åº“ä½äºï¼š <a href="https://github.com/Authing/wechaty-authing">https://github.com/Authing/wechaty-authing</a></p>

<h3 id="è®¾è®¡æ€è·¯">è®¾è®¡æ€è·¯</h3>

<ul>
  <li>è¯¥æ’ä»¶åº”å½“å°è£…å¥½äº†ä¸€äº›å¸¸ç”¨çš„æ–¹æ³•ï¼Œæ¥æ‰“é€š Wechaty ä¸ Authing ä¹‹é—´çš„è¿æ¥</li>
  <li>é…å¤‡äº†ä¸€äº›å¥½ç”¨çš„å·¥å…·ç±»æ–¹æ³•ï¼Œæé«˜å¼€å‘æ•ˆç‡</li>
  <li>å…·å¤‡ä¸€å®šçš„å¯æ‰©å±•æ€§ï¼Œæ–¹ä¾¿æœ‰ä¸€äº›éé€šç”¨éœ€æ±‚çš„å®ç°</li>
</ul>

<h3 id="å®ç°">å®ç°</h3>

<p>åœ¨ç€æ‰‹å¼€å‘è¿™ä¸ªæ’ä»¶ä¹‹å‰ï¼Œæˆ‘æ˜¯åˆ†åˆ«ä»¥ Wechaty ä½œä¸ºç”¨æˆ·ä¸Šæ¸¸å’Œ Authing ç”¨æˆ·æ± ä½œä¸ºç”¨æˆ·ä¸Šæ¸¸åšäº†ä¸¤ä¸ª MVP é¡¹ç›®ã€‚ç„¶åé€šè¿‡é¡¹ç›®ä¸­çš„ä¸€äº›æ–¹æ³•å’ŒåŠŸèƒ½ï¼Œæ¥å®Œæˆè¿™ä¸ªæ’ä»¶çš„æœ€åˆç‰ˆæœ¬ã€‚</p>

<p>åˆ—ä¸¾ä¸€ä¸‹ Wechaty ä½œä¸ºç”¨æˆ·ä¸Šæ¸¸æ—¶ï¼Œéœ€è¦ç”¨åˆ°çš„ä¸€äº›æ–¹æ³•ï¼š</p>

<ul>
  <li>æ£€æŸ¥å¾®ä¿¡å¥½å‹æˆ–ç¾¤å†…çš„ç”¨æˆ·æ˜¯å¦å·²ç»å­˜åœ¨ Authing ç”¨æˆ·æ± </li>
  <li>æ£€æŸ¥å¾®ä¿¡ç”¨æˆ·æ˜¯å¦ç»‘å®šäº† Authing è´¦å·ï¼ˆä¸»è¦ä¸ºæ‰‹æœºå·ï¼‰</li>
  <li>å½“é‚€è¯·ã€ç§»é™¤ç¾¤æˆå‘˜æ—¶å€™ï¼Œå¯¹åº”åˆ›å»ºã€åˆ é™¤ Authing ç”¨æˆ·</li>
</ul>

<p>å†åˆ—ä¸¾ä¸€ä¸‹å°† Authing ä½œä¸ºç”¨æˆ·ä¸Šæ¸¸æ—¶ï¼Œéœ€è¦ç”¨åˆ°çš„ä¸€äº›æ–¹æ³•ï¼š</p>

<ul>
  <li>æ£€æŸ¥å¾®ä¿¡çš„å¥½å‹ç”³è¯·ã€ä»¥åŠæ¶ˆæ¯ï¼Œåˆ¤æ–­æ˜¯å¦ä¸º Authing ç”¨æˆ·ï¼ˆé€šè¿‡æ¶ˆæ¯è§„åˆ™æ‰‹æœºå·æ ¡éªŒï¼‰</li>
  <li>å°†å¾®ä¿¡å·ä¸ Authing ç”¨æˆ·è¿›è¡Œå…³è”ç»‘å®š ï¼ˆé€šè¿‡æ¶ˆæ¯è§„åˆ™æ‰‹æœºå·æ ¡éªŒï¼‰</li>
</ul>

<p>ç„¶åè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæœ‰ä¸¤ä¸ªç”¨æˆ·åˆ—è¡¨çš„æ¯”è¾ƒï¼Œä¸€ä¸ªæ˜¯ Wechaty <code class="language-plaintext highlighter-rouge">Contact[]</code> åˆ—è¡¨ï¼Œä¸€ä¸ªæ˜¯ Authing <code class="language-plaintext highlighter-rouge">User[]</code> åˆ—è¡¨ï¼Œå»åˆ¤æ–­è”ç³»äººæ˜¯ä¸æ˜¯ Authing ç”¨æˆ·ã€åˆ¤æ–­è”ç³»äººæœ‰æ²¡æœ‰è¢«é‚€è¯·å…¥ç¾¤ã€æˆ–è€…åˆ¤æ–­è”ç³»äººæ˜¯å¦éœ€è¦è¢«ç§»é™¤ç¾¤èŠã€‚</p>

<p>æœ€åä»£ç å¤§æ¦‚çš„æ¡†æ¶æˆäº†è¿™ä¸ªæ ·å­ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">WechatyAuthing</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">config</span><span class="p">:</span> <span class="nx">WechatyAuthingConfig</span><span class="p">);</span>
  <span class="cm">/**
   * Get Authing SDK client
   * è·å– Authing SDK å®ä¾‹
   */</span>
  <span class="k">protected</span> <span class="kd">get</span> <span class="nx">client</span><span class="p">():</span> <span class="nx">_ManagementClient1</span><span class="p">;</span>
  <span class="cm">/**
   * Get Authing User pool name
   * @returns {Promise&lt;string&gt;}
   */</span>
  <span class="nx">getPoolName</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="cm">/** ********* AS UPSTREAM ************* */</span>
  <span class="cm">/**
   * Batch check users exists from Authing
   * æ£€æŸ¥æ˜¯å¦æ³¨å†Œä¸º Authing ç”¨æˆ·
   * @param {Contact[]} contacts Wechaty Contact[]
   * @returns {ContactsFilterResult} { registered: Contact[]; unregistered: Contact[]; fail: Contact[] }
   */</span>
  <span class="nx">filterAuthingUsers</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="nx">Contact</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="nx">contacts</span><span class="p">:</span> <span class="nx">T</span><span class="p">[]</span>
  <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ContactsFilterResult</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="cm">/**
   * Batch create users to Authing
   * å‘ Authing ç”¨æˆ·æ± ä¸­æ‰¹é‡åˆ›å»ºç”¨æˆ·
   * @param {Contact[]} contacts Wechaty Contact[]
   * @returns {ContactsOperationResult} {success: Contact[], fail: Contact[]}
   */</span>
  <span class="nx">createAuthingUsers</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="nx">Contact</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="nx">contacts</span><span class="p">:</span> <span class="nx">T</span><span class="p">[]</span>
  <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ContactsOperationResult</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="cm">/**
   * Batch delete users from Authing
   * ä» Authing ç”¨æˆ·æ± ä¸­æ‰¹é‡åˆ é™¤ Wechaty ç”¨æˆ·
   * @param {Contact[]} contacts Wechaty Contact[]
   * @returns {ContactsOperationResult} {success: Contact[], fail: Contact[]}   */</span>
  <span class="nx">deleteAuthingUsers</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="nx">Contact</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="nx">contacts</span><span class="p">:</span> <span class="nx">T</span><span class="p">[]</span>
  <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">ContactsOperationResult</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="cm">/**
   * Create or update a authing user with Wechaty contact and phone
   * ç»‘å®š Contact å’Œæ‰‹æœºå·ç åˆ° Authing ç”¨æˆ·ï¼ˆæˆ–åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼‰
   * @param {Contact} contact
   * @param {string} phone
   * @returns {Promise&lt;boolean&gt;}
   */</span>
  <span class="nx">bindAuthingPhone</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="nx">Contact</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">contact</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">phone</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="cm">/** ********* AS DOWNSTREAM ************* */</span>
  <span class="cm">/**
   * Check if user with the phone number exists in Authing
   * æ£€æŸ¥æ‰‹æœºå·æ˜¯å¦æ³¨å†Œä¸º Authing ç”¨æˆ·
   * @param {string} phone
   * @returns {Promise&lt;boolean&gt;}
   */</span>
  <span class="nx">checkPhone</span><span class="p">(</span><span class="nx">phone</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="cm">/**
   * Bind Wechaty contact to a Authing user by phone number
   * å°† Wechaty Contact ç»‘å®šåˆ° Authing æ‰‹æœºå·çš„ç”¨æˆ·
   * @param {string} phone
   * @param {Contact} contact
   * @returns {Promise&lt;boolean&gt;}
   */</span>
  <span class="nx">bindPhoneContact</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="nx">Contact</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">phone</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">contact</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="cm">/** ********* PROTECTED ************* */</span>
  <span class="cm">/**
   * Create Authing user
   * åˆ›å»º Authing ç”¨æˆ·
   * @param {Contact} contact
   * @returns {User | null}
   */</span>
  <span class="k">protected</span> <span class="nx">createAuthingUser</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="nx">Contact</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">contact</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">User</span> <span class="o">|</span> <span class="kc">null</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å¦å¤–ï¼Œåœ¨åˆšå¼€å§‹ POC çš„æ—¶å€™ï¼Œæˆ‘ä½¿ç”¨äº†å¤§é‡ä½æ•ˆçš„ä»£ç å»å®ç°è¯¥åŠŸèƒ½ï¼Œå¦‚ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ç­›é€‰å‡ºç”¨æˆ·ä¸­çš„å¥½å‹</span>
<span class="kd">const</span> <span class="nx">friends</span> <span class="o">=</span> <span class="nx">allFriends</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
  <span class="p">(</span><span class="nx">contact</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">~</span><span class="nx">users</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">user</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">externalId</span> <span class="o">===</span> <span class="nx">contact</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">// åˆ é™¤æˆå‘˜å’Œæé†’ä¸ç¡®å®šçŠ¶æ€</span>
<span class="kd">const</span> <span class="nx">members2Delete</span> <span class="o">=</span> <span class="nx">memberList</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
  <span class="p">(</span><span class="nx">member</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">~</span><span class="nx">deletedUsers</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">user</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">externalId</span> <span class="o">===</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
<span class="p">);</span>
<span class="kd">const</span> <span class="nx">members2Warning</span> <span class="o">=</span> <span class="nx">memberList</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
  <span class="p">(</span><span class="nx">member</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="o">!~</span><span class="nx">deletedUsers</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">user</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">externalId</span> <span class="o">===</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
    <span class="o">!~</span><span class="nx">users</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">user</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">externalId</span> <span class="o">===</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
<span class="p">);</span>
<span class="c1">// æ£€æŸ¥æœªå…¥ç¾¤çš„å¥½å‹</span>
<span class="kd">const</span> <span class="nx">members2Invite</span> <span class="o">=</span> <span class="nx">friends</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
  <span class="p">(</span><span class="nx">friend</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">!~</span><span class="nx">memberList</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">member</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">friend</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œä¼˜åŒ–äº†å‡ ä¸ªå·¥å…·æ–¹æ³•ï¼š</p>

<ul>
  <li>é€šè¿‡ Set ç‰¹æ€§å–ä¸¤ä¸ªæ•°ç»„çš„å·®é›†</li>
  <li>è·å– Wechaty ç”¨æˆ·çœŸå®çš„å”¯ä¸€ ID</li>
</ul>

<p>å…¶å®åœ¨é›†æˆè¿‡ç¨‹ä¸­è¿˜æœ‰å¾ˆå¤šç»†èŠ‚çš„ç‚¹éœ€è¦æ³¨æ„ï¼Œæˆ‘ä¼šéƒ½åœ¨æ–‡ç« æœ€åçš„ç« èŠ‚é‡Œè¿›è¡Œæ•´ç†ã€‚</p>

<h3 id="æµ‹è¯•">æµ‹è¯•</h3>

<p>ç›®å‰çš„ä»£ç è´¨é‡ Aï¼Œæµ‹è¯•è¦†ç›–ç‡ä¸º 98%ã€‚å¦‚æœä½ å¯¹äºè¿™ä¸ªæ’ä»¶æ„Ÿå…´è¶£ï¼Œæµ‹è¯•ç”¨ä¾‹ä¸ä»…ä»…æ˜¯ä½ å‚ä¸è´¡çŒ®çš„æœ€å¥½å¼€å§‹ï¼Œå…¶å®ä¹Ÿæ˜¯æ’ä»¶ä½¿ç”¨çš„ç»ä½³æ¡ˆä¾‹ã€‚</p>

<p>å…¶ä¸­ä¹ŸåŒ…æ‹¬äº†ç¤ºä¾‹åˆå§‹åŒ–ã€å„ä¸ªæ–¹æ³•è°ƒç”¨å’Œè¿”å›å€¼æœŸå¾…ã€å·¥å…·æ–¹æ³•çš„ä½¿ç”¨ï¼Œä»¥åŠæ‰©å±•å¼€å‘çš„ä¸€äº›ç»†èŠ‚ã€‚</p>

<p>ä»¥æ‹“å±•æ’ä»¶çš„æµ‹è¯•ç”¨ä¾‹ä¸ºä¾‹ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//https://github.com/Authing/wechaty-authing/blob/main/test/extends.spec.ts</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">WechatyAuthing</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../src</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">extension</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">client</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">class</span> <span class="nx">ExtendedWechatyAuthing</span> <span class="kd">extends</span> <span class="nx">WechatyAuthing</span> <span class="p">{</span>
      <span class="k">async</span> <span class="nx">totalUsers</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="p">{</span> <span class="nx">totalCount</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">list</span><span class="p">();</span>
        <span class="k">return</span> <span class="nx">totalCount</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ExtendedWechatyAuthing</span><span class="p">({</span>
      <span class="na">userPoolId</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">AUTHING_USER_POOL_ID</span><span class="p">,</span>
      <span class="na">secret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">AUTHING_USER_POOL_SECRET</span>
    <span class="p">});</span>
    <span class="kd">const</span> <span class="nx">count</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">totalUsers</span><span class="p">();</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">count</span><span class="p">).</span><span class="nx">toBeGreaterThan</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<p>å½“ç„¶ï¼Œå…·ä½“çš„æ’ä»¶ä½¿ç”¨ç»†èŠ‚ï¼Œå¯ä»¥é€šè¿‡é¡¹ç›® README æ–‡ä»¶æŸ¥çœ‹ï¼Œæä¾›äº†ä¸­è‹±æ–‡ä¸¤ä¸ªç‰ˆæœ¬ã€‚</p>

<h2 id="ä¸Šæ‰‹åšå‡ ä¸ªæœºå™¨äººå§">ä¸Šæ‰‹åšå‡ ä¸ªæœºå™¨äººå§</h2>

<p>ç¤ºä¾‹ä¸­ï¼ˆæ¥è‡ª POC é¡¹ç›®ï¼‰ä½¿ç”¨çš„ Wechaty ç‰ˆæœ¬ä¸º <code class="language-plaintext highlighter-rouge">0.75</code> å’Œ puppty ä¸º <code class="language-plaintext highlighter-rouge">padlocal</code> ï¼ˆåŸºäº iPad å¾®ä¿¡åè®®ï¼‰ã€‚å¯ä»¥è®¿é—®ç¤ºä¾‹ä»£ç ä»“åº“ä¸‹è½½ï¼š <a href="https://github.com/Authing/wechaty-authing-poc">https://github.com/Authing/wechaty-authing-poc</a></p>

<h3 id="ä½¿ç”¨å¾®ä¿¡ç¾¤ä½œä¸ºä¸Šæ¸¸ç”¨æˆ·æ•°æ®">ä½¿ç”¨å¾®ä¿¡ç¾¤ä½œä¸ºä¸Šæ¸¸ç”¨æˆ·æ•°æ®</h3>

<h4 id="ç®¡ç†å‘˜é‚€è¯·ç”¨æˆ·åŠ å…¥ç¾¤ç»„äººä¸ºæ“ä½œ">ç®¡ç†å‘˜é‚€è¯·ç”¨æˆ·åŠ å…¥ç¾¤ç»„ï¼ˆäººä¸ºæ“ä½œï¼‰</h4>

<p>ä¾¦å¬ <code class="language-plaintext highlighter-rouge">room-join</code> äº‹ä»¶è§¦å‘ï¼Œè·å¾—è¢«é‚€è¯·äººå‘˜åå•ï¼ˆ<em>inviteeList</em>ï¼‰ã€‚æ£€æŸ¥ Authing ç”¨æˆ·æ± ï¼Œç­›é€‰å‡ºæœªæ³¨å†Œçš„ç”¨æˆ·åˆ—è¡¨ï¼Œæ‰¹é‡æ³¨å†Œç”¨æˆ·ï¼Œå¹¶å‘é€æ¶ˆæ¯æç¤ºç»‘å®šç”¨æˆ·æ‰‹æœºå·ã€‚</p>

<h4 id="ç®¡ç†å‘˜è¸¢å‡ºç¾¤èŠç”¨æˆ·äººä¸ºæ“ä½œ">ç®¡ç†å‘˜è¸¢å‡ºç¾¤èŠç”¨æˆ·ï¼ˆäººä¸ºæ“ä½œï¼‰</h4>

<p>ä¾¦å¬ <code class="language-plaintext highlighter-rouge">room-leave</code> äº‹ä»¶è§¦å‘ï¼Œè·å¾—è¢«ç§»é™¤äººå‘˜åå•ï¼ˆ<em>leaverList</em>ï¼‰ã€‚ä» Authing ç”¨æˆ·æ± ä¸­æ‰¹é‡åˆ é™¤ã€‚æç¤ºåˆ é™¤æˆåŠŸçš„ç”¨æˆ·åï¼ˆåˆ—è¡¨ï¼‰ã€‚</p>

<p>å¦‚æœæœ‰åˆ é™¤å¤±è´¥çš„ï¼ˆä¸ç¡®å®šåŸå› å¼•èµ·ï¼‰ï¼Œæç¤ºåˆ é™¤å¤±è´¥çš„ç”¨æˆ·åï¼ˆåˆ—è¡¨ï¼‰ï¼Œè¯·ç®¡ç†å‘˜æ‰‹åŠ¨åˆ é™¤ã€‚</p>

<h4 id="ç”¨æˆ·-bot-æåŠæ¶ˆæ¯">ç”¨æˆ· @Bot æåŠæ¶ˆæ¯</h4>

<p>ä¾¦å¬ <code class="language-plaintext highlighter-rouge">message</code> äº‹ä»¶è§¦å‘ï¼Œå¦‚æœéæåŠæ¶ˆæ¯ï¼Œæˆ–è€…æ¶ˆæ¯ä¸­ä¸åŒ…å«æ‰‹æœºå·ï¼Œåˆ™ä¸å¤„ç†ã€‚</p>

<p>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œä¿®æ”¹ç»‘å®šçš„æ‰‹æœºå·ä¸ºç”¨æˆ·è¾“å…¥çš„ï¼ˆå¯èƒ½å‡ºç°é‡å¤æ‰‹æœºå·ç»‘å®šå¤±è´¥ï¼‰ï¼›å¦‚æœç”¨æˆ·ä¸å­˜åœ¨æ³¨å†Œä¸€ä¸ªæ–°ç”¨æˆ·ã€‚</p>

<p>å¦‚æœç»‘å®šæˆåŠŸï¼Œå‘é€æ¶ˆæ¯æç¤ºã€‚</p>

<h4 id="å®ç°-1">å®ç°</h4>

<p>ä»£ç ä½äº POC é¡¹ç›® <code class="language-plaintext highlighter-rouge">upstream</code> ç›®å½•ã€‚</p>

<p>é¦–å…ˆåœ¨ Bot å¯åŠ¨æ—¶ï¼Œè¿›è¡Œä¸€éç¾¤æˆå‘˜çš„æ£€æŸ¥ï¼š</p>

<p><img src="/assets/2022/01-authing-wechaty-intergration/1.webp" alt="mermaid" /></p>

<p>åŒæ—¶è¿˜ä¾¦å¬äº†ä¸¤ä¸ª Wechaty äº‹ä»¶ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">room-join</code>ï¼šç®¡ç†å‘˜é‚€è¯·ç”¨æˆ·åŠ å…¥ç¾¤ç»„ï¼ˆäººä¸ºæ“ä½œï¼‰</li>
  <li><code class="language-plaintext highlighter-rouge">room-leave</code>ï¼šç®¡ç†å‘˜è¸¢å‡ºç¾¤èŠç”¨æˆ·ï¼ˆäººä¸ºæ“ä½œï¼‰</li>
</ul>

<p><img src="/assets/2022/01-authing-wechaty-intergration/2.webp" alt="mermaid" /></p>

<h4 id="ä»£ç ä¹‹å¤–">ä»£ç ä¹‹å¤–</h4>

<p>å½“å¾®ä¿¡ç”¨æˆ·ç»‘å®šåˆ° Authing ç”¨æˆ·æ± ä¹‹åï¼Œè¿˜å¯ä»¥åšäº›ä»€ä¹ˆå‘¢ï¼Ÿæ¯”å¦‚åŒæ­¥ä¼ä¸šæˆå‘˜ä¿¡æ¯åˆ°é£ä¹¦ï¼Œè¿æ¥åˆ°å„ç§ SSO å•ç‚¹ç™»å½•åº”ç”¨ç­‰ã€‚å‘æŒ¥æƒ³è±¡åŠ›çš„æ—¶é—´åˆ°äº†ï¼Œæ”¹å˜ç”Ÿäº§åŠ›ï¼Œæˆ–è®¸å¹¶ä¸æ˜¯é‚£ä¹ˆé¥ä¸å¯åŠçš„äº‹æƒ…ã€‚</p>

<h3 id="ä»¥-authing-ç”¨æˆ·ä½œä¸ºä¸Šæ¸¸-wechaty-ç”¨æˆ·ä½œä¸ºä¸‹æ¸¸">ä»¥ Authing ç”¨æˆ·ä½œä¸ºä¸Šæ¸¸ï¼Œ Wechaty ç”¨æˆ·ä½œä¸ºä¸‹æ¸¸</h3>

<p>ç”¨æˆ·æ•°æ®æ¥æºä¹Ÿå¯èƒ½æ˜¯åŒæ­¥ä¸­å¿ƒé‡Œæ¥è‡ªé£ä¹¦æˆ–å…¶ä»–èº«ä»½æºçš„ç”¨æˆ·æ•°æ®ã€‚<strong><em>å…¶ä¸­æœ‰ä¸€æ­¥ï¼Œåœ¨ Authing ç”¨æˆ·æ± ä¸­æ·»åŠ æ–°ç”¨æˆ·åï¼Œè¦æ±‚ç”¨æˆ·ä¸»åŠ¨æ·»åŠ  Bot ä¸ºå¥½å‹ï¼Œå¿…é¡»ã€‚</em></strong></p>

<p>åœ¨ Bot å¯åŠ¨æ—¶ï¼Œæ£€æŸ¥å¾®ä¿¡ä¸­æ˜¯å¦å­˜åœ¨å…¨å‘˜ç¾¤ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±åˆ›å»ºä¸€ä¸ªï¼ˆä½†å¦‚æœä¼ä¸šæˆå‘˜æ•°é‡ä¸å¤Ÿ 3 ä¸ªï¼Œä¸èƒ½åˆ›å»ºç¾¤èŠçš„æ—¶å€™ï¼Œæœºå™¨äººå°±ä¼šç­‰ä¸»åŠ¨æ·»åŠ çš„å¥½å‹ï¼‰ã€‚å…¨å‘˜ç¾¤å­˜åœ¨ä¹‹åï¼Œå°±å¼€å§‹å®šæ—¶ä»»åŠ¡æ£€æŸ¥æ˜¯å¦æœ‰ç¦»èŒæˆå‘˜éœ€è¦è¸¢å‡ºç¾¤èŠï¼Œä»¥åŠæ–°å…¥èŒçš„æˆå‘˜é‚€è¯·åŠ å…¥ç¾¤èŠäº†ã€‚</p>

<p><img src="/assets/2022/01-authing-wechaty-intergration/3.webp" alt="mermaid" /></p>

<p>å…¶ä¸­ï¼Œå…³è” Authing ç”¨æˆ·å’Œ Wechaty è”ç³»äººçš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ã€‚å°±æ˜¯é€šè¿‡å¥½å‹è¯·æ±‚æˆ–è€…æ¶ˆæ¯ï¼Œå‘é€æ‰‹æœºå·ç ï¼Œæ£€æŸ¥ Authing ç”¨æˆ·æ± ä¸­æ˜¯å¦å­˜åœ¨ã€‚</p>

<p><img src="/assets/2022/01-authing-wechaty-intergration/4.webp" alt="mermaid" /></p>

<h3 id="æ‰©å±•-wechaty-authing-æ’ä»¶å»å®ç°æ›´å¤æ‚çš„ä¸šåŠ¡">æ‰©å±• wechaty-authing æ’ä»¶å»å®ç°æ›´å¤æ‚çš„ä¸šåŠ¡</h3>

<h4 id="æ‰©å±•-authing-sdk-çš„ä½¿ç”¨">æ‰©å±• Authing SDK çš„ä½¿ç”¨</h4>

<p><code class="language-plaintext highlighter-rouge">wechaty-authing</code> æä¾›äº† protected çš„ client å®ä¾‹ï¼ˆå¯¹åº”ç€ authing sdk é‡Œçš„ <code class="language-plaintext highlighter-rouge">ManagementClient</code>ï¼‰ã€‚</p>

<p>æ‰€ä»¥å¯ä»¥å‚è€ƒ Authing å®˜æ–¹çš„æ–‡æ¡£è¿›è¡Œæ·±åº¦å¼€å‘ã€‚ç¤ºä¾‹ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">ExtendedWechatyAuthing</span> <span class="kd">extends</span> <span class="nx">WechatyAuthing</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">totalUsers</span><span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">totalCount</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">list</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">totalCount</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å‚è€ƒæ–‡æ¡£ï¼š <a href="https://docs.authing.cn/v2/reference/sdk-for-node/management/">https://docs.authing.cn/v2/reference/sdk-for-node/management/</a></p>

<h4 id="æ‰©å±•-wechaty-æ’ä»¶">æ‰©å±• Wechaty æ’ä»¶</h4>

<p>åŒæ—¶å¼€å¯ä»¥å°è£…ä¸€äº› Wechaty æ’ä»¶åŠŸèƒ½ã€‚ç¤ºä¾‹ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">ExtendedWechatyAuthing</span> <span class="kd">extends</span> <span class="nx">WechatyAuthing</span> <span class="p">{</span>
  <span class="nx">plugin</span><span class="p">():</span> <span class="nx">WechatyPlugin</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">bot</span><span class="p">:</span> <span class="nx">Wechaty</span><span class="p">):</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">bot</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ready</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="p">{</span> <span class="nx">totalCount</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">client</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">list</span><span class="p">();</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="dl">'</span><span class="s1">total users</span><span class="dl">'</span><span class="p">,</span> <span class="nx">totalCount</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">authing</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ExtendedWechatyAuthing</span><span class="p">({</span>
  <span class="na">userPoolId</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">AUTHING_USER_POOL_ID</span><span class="p">,</span>
  <span class="na">secret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">AUTHING_USER_POOL_SECRET</span>
<span class="p">});</span>
<span class="kd">const</span> <span class="nx">bot</span> <span class="o">=</span> <span class="nx">createBot</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">WECHATY_PADLOCAL_TOKEN</span><span class="p">);</span>
<span class="nx">bot</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">authing</span><span class="p">.</span><span class="nx">plugin</span><span class="p">());</span>
</code></pre></div></div>

<p>æ›´å¤šå…³äº Wechaty æ’ä»¶çš„ä½¿ç”¨åŠå¼€å‘ï¼Œå¯ä»¥è®¿é—®ï¼š <a href="https://wechaty.js.org/docs/using-plugin-with-wechaty/overview">https://wechaty.js.org/docs/using-plugin-with-wechaty/overview</a></p>

<hr />

<h3 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h3>

<h3 id="å¾®ä¿¡é™åˆ¶">å¾®ä¿¡é™åˆ¶</h3>

<ul>
  <li>å¾®ä¿¡å¥½å‹ä¸Šé™ï¼š 5000 äºº <a href="https://kf.qq.com/faq/161223IrAjUn161223riUzaa.html">https://kf.qq.com/faq/161223IrAjUn161223riUzaa.html</a></li>
  <li>ä¸»åŠ¨æ·»åŠ å¥½å‹ï¼š æ¯æ—¥ 30 æ¬¡è¯·æ±‚ä¸Šé™</li>
  <li>è¢«åŠ¨æ·»åŠ å¥½å‹ï¼š æ¯æ—¥ 180 æ¬¡è¯·æ±‚ä¸Šé™</li>
  <li>é‚€è¯·åŠ ç¾¤ï¼š <a href="https://kf.qq.com/faq/161223uIfIre161223aUrmqU.html">https://kf.qq.com/faq/161223uIfIre161223aUrmqU.html</a>
    <ul>
      <li>è¶…è¿‡ 40 äººç¾¤éœ€è¦å¯¹æ–¹åŒæ„</li>
      <li>è¶…è¿‡ 100 äººç¾¤éœ€è¦å¯¹æ–¹å¼€é€šå¾®ä¿¡æ”¯ä»˜ï¼ˆå®åã€ç»‘å¡ï¼‰</li>
      <li>æ™®é€šç¾¤äººæ•°ä¸Šé™ 500</li>
    </ul>
  </li>
</ul>

<h3 id="wechaty-contact-å”¯ä¸€-id-è¯´æ˜">Wechaty Contact å”¯ä¸€ ID è¯´æ˜</h3>

<p>ç›®å‰å·²çŸ¥çš„ id æ ¼å¼ï¼š</p>

<ul>
  <li>å¤–éƒ¨
    <ul>
      <li><code class="language-plaintext highlighter-rouge">$search$-weixin</code></li>
      <li><code class="language-plaintext highlighter-rouge">$search$-13212341234</code></li>
      <li><code class="language-plaintext highlighter-rouge">weixin</code> / <code class="language-plaintext highlighter-rouge">wxid_xxxx</code></li>
    </ul>
  </li>
  <li>Payload å†…éƒ¨
    <ul>
      <li><code class="language-plaintext highlighter-rouge">$search$-</code> éå¥½å‹ <code class="language-plaintext highlighter-rouge">v3_xxxxx@stranger</code></li>
      <li><code class="language-plaintext highlighter-rouge">weixin</code> / <code class="language-plaintext highlighter-rouge">wxid_xxxx</code></li>
      <li>ä¸çŸ¥é“æ˜¯å•¥çš„ã€‚å¦‚ <code class="language-plaintext highlighter-rouge">qq1111</code> ä½† weixin å­—æ®µä¸ºå¾®ä¿¡å· <code class="language-plaintext highlighter-rouge">xxxx</code></li>
    </ul>
  </li>
</ul>

<h3 id="wechaty-å¯èƒ½ä¼šå‡ºç°çš„ä¸€äº›é—®é¢˜">Wechaty å¯èƒ½ä¼šå‡ºç°çš„ä¸€äº›é—®é¢˜</h3>

<h4 id="ç‰ˆæœ¬">ç‰ˆæœ¬</h4>

<p>Wechaty 1.x ç‰ˆæœ¬ä¸ä¹‹å‰çš„ç‰ˆæœ¬å·®è·ï¼Œå¦‚ç±»å‹å£°æ˜ã€åˆ›å»ºå®ä¾‹çš„æ–¹å¼ï¼Œéœ€è¦æ³¨æ„ä½ ä½¿ç”¨çš„ <code class="language-plaintext highlighter-rouge">puppet</code> æ”¯æŒä»€ä¹ˆç‰ˆæœ¬ã€‚</p>

<h4 id="ä¸»åŠ¨æœç´¢">ä¸»åŠ¨æœç´¢</h4>

<p>æœ‰ä¸¤ç§æœç´¢æ–¹å¼ï¼Œé€šè¿‡æ‰‹æœºå·å’Œé€šè¿‡å¾®ä¿¡å·ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">contact</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">Friendship</span><span class="p">.</span><span class="nx">search</span><span class="p">({</span> <span class="na">phone</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">phone</span><span class="o">!</span> <span class="p">});</span>
<span class="kd">const</span> <span class="nx">contact</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">Friendship</span><span class="p">.</span><span class="nx">search</span><span class="p">({</span> <span class="na">weixin</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">externalId</span><span class="o">!</span> <span class="p">});</span>
</code></pre></div></div>

<p>è·å¾—çš„ç»“æœå‡æ— æ³•è·å–åˆ°å”¯ä¸€ idï¼š</p>

<pre><code class="language-plain">æ˜µç§°ï¼šWillinï¼Œidï¼š $search$-132XXXXXXXX
æ˜µç§°ï¼šXXXXï¼Œidï¼š $search$-186XXXXXXXX

æ˜µç§°ï¼šWillinï¼Œidï¼š $search$-weixinXXXX
æ˜µç§°ï¼šXXXï¼Œidï¼š $search$-weixinXXXX
</code></pre>

<p>è§£å†³ï¼šå¦‚æœæ˜¯å¥½å‹ï¼Œåˆ™å¯ä»¥ä» contact.payload.id ä¸­è·å¾—ã€‚</p>

<h4 id="å¼‚å¸¸è¯·æ±‚å¤±è´¥">å¼‚å¸¸è¯·æ±‚å¤±è´¥</h4>

<p>æ¯”å¦‚æŸ¥æ‰¾æŸä¸ªæ‰‹æœºå·æˆ–è€…å¾®ä¿¡å·ï¼Œå¡«å†™çš„å‚æ•°æ­£ç¡®ã€‚ <code class="language-plaintext highlighter-rouge">Friendship.search</code> ç»å¸¸å‡ºç°ï¼š</p>

<pre><code class="language-plain">================================================================================

VError: [tid:e05dff73] request has been cancelled for reason: SERVER_ERROR: 2 UNKNOWN: [tid:e05dff73] wechat bad request error
    at Request._failAllPendingRequest (/Users/v0/Projects/Authing/wechaty-authing-poc/node_modules/padlocal-client-ts/src/Request.ts:334:15)
    at ClientDuplexStreamImpl.&lt;anonymous&gt; (/Users/v0/Projects/Authing/wechaty-authing-poc/node_modules/padlocal-client-ts/src/Request.ts:82:12)
    at ClientDuplexStreamImpl.emit (node:events:390:28)
    at ClientDuplexStreamImpl.emit (node:domain:475:12)
    at Object.onReceiveStatus (/Users/v0/Projects/Authing/wechaty-authing-poc/node_modules/@grpc/grpc-js/src/client.ts:673:18)
    at Object.onReceiveStatus (/Users/v0/Projects/Authing/wechaty-authing-poc/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at /Users/v0/Projects/Authing/wechaty-authing-poc/node_modules/@grpc/grpc-js/src/call-stream.ts:323:24
    at processTicksAndRejections (node:internal/process/task_queues:78:11)
error Command failed with exit code 1.
</code></pre>

<h4 id="è·å–çš„ä¿¡æ¯ä¸å‡†ç¡®">è·å–çš„ä¿¡æ¯ä¸å‡†ç¡®</h4>

<p>å¦‚ <code class="language-plaintext highlighter-rouge">room.memberAll()</code>ï¼Œ è¯¥æ–¹æ³•æœ‰æ—¶èƒ½å¤Ÿè·å–å®Œæ•´ç¾¤æˆå‘˜ä¿¡æ¯ã€‚æœ‰æ—¶åªèƒ½è¿”å› id åˆ—è¡¨ã€‚</p>

<p>å®Œæ•´çš„æ•°æ®åº”è¯¥æ˜¯è¿™æ ·ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="na">_events</span><span class="p">:</span> <span class="p">{},</span>
    <span class="na">_eventsCount</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">xxxx</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">payload</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">xxxx</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">gender</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">type</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Willin</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">avatar</span><span class="p">:</span>
        <span class="dl">'</span><span class="s1">https://wx.qlogo.cn/mmhead/ver_1/lY8XLaibGJAiajvtTPx5kdDs2T3qGToUm0mHFTYGRzcaVydJZwnibQKMNKDzv2WosXJu2aUU8lteT1R6FCKVK3PUg/0</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">alias</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">weixin</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">city</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Lianyungang</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">friend</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">province</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Jiangsu</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">signature</span><span class="p">:</span> <span class="dl">'</span><span class="s1">æ‰€æœ‰çš„å‡ºå‘  </span><span class="se">\n</span><span class="s1">éƒ½æ˜¯ä¸ºäº†å›å®¶</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">phone</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">];</span>
</code></pre></div></div>

<p>æœ‰çš„æ—¶å€™ä¼šå˜æˆè¿™æ ·ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="na">_events</span><span class="p">:</span> <span class="p">{},</span>
    <span class="na">_eventsCount</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">xxxx</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">];</span>
</code></pre></div></div>

<h2 id="refs">Refs</h2>

<ul>
  <li>Wechaty Authing æ’ä»¶ä»“åº“ï¼š <a href="https://github.com/Authing/wechaty-authing">https://github.com/Authing/wechaty-authing</a></li>
  <li>åŸºäºè¯¥æ’ä»¶çš„ POC ç¤ºä¾‹ä»£ç ä»“åº“ï¼š <a href="https://github.com/Authing/wechaty-authing-poc">https://github.com/Authing/wechaty-authing-poc</a></li>
</ul>]]></content><author><name>willin</name></author><category term="project" /><category term="sso" /><category term="authing" /><category term="ecosystem" /><summary type="html"><![CDATA[ç”¨æˆ·æ•…äº‹]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/01-authing-wechaty-intergration/2.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/01-authing-wechaty-intergration/2.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">2022å¯’å‡-ç‹å¤©ç¿-JuziBoté¡¹ç›®å¼€å‘-æœŸä¸­æŠ¥å‘Š-æ™ºèƒ½ä¿¡æ¯åŠ©ç†</title><link href="https://wechaty.js.org/2022/01/18/begin-intern-juzibot-report/" rel="alternate" type="text/html" title="2022å¯’å‡-ç‹å¤©ç¿-JuziBoté¡¹ç›®å¼€å‘-æœŸä¸­æŠ¥å‘Š-æ™ºèƒ½ä¿¡æ¯åŠ©ç†" /><published>2022-01-18T00:00:00+00:00</published><updated>2022-01-18T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/01/18/begin-intern-juzibot-report</id><content type="html" xml:base="https://wechaty.js.org/2022/01/18/begin-intern-juzibot-report/"><![CDATA[<h2 id="2022å¯’å‡-ç‹å¤©ç¿-juziboté¡¹ç›®å¼€å‘-æœŸä¸­æŠ¥å‘Š-æ™ºèƒ½ä¿¡æ¯åŠ©ç†">2022å¯’å‡-ç‹å¤©ç¿-JuziBoté¡¹ç›®å¼€å‘-æœŸä¸­æŠ¥å‘Š-æ™ºèƒ½ä¿¡æ¯åŠ©ç†</h2>

<h3 id="é¡¹ç›®å‚ä¸äºº">é¡¹ç›®å‚ä¸äºº</h3>

<ul>
  <li>å¯¼å¸ˆï¼šæ®µæ¸…å</li>
  <li>å­¦ç”Ÿï¼šç‹å¤©ç¿</li>
</ul>

<h3 id="é¡¹ç›®ç›®æ ‡">é¡¹ç›®ç›®æ ‡</h3>

<p>Juzibot æ™ºèƒ½çš„ä¿¡æ¯åŠ©ç† ï¼Œâ€œå°æ©˜å­â€è®©æ‚¨çš„ç”Ÿæ´»æ›´åŠ é«˜æ•ˆ ï¼</p>

<h3 id="ä¸»è¦åŠŸèƒ½">ä¸»è¦åŠŸèƒ½</h3>

<ol>
  <li>å¤‡å¿˜å½•(å·²æœ‰)
    <ul>
      <li>ç›´æ¥è¾“å…¥çš„æ–‡æœ¬ã€è½¬å‘çš„æ–‡æœ¬</li>
      <li>è¯­éŸ³è¾“å…¥ã€å›¾ç‰‡ã€è§†é¢‘ã€é“¾æ¥å­˜å‚¨ç­‰å¤šåª’ä½“ä¿¡æ¯</li>
      <li>è¾“å…¥æ–‡æœ¬ä¸­åŒ…å«æ ‡ç­¾ç¬¦å·</li>
    </ul>
  </li>
  <li>TODOåˆ—è¡¨(å·²æœ‰ï¼‰</li>
  <li>æœç´¢æŒ‡ä»¤(éƒ¨åˆ†)</li>
  <li>å…¶ä»–æŒ‡ä»¤(å¾…å®Œå–„)
    <ul>
      <li>ä¾‹å¦‚
        <ol>
          <li>æ‰“å¼€web/å°ç¨‹åºç®¡ç†ç•Œé¢</li>
          <li>ç¾¤æ–‡ä»¶</li>
          <li>æˆ‘çš„æ–‡ä»¶</li>
        </ol>
      </li>
    </ul>
  </li>
</ol>

<h3 id="é¡¹ç›®è®¡åˆ’">é¡¹ç›®è®¡åˆ’</h3>

<ol>
  <li>01/13-01/17 : æˆåŠŸè¿è¡Œdingdong botï¼Œè¿è¡Œjuzibot åˆæ­¥äº†è§£juzibot æ¨¡å— å¹¶å­¦ä¹ nodejs</li>
  <li>01/18-01/25 : å¼€å§‹æ ¹æ®ç°æœ‰åŠŸèƒ½ä¹¦å†™æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒæ—¶æ·±å…¥äº†è§£juzibotå¯¹åº”æ¨¡å—åŠŸèƒ½</li>
  <li>01/26-02/11 : ç°æœ‰åŠŸèƒ½çš„å®Œå–„ä¸æµ‹è¯•ç”¨ä¾‹çš„æŒç»­ç¼–å†™</li>
  <li>02/12- : é›†æˆæµ‹è¯•ä¸å…¶ä»–åŠŸèƒ½å¼€å‘</li>
</ol>

<h3 id="é¡¹ç›®è¿›å±•">é¡¹ç›®è¿›å±•</h3>

<table>
  <thead>
    <tr>
      <th>æ—¶é—´</th>
      <th>é‡ç‚¹å·¥ä½œ</th>
      <th>å…³é”®è¿›å±•</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>01/13</td>
      <td>å­¦ä¹  wechatyï¼›è·‘é€šgetting started é¡¹ç›®</td>
      <td>æˆåŠŸéƒ¨ç½²dingdong botåˆ°æœå‹™å™¨</td>
    </tr>
    <tr>
      <td>01/14</td>
      <td>ä½¿ç”¨juzibot å¹¶åˆæ­¥å­¦ä¹ nodejs</td>
      <td>æˆåŠŸåœ¨æœåŠ¡å™¨ä¸Šè·‘é€šå¹¶å¯ä»¥å®ç°äº¤äº’</td>
    </tr>
    <tr>
      <td>01/15</td>
      <td>ç»§ç»­å­¦ä¹ nodejs ç®€å•ä¿®æ”¹juzibotè‡ªåŠ¨å›å¤ä»£ç </td>
      <td>å¯¹Juzibot æœ‰äº†å¤§ä½“çš„è®¤è¯†  ç®€å•ä¿®æ”¹ä»£ç å®ç°å…³é”®è¯å›å¤å¯¹åº”çš„è¯­å¥</td>
    </tr>
    <tr>
      <td>01/18</td>
      <td>ä½¿ç”¨jekyll å®Œæ•´çš„å°è¯•ä¸€æ¬¡æäº¤pr</td>
      <td>è°·æ­Œäº†æŠ¥é”™é—®é¢˜ï¼Œå¹¶åœ¨æ®µæ¸…åè€å¸ˆå’ŒåŒäº‹çš„å¸®åŠ©ä¸‹ï¼Œè§£å†³äº†é—®é¢˜å®Œæˆæäº¤</td>
    </tr>
    <tr>
      <td>01/19-22</td>
      <td>ä½¿ç”¨mocha åˆæ­¥å®Œæˆæ¨¡å—æµ‹è¯•</td>
      <td><a href="https://github.com/deepdialog/xiaojuzi/commits/master">Link</a></td>
    </tr>
    <tr>
      <td>01/24-28</td>
      <td>ä¿®æ”¹ä»£ç  å®Œå–„æ›´å¤šæ¨¡å—,ä¿®æ”¹å®Œå–„åŒ¹é…è§„åˆ™</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<h3 id="æ¨¡å—æµ‹è¯•åˆ—è¡¨">æ¨¡å—æµ‹è¯•åˆ—è¡¨</h3>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />docxè½¬æ¢ä¸ºæ–‡æœ¬</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />æ–‡ä»¶ç®¡ç†</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />å›¾ç‰‡è½¬æ¢ä¸ºå¥å­ï¼ˆæœ¬åœ°RESTï¼‰</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />å¯¹è±¡å­˜å‚¨</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />å›¾ç‰‡ä¸­å¯¹è±¡è¯†åˆ«ï¼ˆæœ¬åœ°RESTï¼‰</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />PDFè½¬æ¢æ–‡æœ¬</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />ç½‘é¡µæˆªå›¾ï¼ˆæœ¬åœ°RESTï¼‰</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />æœç´¢æ–‡æœ¬/æ–‡ä»¶</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />txtæ–‡æœ¬</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />æ–‡æœ¬åˆ°å‘é‡ï¼ˆæœ¬åœ°RESTï¼‰</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />å¾…åŠäº‹é¡¹</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />URLä¿å­˜åˆ°PDF</li>
</ul>

<h3 id="ç¬¬ä¸€æ¬¡ç­”è¾©">ç¬¬ä¸€æ¬¡ç­”è¾©</h3>

<h4 id="è§†é¢‘">è§†é¢‘</h4>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://www.youtube.com/embed/Z2VGME2K1Oo" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h4 id="ç­”è¾©ppt">ç­”è¾©PPT</h4>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="/assets/js/viewer-js/#/assets/2022/01-begin-intern-juzibot-report/01.pdf" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="é¡¹ç›®é“¾æ¥">é¡¹ç›®é“¾æ¥</h3>

<ul>
  <li>
    <p>é¡¹ç›®é“¾æ¥ï¼š<a href="https://github.com/tianrking/xiaojuzi">https://github.com/tianrking/xiaojuzi</a></p>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>è”ç³»æ–¹å¼ï¼šTelegram: @qozob</td>
          <td>Email: me@w0x7ce.eu</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<blockquote>
  <p>Author: <a href="https://github.com/tianrking">@tianrking</a>
Code: <a href="https://github.com/tianrking/xiaojuzi">@tianrking/juzibot</a></p>
</blockquote>]]></content><author><name>tianrking</name></author><category term="article" /><category term="juzibot" /><summary type="html"><![CDATA[2022å¯’å‡-ç‹å¤©ç¿-JuziBoté¡¹ç›®å¼€å‘-æœŸä¸­æŠ¥å‘Š-æ™ºèƒ½ä¿¡æ¯åŠ©ç†]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/01-begin-intern-juzibot-report/cover.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/01-begin-intern-juzibot-report/cover.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">2022-åŸºäº5Gå¹³å°å¼€å‘puppetæ¨¡å—æ¥å…¥wechaty</title><link href="https://wechaty.js.org/2022/01/18/monthly-wechaty-puppet-walnut-report/" rel="alternate" type="text/html" title="2022-åŸºäº5Gå¹³å°å¼€å‘puppetæ¨¡å—æ¥å…¥wechaty" /><published>2022-01-18T00:00:00+00:00</published><updated>2022-01-18T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/01/18/monthly-wechaty-puppet-walnut-report</id><content type="html" xml:base="https://wechaty.js.org/2022/01/18/monthly-wechaty-puppet-walnut-report/"><![CDATA[<h2 id="åŸºäº-5g-å¹³å°å¼€å‘-puppet-æ¨¡å—æ¥å…¥-wechaty">åŸºäº 5G å¹³å°å¼€å‘ puppet æ¨¡å—æ¥å…¥ wechaty</h2>

<ul>
  <li>é¡¹ç›®åç§°ï¼šåŸºäº5Gæ¶ˆæ¯çš„ Wechaty Puppet æ¨¡å—çš„è®¾è®¡ä¸å®ç°</li>
  <li>å­¦ç”Ÿï¼šé²è€€é¾™</li>
  <li>å¯¼å¸ˆï¼šè‹ç•…</li>
  <li>é¡¹ç›®ä»‹ç»ï¼š<a href="https://github.com/juzibot/intern/issues/1">https://github.com/juzibot/intern/issues/1</a></li>
  <li>ä»£ç åœ°å€ï¼š<a href="https://github.com/wechaty/puppet-walnut">https://github.com/wechaty/puppet-walnut</a></li>
</ul>

<h3 id="èƒŒæ™¯ä»‹ç»">èƒŒæ™¯ä»‹ç»</h3>

<ul>
  <li>Wechaty ç¤¾åŒºç›®å‰å·²ç»æ”¯æŒå¾®ä¿¡ã€Whatsappã€ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦ç­‰å¸¸è§æµè¡Œå³æ—¶é€šè®¯å·¥å…·ï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡å¤šè¯­è¨€ SDK ï¼ˆæ¯”å¦‚ Python Wechatyï¼‰ è¿›è¡Œè°ƒç”¨ã€‚</li>
  <li><a href="https://wechaty.js.org/2021/03/27/rcs-messaging-chatbot/">5G Chatbot (RCS)</a> æ˜¯è¿‘æœŸä¸­å›½ç”µä¿¡è¿è¥å•†åŸºäº 5G çš„æ¶ˆæ¯æˆ˜ç•¥è½åœ°å¹³å°ï¼Œæœªæ¥çš„ 5G æ‰‹æœºå°†ä¼šå†…ç½® RCS æ¶ˆæ¯çš„å¤„ç†èƒ½åŠ›ã€‚</li>
  <li><a href="https://www.5g-msg.com/#/">ç¡¬æ ¸æ¡ƒç¤¾åŒº</a> çš„ <a href="https://wechaty.js.org/2021/03/27/rcs-messaging-chatbot/">ç”µä¿¡è¿è¥å•†å•†5G Chatbot</a> å¹³å°ã€‚</li>
</ul>

<h3 id="ç›®æ ‡è®¡åˆ’">ç›®æ ‡è®¡åˆ’</h3>

<ul>
  <li>åŸºäº 5G å¹³å°çš„å¼€æ”¾ api è¿›è¡Œå°è£…ï¼Œå®ç°ç®€å•çš„<code class="language-plaintext highlighter-rouge">ding-dong-bot</code>ã€‚</li>
  <li>ä¸°å¯Œ 5G çš„æ¶ˆæ¯æ¨¡å¼ï¼Œå®ç°æ”¯æŒå¯Œæ–‡æœ¬ã€æ–‡ä»¶ã€cssç­‰å¤šæ ·æ¶ˆæ¯æ ¼å¼çš„ puppetã€‚</li>
</ul>

<h3 id="é¡¹ç›®è¿›å±•">é¡¹ç›®è¿›å±•</h3>

<ul>
  <li>å®Œå–„ walnut ä»“åº“çš„ README å’Œ getting-startedã€‚</li>
  <li>å®Œå–„å¯¹äº wechaty contact å’Œ message éƒ¨åˆ† api çš„æ”¯æŒã€‚</li>
</ul>

<h3 id="contact-api-æ”¯æŒ">Contact Api æ”¯æŒ</h3>

<ul>
  <li>
    <h4 id="properties"><a href="https://wechaty.js.org/docs/api/contact#properties">Properties</a></h4>

    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Support</th>
          <th>Details</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
          <td><code class="language-plaintext highlighter-rouge">string</code></td>
          <td>Get Contact id. This function is depending on the Puppet Implementation, see <a href="https://github.com/wechaty/wechaty/wiki/Puppet#3-puppet-compatible-table">puppet-compatible-table</a></td>
          <td>âœ…</td>
          <td>Phone number</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <h4 id="instance-methods"><a href="https://wechaty.js.org/docs/api/contact#instance-methods">Instance Methods</a></h4>

    <table>
      <thead>
        <tr>
          <th>Instance Methods</th>
          <th>Return type</th>
          <th>Support</th>
          <th>Details</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>say(text Or Contact Or File)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>âš Contact not Support</td>
        </tr>
        <tr>
          <td>name()</td>
          <td><code class="language-plaintext highlighter-rouge">String</code></td>
          <td>âœ…</td>
          <td>Phone number</td>
        </tr>
        <tr>
          <td>alias(newAlias)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>friend()</td>
          <td><code class="language-plaintext highlighter-rouge">Boolean or null</code></td>
          <td>âœ…</td>
          <td>True</td>
        </tr>
        <tr>
          <td>type()</td>
          <td><code class="language-plaintext highlighter-rouge">ContactType.Unknown or ContactType.Personal or ContactType.Official</code></td>
          <td>âœ…</td>
          <td>ContactType.Personal</td>
        </tr>
        <tr>
          <td>gender()</td>
          <td><code class="language-plaintext highlighter-rouge">ContactGender.Unknown or ContactGender.Male or ContactGender.Female</code></td>
          <td>âœ…</td>
          <td>ContactGender.Unknown</td>
        </tr>
        <tr>
          <td>province()</td>
          <td><code class="language-plaintext highlighter-rouge">String or null</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>city()</td>
          <td><code class="language-plaintext highlighter-rouge">String or null</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>avatar()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Default avatar</td>
        </tr>
        <tr>
          <td>sync()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>self()</td>
          <td><code class="language-plaintext highlighter-rouge">Boolean</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
      </tbody>
    </table>

    <blockquote>
      <p>Default avatar ğŸ‘‰ <a href="https://raw.githubusercontent.com/wechaty/puppet-walnut/main/docs/images/avatar.webp">https://raw.githubusercontent.com/wechaty/puppet-walnut/main/docs/images/avatar.webp</a></p>
    </blockquote>
  </li>
  <li>
    <h4 id="static-methods"><a href="https://wechaty.js.org/docs/api/contact#static-methods">Static Methods</a></h4>

    <table>
      <thead>
        <tr>
          <th>Static Methods</th>
          <th>Return Type</th>
          <th>Support</th>
          <th>Detail</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>find(query)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise &lt;Contact | null&gt;</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>findAll(Query Arguements)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise &lt;Contact []&gt;</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h3 id="message-api-æ”¯æŒ">Message Api æ”¯æŒ</h3>

<ul>
  <li>
    <h4 id="instance-methods-1"><a href="https://wechaty.js.org/docs/api/message#instance-methods">Instance Methods</a></h4>

    <table>
      <thead>
        <tr>
          <th>Instance methods</th>
          <th>Return type</th>
          <th>Support</th>
          <th>Detail</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>from()</td>
          <td><code class="language-plaintext highlighter-rouge">Contact</code> or <code class="language-plaintext highlighter-rouge">null</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>to()</td>
          <td><code class="language-plaintext highlighter-rouge">Contact</code> or <code class="language-plaintext highlighter-rouge">null</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>room()</td>
          <td><code class="language-plaintext highlighter-rouge">Room</code> or <code class="language-plaintext highlighter-rouge">null</code></td>
          <td>âœ…</td>
          <td>null</td>
        </tr>
        <tr>
          <td>text()</td>
          <td><code class="language-plaintext highlighter-rouge">string</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>say(text Or Contact Or File)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>âš Contact not Support</td>
        </tr>
        <tr>
          <td>type()</td>
          <td><code class="language-plaintext highlighter-rouge">MessageType</code></td>
          <td>âœ…</td>
          <td>Message.Text</td>
        </tr>
        <tr>
          <td>self()</td>
          <td><code class="language-plaintext highlighter-rouge">boolean</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>mention()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>mentionSelf()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>forward(to)</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>date()</td>
          <td><code class="language-plaintext highlighter-rouge">Date</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>age()</td>
          <td><code class="language-plaintext highlighter-rouge">Number</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>toFileBox()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>toContact()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âŒ</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>toUrlLink()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <h4 id="static-method"><a href="https://wechaty.js.org/docs/api/message#static-method">Static Method</a></h4>

    <table>
      <thead>
        <tr>
          <th>Static Methods</th>
          <th>Return type</th>
          <th>Support</th>
          <th>Detail</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>find()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
        <tr>
          <td>findAll()</td>
          <td><code class="language-plaintext highlighter-rouge">Promise</code></td>
          <td>âœ…</td>
          <td>Â </td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h3 id="è§†é¢‘å±•ç¤º">è§†é¢‘å±•ç¤º</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://www.youtube.com/embed/K5CIaL6x83k" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="ç­”è¾©æŠ¥å‘Š">ç­”è¾©æŠ¥å‘Š</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="/assets/2022/01-monthly-wechaty-puppet-walnut-report/monthly-wechaty-puppet-walnut-report" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="è®¡åˆ’å®‰æ’">è®¡åˆ’å®‰æ’</h3>

<ul>
  <li>å®Œæˆå›¾ç‰‡å’Œåœ°ç†ä½ç½®å¡ç‰‡æ¶ˆæ¯çš„å®ç°ã€‚</li>
  <li>å°è£…å’ŒæŠ½è±¡æ¶ˆæ¯æ¨¡å—çš„æ•°æ®ç»“æ„ã€‚</li>
  <li>ä¼˜åŒ–é¡¹ç›®ç»“æ„ï¼Œè¿›è¡Œé¡¹ç›®éƒ¨ç½²å’Œç¨³å®šæ€§æµ‹è¯•ã€‚</li>
</ul>

<blockquote>
  <p>Author: <a href="https://github.com/fabian4">@fabian</a></p>
</blockquote>]]></content><author><name>fabian</name></author><category term="project" /><category term="5g" /><category term="puppet-walnut" /><category term="chatbot" /><category term="ecosystem" /><category term="plan" /><summary type="html"><![CDATA[åŸºäº 5G å¹³å°å¼€å‘ puppet æ¨¡å—æ¥å…¥ wechaty]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/01-monthly-wechaty-puppet-walnut-report/puppet-walnut.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/01-monthly-wechaty-puppet-walnut-report/puppet-walnut.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">åŸºäºWechatyçš„ä¸ªäººåŠ©ç†ï¼Œ++ç”Ÿæ´»æ•ˆç‡&amp;amp;&amp;amp;æœ‰æ•ˆå¯¹æŠ—å†…å·</title><link href="https://wechaty.js.org/2022/01/16/wechaty-assistant-bot-opensource/" rel="alternate" type="text/html" title="åŸºäºWechatyçš„ä¸ªäººåŠ©ç†ï¼Œ++ç”Ÿæ´»æ•ˆç‡&amp;amp;&amp;amp;æœ‰æ•ˆå¯¹æŠ—å†…å·" /><published>2022-01-16T00:00:00+00:00</published><updated>2022-01-16T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/01/16/wechaty-assistant-bot-opensource</id><content type="html" xml:base="https://wechaty.js.org/2022/01/16/wechaty-assistant-bot-opensource/"><![CDATA[<h2 id="é¡¹ç›®åœ°å€">é¡¹ç›®åœ°å€</h2>

<p><a href="https://github.com/yzh1255245824/wechat-bot-padlocal">wechaty-assistant</a></p>

<h2 id="ä¸€å‰è¨€">ä¸€ã€å‰è¨€</h2>

<p>ç”±äºå¸¸å¹´ç©¿æ¢­äºè¯¸å¤šå°ä¼—ç½‘ç›˜çš„qqç¾¤ï¼Œæˆ‘æ¥è§¦åˆ°äº†ç¤¾äº¤è½¯ä»¶æœºå™¨äººè¿™ä¸ªæ¦‚å¿µã€‚åˆæ¬¡æ¥è§¦ï¼Œä¾¿è§‰å¾—ç”šæ˜¯æœ‰è¶£ï¼Œå› è€Œåœ¨ä¸€ç•ªæ£€ç´¢ä¹‹åï¼Œå¯»è®¿åˆ°äº†<code class="language-plaintext highlighter-rouge">wechaty</code>è¿™ä¸€å®åœ°ã€‚</p>

<p>èµ·åˆåªæ˜¯æƒ³åšä¸€ä¸ªåœ¨å¾®ä¿¡ç¾¤å†…å’Œç¾¤å‹èŠå¤©æ°´ç¾¤çš„æœºå™¨äººï¼Œåæ¥å‘ç°ä¸€äº›åœ¨é…·å®‰ä¸Šè´¹å°½å¿ƒæœºæ‰¾åˆ°çš„å®è—è½¯ä»¶çš„éƒ¨åˆ†åŠŸèƒ½ï¼Œå¯ä»¥ç®€åŒ–ç§»æ¤åˆ°å¾®ä¿¡ä¸Šï¼Œä¾‹å¦‚<code class="language-plaintext highlighter-rouge">å¯†ç é”®ç›˜</code>è¿™ä¸€åŠŸèƒ½ã€‚è¿˜æœ‰<code class="language-plaintext highlighter-rouge">å®šæ—¶æ¶ˆæ¯</code>è¿™ç§ç”¨å¤„é¢‡å¤§çš„åŠŸèƒ½ï¼Œæ­¤å‰åªèƒ½æå‰ç¼–è¾‘å¥½æ¶ˆæ¯ï¼Œç„¶åæŒ‘ç¯å¤œæˆ˜ã€æ•æˆˆå¾…æ—¦ï¼Œæ—¶æœºä¸€åˆ°å°±æ‰‹åŠ¨ç‚¹å‡»å‘é€ï¼Œè€Œç°åœ¨å€ŸåŠ©<code class="language-plaintext highlighter-rouge">wechaty</code>ï¼Œå¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒè¿‡å¹´çš„æ—¶å€™12:00è¦å‘é€çš„æ‹œå¹´è¯·æ±‚è¿‡å¤šã€åŒåä¸€ä¹Ÿä¸å¿…å†çº ç»“æ˜¯å…ˆç»™å¥³å‹å‘é€æ‹çˆ±çºªå¿µæ—¥å¿«ä¹è¿˜æ˜¯å…ˆå»äº¬ä¸œä¸‹å•(å¤ªæ£’äº†ï¼ï¼)ã€‚</p>

<p>æœ¬é¡¹ç›®å€ŸåŠ©<code class="language-plaintext highlighter-rouge">padlocal</code>ä½œä¸ºpuppet-providerï¼Œé›†æˆäº†ä¸ªäººå¸¸ç”¨çš„APIæœåŠ¡å•†æ¥å£ï¼ŒåŒæ—¶æ¥å…¥äº†<code class="language-plaintext highlighter-rouge">å¾®ä¿¡å¯¹è¯å¼€æ”¾å¹³å°</code>ï¼Œä½ å¯ä»¥åˆ©ç”¨å†…åµŒçš„å°åŠŸèƒ½æ›¿ä»£å¹³æ—¶åœ¨ç½‘é¡µä¸­ä½¿ç”¨çš„åœ¨çº¿å°å·¥å…·ï¼Œä¹Ÿå¯ä»¥åœ¨å‡Œæ™¨å››ç‚¹ç»™å·ç‹ä»¬å‘é€â€œæˆ‘è¿˜åœ¨å­¦â€ï¼Œè¯¸å¤šåŠŸèƒ½å¯ç‚¹å‡»é¡¹ç›®åœ°å€ä¸‹æ–¹é“¾æ¥ä½“éªŒã€‚</p>

<p>å†æ¬¡ç‰¹åˆ«è‡´è°¢<code class="language-plaintext highlighter-rouge">wechaty</code>ç¤¾åŒºä¸€ä¼—å¼€å‘è€…ä»¬çš„è¾›å‹¤ä»˜å‡ºï¼Œæ„Ÿè°¢ä½ ä»¬çš„åˆ›é€ ã€‚</p>

<h2 id="äºŒä¸»è¦åŠŸèƒ½">äºŒã€ä¸»è¦åŠŸèƒ½</h2>

<h3 id="21-ç§èŠæ¶ˆæ¯å¤„ç†å…³é”®è¯å›å¤åŒ…æ‹¬">2.1 ç§èŠæ¶ˆæ¯å¤„ç†ï¼šå…³é”®è¯å›å¤ï¼ŒåŒ…æ‹¬</h3>

<p><img src="/assets/2022/01-wechaty-assistant-bot-opensource/menu.webp" alt="people-message" /></p>

<p>åœ¨çº¿å®æ—¶æ•°æ®è·å–æœåŠ¡ç”±APIæœåŠ¡å•†æä¾›</p>

<p>æ¯’é¸¡æ±¤
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/poisonsoup.webp" alt="IMG_20220115_210015.jpg" /></p>

<p>ç¥å›å¤
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/godreply.webp" alt="image.png" /></p>

<p>æ¯æ—¥è‹±è¯­
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/oneen.webp" alt="IMG_20220115_205958.jpg" /></p>

<p>å…¨ç½‘çƒ­ç‚¹
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/networkhots.webp" alt="image.png" /></p>

<p>åŸå¸‚å¤©æ°”
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/weather.webp" alt="IMG_20220115_210107.jpg" /></p>

<p>å®¢æœ
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/customerservice.webp" alt="image.png" /></p>

<p>æ–‡æœ¬å¤„ç†åŠŸèƒ½ç”±æœ¬åœ°ç¼–å†™ç®—æ³•å¤„ç†</p>

<p>è‹±æ–‡å­—ç¬¦ä¸²è½¬å¤§/å°å†™
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/toupper.webp" alt="image.png" /></p>

<p>rgb<code class="language-plaintext highlighter-rouge">&lt;=&gt;</code>hex
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/rgbtohex.webp" alt="image.png" /></p>

<h3 id="22-ç¾¤ç®¡ç†">2.2 ç¾¤ç®¡ç†</h3>

<p>é€šè¿‡ç§èŠçš„å¿«æ·æŒ‡ä»¤è‡ªåŠ¨æ‹‰äººå…¥ç¾¤
<code class="language-plaintext highlighter-rouge">è¸¢@ç”¨æˆ·å</code>å¿«æ·æŒ‡ä»¤è¸¢äºº</p>

<p><img src="/assets/2022/01-wechaty-assistant-bot-opensource/kicksb.webp" alt="image.png" /></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="cm">/* ç‰¹æƒæ¶ˆæ¯ */</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">sender</span> <span class="o">===</span> <span class="nx">config</span><span class="p">.</span><span class="nx">MYSELF</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// è¸¢äººåŠŸèƒ½  ç¾¤é‡Œå‘é€  è¸¢@æŸæŸæŸ  å³å¯</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">"</span><span class="s2">è¸¢@</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">//å¦‚æœæ˜¯æœºå™¨äººå¥½å‹ä¸”æ˜µç§°æ˜¯è‡ªå·±çš„å¤§å·æ˜µç§°  æ‰æ‰§è¡Œè¸¢äººæ“ä½œ</span>
        <span class="c1">// edit at 0109ï¼šå¤‡æ³¨å¦‚æœæ— æ³•è·å–ï¼Œç­‰ä¸€æ®µæ—¶é—´æ•°æ®åˆ·æ–°å³å¯ã€‚è¸¢äººè¦ç®¡ç†å‘˜æƒé™</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">contact</span><span class="p">.</span><span class="nx">friend</span><span class="p">())</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">delName</span> <span class="o">=</span> <span class="nx">content</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">è¸¢@</span><span class="dl">"</span><span class="p">,</span> <span class="dl">""</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">è¸¢å‡º</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">delName</span><span class="p">);</span> <span class="c1">// debug</span>
          <span class="kd">const</span> <span class="nx">delContact</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">room</span><span class="p">.</span><span class="nx">member</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="nx">delName</span> <span class="p">});</span>
          <span class="k">await</span> <span class="nx">room</span><span class="p">.</span><span class="nx">del</span><span class="p">(</span><span class="nx">delContact</span><span class="p">);</span>
          <span class="k">await</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="nx">delName</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">å·²è¢«ç§»é™¤ç¾¤èŠã€‚ä¸”èŠä¸”çæƒœå•Šï¼</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>æ£€æµ‹ç¾¤å†…éæ³•<code class="language-plaintext highlighter-rouge">url</code>å¹¶<code class="language-plaintext highlighter-rouge">@</code>æé†’å¯¹æ–¹</p>

<p><img src="/assets/2022/01-wechaty-assistant-bot-opensource/listenurl.webp" alt="image.png" /></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">urlReg</span> <span class="o">=</span>
  <span class="sr">/</span><span class="se">(</span><span class="sr">http</span><span class="se">(</span><span class="sr">s</span><span class="se">)?</span><span class="sr">:</span><span class="se">\/\/)?[</span><span class="sr">a-zA-Z0-9</span><span class="se">][</span><span class="sr">-a-zA-Z0-9</span><span class="se">]{0,62}(\.[</span><span class="sr">a-zA-Z0-9</span><span class="se">][</span><span class="sr">-a-zA-Z0-9</span><span class="se">]{0,62})</span><span class="sr">+</span><span class="se">(</span><span class="sr">:</span><span class="se">[</span><span class="sr">0-9</span><span class="se">]{1,5})?[</span><span class="sr">-a-zA-Z0-9()@:%_</span><span class="se">\\\+\.</span><span class="sr">~#?&amp;</span><span class="se">//</span><span class="sr">=</span><span class="se">]</span><span class="sr">*$/g</span><span class="p">;</span>  <span class="c1">// åŒ¹é…urlçš„æ­£åˆ™è¡¨è¾¾å¼(å®é™…æƒ…å†µä¸‹ï¼Œurlå‘é€è€…å¤šæ•°ä¸ä¼šæ·»åŠ http(s)å¤´)</span>

    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">urlReg</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">text</span><span class="p">()))</span> <span class="p">{</span>
      <span class="nx">urlReg</span><span class="p">.</span><span class="nx">lastIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// ç´¢å¼•é‡ç½®</span>

      <span class="kd">const</span> <span class="nx">testUrl</span> <span class="o">=</span> <span class="nx">urlReg</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">text</span><span class="p">());</span>

      <span class="kd">const</span> <span class="nx">valid</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">superagent</span><span class="p">.</span><span class="nx">checkUrl</span><span class="p">(</span><span class="nx">testUrl</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">valid</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">room</span> <span class="o">=</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">room</span><span class="p">();</span>
        <span class="c1">// const master = await room.member(config.BOTNAME);</span>
        <span class="k">await</span> <span class="nx">room</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span>
          <span class="s2">`@</span><span class="p">${</span><span class="nx">msg</span>
            <span class="p">.</span><span class="k">from</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">name</span><span class="p">()}</span><span class="s2"> ä¸ºäº†ç¾¤ä¸»ä¸ä¼—ç®¡ç†å‘˜çš„æ³•å¾‹å®‰å…¨ï¼Œæœ¬ç¾¤ç¦æ­¢å‘é€ä¸æ˜é“¾æ¥!!!`</span>
        <span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">é“¾æ¥ä¸åˆæ³•</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// debug</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<h3 id="23-è‡ªåŠ¨å¤„ç†å¥½å‹è¯·æ±‚">2.3 è‡ªåŠ¨å¤„ç†å¥½å‹è¯·æ±‚</h3>

<ul>
  <li>è‡ªåŠ¨é€šè¿‡å¥½å‹è¯·æ±‚</li>
  <li>å¯é™åˆ¶é€šè¿‡å¡«å†™æŒ‡å®šéªŒè¯æ¶ˆæ¯çš„å¥½å‹ï¼Œé¿å…é™Œç”Ÿäººæ·»åŠ å¥½å‹</li>
</ul>

<h3 id="24-æ™ºèƒ½å¯¹è¯æ¥å…¥å¾®ä¿¡å¯¹è¯å¼€æ”¾å¹³å°">2.4 æ™ºèƒ½å¯¹è¯ï¼ˆæ¥å…¥å¾®ä¿¡å¯¹è¯å¼€æ”¾å¹³å°ï¼‰</h3>

<p>æœªè¢«å…³é”®è¯æ•è·çš„æ¶ˆæ¯å°†ç”±<strong>è®­ç»ƒå¥½çš„AI</strong>æ™ºèƒ½å›å¤</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WXAI_TOKEN</span><span class="p">:</span> <span class="dl">"</span><span class="s2">your token</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// å¾®ä¿¡å¯¹è¯å¼€æ”¾å¹³å°token</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">WXAI</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://openai.weixin.qq.com/openapi/</span><span class="dl">"</span><span class="p">;</span>  <span class="c1">// å¾®ä¿¡å¯¹è¯å¼€æ”¾å¹³å°</span>

<span class="cm">/**
 * @function è·å–APIç­¾åï¼Œ2å°æ—¶è¿‡æœŸ
 * @returns ç­¾å
 * @tips æ”¹ä¸ºè½®è¯¢
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">getSignature</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span><span class="nx">signature</span><span class="p">}</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">WXAI</span><span class="p">}</span><span class="s2">sign/</span><span class="p">${</span><span class="nx">WXAI_TOKEN</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">userid</span><span class="p">:</span> <span class="dl">'</span><span class="s1">anything</span><span class="dl">'</span> <span class="c1">// è¿™é‡Œå¯ä»¥æ˜¯ä»»æ„å€¼</span>
  <span class="p">})).</span><span class="nx">data</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">signature</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**
 * @function è°ƒç”¨AIæ¥å£ï¼Œè·å–ç­”æ¡ˆ
 * @param {ç­¾å} signature
 * @param {ç”¨æˆ·id} userid 
 * @param {æ¥æ”¶åˆ°çš„æ–‡æœ¬} text 
 * @returns AIç»™å‡ºçš„ç­”æ¡ˆ
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">getAnswer</span><span class="p">(</span><span class="nx">signature</span><span class="p">,</span> <span class="nx">userid</span><span class="p">,</span> <span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span><span class="nx">answer</span><span class="p">}</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">WXAI</span><span class="p">}</span><span class="s2">aibot/</span><span class="p">${</span><span class="nx">WXAI_TOKEN</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">signature</span><span class="p">:</span> <span class="nx">signature</span><span class="p">,</span>
      <span class="na">userid</span><span class="p">:</span> <span class="nx">userid</span><span class="p">,</span>
      <span class="na">query</span><span class="p">:</span> <span class="nx">text</span><span class="p">,</span>
  <span class="p">})).</span><span class="nx">data</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">answer</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å¾®ä¿¡å¯¹è¯å¼€æ”¾å¹³å°è¯¦ç»†é…ç½®å¯å»<code class="language-plaintext highlighter-rouge">å››</code>ä¸­é“¾æ¥å‡ºæŸ¥é˜…</p>

<h3 id="25-è®¾ç½®å®šæ—¶ä»»åŠ¡å¯å¾ªç¯å¯å•æ¬¡">2.5 è®¾ç½®å®šæ—¶ä»»åŠ¡(å¯å¾ªç¯ã€å¯å•æ¬¡ï¼‰</h3>

<p>å®šæ—¶å‘é€ç¾¤æ¶ˆæ¯ï¼Œç™»å½•æ—¶ä»»åŠ¡å¼€å§‹æ‰§è¡Œ</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="cm">/**
    * @func 8ç‚¹åŠå®šæ—¶ç»™æŒ‡å®šç¾¤å‘é€æ¶ˆæ¯
    */</span>
   <span class="k">async</span> <span class="kd">function</span> <span class="nx">rolling</span><span class="p">()</span> <span class="p">{</span>
     <span class="nx">schedule</span><span class="p">.</span><span class="nx">setSchedule</span><span class="p">(</span> <span class="c1">// node-scheduleä½¿ç”¨æ–¹æ³•å¯è§å®˜æ–¹æ–‡æ¡£,æ­¤å¤„è¯­æ³•ä¸å”¯ä¸€</span>
       <span class="p">{</span>
         <span class="na">hour</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
         <span class="na">minute</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
       <span class="p">},</span>
   
       <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
         <span class="kd">const</span> <span class="nx">room</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">bot</span><span class="p">.</span><span class="nx">Room</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
           <span class="na">topic</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">WEBROOM</span><span class="p">,</span>
         <span class="p">});</span>
         <span class="kd">const</span> <span class="nx">today</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">format</span><span class="p">(</span><span class="dl">"</span><span class="s2">MMæœˆDDæ—¥</span><span class="dl">"</span><span class="p">);</span>
         <span class="kd">let</span> <span class="nx">poison</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">superagent</span><span class="p">.</span><span class="nx">getSoup</span><span class="p">();</span> <span class="c1">//æ¯’é¸¡æ±¤</span>
         <span class="kd">const</span> <span class="nx">str</span> <span class="o">=</span> <span class="s2">`ä»Šå¤©æ˜¯</span><span class="p">${</span><span class="nx">today</span><span class="p">}</span><span class="s2">,ä½ å­¦åºŸäº†å—?</span><span class="p">${</span><span class="nx">poison</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
         <span class="k">await</span> <span class="nx">room</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
       <span class="p">}</span>
     <span class="p">);</span>
   <span class="p">}</span>
</code></pre></div></div>

<p>å®šæ—¶ç»™ä¸ªäººå‘é€æ¶ˆæ¯</p>

<p><img src="/assets/2022/01-wechaty-assistant-bot-opensource/schedule.webp" alt="image.png" /></p>

<p><code class="language-plaintext highlighter-rouge">2022å¹´1æœˆ14æ—¥4ç‚¹0åˆ†0ç§’</code>å‘å¤‡æ³¨ä¸º<code class="language-plaintext highlighter-rouge">æ¨Šåº†å…ƒ</code>çš„è”ç³»äººå‘é€<code class="language-plaintext highlighter-rouge">â€œæˆ‘åˆšå­¦å®Œï¼Œæ—©å®‰â€</code>
è®©å·ç‹ä»¬æ„Ÿå—ææƒ§å§ï¼ï¼ï¼</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">if</span> <span class="p">((</span><span class="k">await</span> <span class="nx">contact</span><span class="p">.</span><span class="nx">alias</span><span class="p">())</span> <span class="o">===</span> <span class="nx">config</span><span class="p">.</span><span class="nx">MYSELF</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">"</span><span class="s2">å®šæ—¶</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">å®šæ—¶</span><span class="dl">"</span><span class="p">);</span>
         <span class="kd">const</span> <span class="nx">remain</span> <span class="o">=</span> <span class="nx">content</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">å®šæ—¶</span><span class="dl">"</span><span class="p">,</span> <span class="dl">""</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span> <span class="c1">// åˆ†å‰²æŒ‡ä»¤æ–‡æœ¬</span>
   
         <span class="kd">const</span> <span class="nx">timeAndStr</span> <span class="o">=</span> <span class="nx">remain</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2"> </span><span class="dl">"</span><span class="p">);</span> <span class="c1">// æ—¶é—´å’Œæ¶ˆæ¯å†…å®¹</span>
   
         <span class="kd">const</span> <span class="nx">timeStr</span> <span class="o">=</span> <span class="nx">timeAndStr</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">.</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// ç²¾ç¡®æ—¶é—´</span>
         <span class="kd">const</span> <span class="nx">txt</span> <span class="o">=</span> <span class="nx">timeAndStr</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">// æ¶ˆæ¯æ–‡æœ¬</span>
         <span class="kd">const</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">timeAndStr</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// æ”¶ä¿¡äººå¤‡æ³¨</span>
         <span class="kd">const</span> <span class="nx">date</span> <span class="o">=</span> <span class="nx">schedule</span><span class="p">.</span><span class="nx">scheduleMsg</span><span class="p">(</span><span class="nx">timeStr</span><span class="p">);</span>
   
         <span class="nx">schedule</span><span class="p">.</span><span class="nx">setSchedule</span><span class="p">(</span>
           <span class="nx">date</span><span class="p">,</span>
           <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">txt</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
             <span class="kd">const</span> <span class="nx">contact</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">bot</span><span class="p">.</span><span class="nx">Contact</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">alias</span><span class="p">:</span> <span class="nx">target</span> <span class="p">});</span> <span class="c1">// æ”¶ä¿¡äºº</span>
             <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`å‘</span><span class="p">${</span><span class="nx">contact</span><span class="p">.</span><span class="nx">name</span><span class="p">()}</span><span class="s2">å‘é€'</span><span class="p">${</span><span class="nx">txt</span><span class="p">}</span><span class="s2">'`</span><span class="p">);</span>
             <span class="nx">contact</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="nx">txt</span><span class="p">);</span>
           <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">txt</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="c1">// é€šè¿‡bind()å¯å‘å†…éƒ¨å‡½æ•°æŒ‚è½½å‚æ•°</span>
         <span class="p">);</span>
         <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
       <span class="p">}</span>
   <span class="p">}</span>
</code></pre></div></div>

<h3 id="26-å¯†ç ç°¿">2.6 å¯†ç ç°¿</h3>

<p>è¯¥åŠŸèƒ½å¯ç”¨äºè®°å½•<strong>å¸¸ç”¨çš„å†—é•¿æ–‡æœ¬</strong>ï¼Œä¾‹å¦‚èº«ä»½è¯å·ã€é“¶è¡Œå¡å·ã€è´­ç‰©æ—¶çš„å¥½è¯„æ¨¡æ¿ç­‰ç­‰ã€‚</p>

<p>é€šè¿‡æŒ‡ä»¤<code class="language-plaintext highlighter-rouge">map key value</code>å¯è®°å½•æ ‡ç­¾ä¸º<code class="language-plaintext highlighter-rouge">key</code>ï¼Œå†…å®¹ä¸º<code class="language-plaintext highlighter-rouge">value</code>çš„å¯†ç ï¼ˆåœ¨<code class="language-plaintext highlighter-rouge">password</code>ç›®å½•ä¸‹ç”Ÿæˆæ–‡ä»¶ï¼‰</p>

<p><img src="/assets/2022/01-wechaty-assistant-bot-opensource/map.webp" alt="image.png" /></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">"</span><span class="s2">map</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// map key value</span>
      <span class="kd">let</span> <span class="nx">command</span> <span class="o">=</span> <span class="nx">content</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">map</span><span class="dl">"</span><span class="p">,</span> <span class="dl">""</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span> 
      <span class="nx">command</span> <span class="o">=</span> <span class="nx">command</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">command</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="nx">key</span> <span class="o">=</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">md5</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span> <span class="c1">// æ–‡ä»¶ååŠ å¯†</span>
      <span class="kd">let</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">command</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="nx">value</span> <span class="o">=</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">aes128</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span> <span class="c1">// æ–‡ä»¶åŠ å¯†</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">writefile:  </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">value</span><span class="p">);</span>
      <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/../password</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">),</span> <span class="nx">value</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">writeFileErr: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">err</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>é€šè¿‡æŒ‡ä»¤get keyå¯ä»¥è·å–æ ‡ç­¾ä¸ºkeyçš„å¯†ç </p>

<p><img src="/assets/2022/01-wechaty-assistant-bot-opensource/get.webp" alt="image.png" /></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// get key</span>
      <span class="kd">let</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">content</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="dl">""</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span> 
      <span class="nx">key</span> <span class="o">=</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">md5</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
      <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/../password</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">),</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">readFileErr: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">err</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">detail</span> <span class="o">=</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">unaes128</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">readfile:  </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">detail</span><span class="p">);</span> <span class="c1">// æ–‡ä»¶è§£å¯†</span>
        <span class="nx">msg</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="nx">detail</span><span class="p">);</span>
      <span class="p">})</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>æ–‡ä»¶åŠ å¯†</p>

<p>æ–‡ä»¶åé€šè¿‡<code class="language-plaintext highlighter-rouge">md5</code>ç®—æ³•æ¯”å¯¹</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto</span><span class="dl">"</span><span class="p">);</span>
   
   <span class="cm">/**
    * @func æ–‡ä»¶ååŠ å¯†
    * @param {æ˜æ–‡} str 
    * @returns åŠ å¯†åçš„å­—ç¬¦ä¸²
    */</span>
   <span class="kd">const</span> <span class="nx">md5</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
     <span class="kd">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">"</span><span class="s2">md5</span><span class="dl">"</span><span class="p">);</span>
     <span class="nx">hash</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
     <span class="k">return</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">"</span><span class="s2">hex</span><span class="dl">"</span><span class="p">);</span>
   <span class="p">};</span>
</code></pre></div></div>

<p>æ–‡ä»¶å†…å®¹é€šè¿‡<code class="language-plaintext highlighter-rouge">aes-128-cbc</code>ç®—æ³•åŠ å¯†</p>

<p><img src="/assets/2022/01-wechaty-assistant-bot-opensource/encrypt1.webp" alt="image.png" />
<img src="/assets/2022/01-wechaty-assistant-bot-opensource/encrypt2.webp" alt="image.png" /></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="cm">/**
    * @func aes-128-cbcåŠ å¯†ç®—æ³•å°è£…
    * @param {å¯†é’¥} key 
    * @param {åˆå§‹åŒ–å‘é‡} iv 
    * @param {æ˜æ–‡} data 
    * @returns 
    */</span>
   <span class="kd">function</span> <span class="nx">encrypt</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
     <span class="kd">let</span> <span class="nx">cipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createCipheriv</span><span class="p">(</span><span class="dl">"</span><span class="s2">aes-128-cbc</span><span class="dl">"</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">);</span>
     <span class="k">return</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="dl">"</span><span class="s2">utf8</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">base64</span><span class="dl">"</span><span class="p">)</span> <span class="o">+</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">final</span><span class="p">(</span><span class="dl">"</span><span class="s2">base64</span><span class="dl">"</span><span class="p">);</span>
   <span class="p">}</span>
   
   <span class="cm">/**
    * @func aes-128-cbcè§£å¯†ç®—æ³•å°è£…
    * @param {å¯†é’¥} key 
    * @param {åˆå§‹åŒ–å‘é‡} iv 
    * @param {å¯†æ–‡} data 
    * @returns 
    */</span>
   <span class="kd">function</span> <span class="nx">decrypt</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">,</span> <span class="nx">encrypted</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">,</span> <span class="dl">"</span><span class="s2">base64</span><span class="dl">"</span><span class="p">);</span>
     <span class="kd">let</span> <span class="nx">decipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createDecipheriv</span><span class="p">(</span><span class="dl">"</span><span class="s2">aes-128-cbc</span><span class="dl">"</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">);</span>
     <span class="k">return</span> <span class="nx">decipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">,</span> <span class="dl">"</span><span class="s2">utf8</span><span class="dl">"</span><span class="p">)</span> <span class="o">+</span> <span class="nx">decipher</span><span class="p">.</span><span class="nx">final</span><span class="p">(</span><span class="dl">"</span><span class="s2">utf8</span><span class="dl">"</span><span class="p">);</span>
   <span class="p">}</span>
   
   <span class="cm">/**
    * @func åŠ å¯†æ–‡ä»¶å†…å®¹
    * @param {æ˜æ–‡} data 
    * @returns åŠ å¯†åçš„æ–‡ä»¶å†…å®¹
    */</span> 
   <span class="kd">const</span> <span class="nx">aes128</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">key</span><span class="o">=</span><span class="dl">"</span><span class="s2">123456789abcdefg</span><span class="dl">"</span><span class="p">,</span> <span class="nx">iv</span><span class="o">=</span><span class="dl">"</span><span class="s2">123456789abcdefg</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">return</span> <span class="nx">encrypt</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
   <span class="p">};</span>
   
   <span class="cm">/**
    * @func è§£å¯†æ–‡ä»¶å†…å®¹
    * @param {å¯†é’¥} key 
    * @param {åˆå§‹åŒ–å‘é‡} iv 
    * @param {å¯†æ–‡} data 
    * @returns 
    */</span>
   <span class="kd">const</span> <span class="nx">unaes128</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">key</span><span class="o">=</span><span class="dl">"</span><span class="s2">123456789abcdefg</span><span class="dl">"</span><span class="p">,</span> <span class="nx">iv</span><span class="o">=</span><span class="dl">"</span><span class="s2">123456789abcdefg</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">return</span> <span class="nx">decrypt</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
   <span class="p">};</span>
</code></pre></div></div>

<h2 id="ä¸‰ç›®å½•ç»“æ„">ä¸‰ã€ç›®å½•ç»“æ„</h2>

<p><code class="language-plaintext highlighter-rouge">config</code>æ–‡ä»¶å¤¹å­˜æ”¾å…¬å…±é…ç½®æ–‡ä»¶ä»¥åŠ<code class="language-plaintext highlighter-rouge">superagent</code>è¯·æ±‚ç›¸å…³é…ç½®</p>

<p><code class="language-plaintext highlighter-rouge">imgs</code>å­˜æ”¾ç›¸å…³å›¾ç‰‡</p>

<p><code class="language-plaintext highlighter-rouge">listeners</code>å­˜æ”¾æœºå™¨äººåˆå§‹åŒ–åä¸€ç³»åˆ—äº‹ä»¶å¤„ç†(åˆ†æ¨¡å—)
<code class="language-plaintext highlighter-rouge">on-friendship.js</code>å¤„ç†å¥½å‹è¯·æ±‚
<code class="language-plaintext highlighter-rouge">on-login.js</code>å¤„ç†ç™»å½•
<code class="language-plaintext highlighter-rouge">on-message.js</code>å¤„ç†ç”¨æˆ·æ¶ˆæ¯ã€ç¾¤æ¶ˆæ¯
<code class="language-plaintext highlighter-rouge">on-scan.js</code>å¤„ç†ç™»å½•äºŒç»´ç </p>

<p><code class="language-plaintext highlighter-rouge">schedule</code>å¯¹å®šæ—¶ä»»åŠ¡<code class="language-plaintext highlighter-rouge">node-schedule</code>åº“è¿›è¡Œäº†å°è£…</p>

<p><code class="language-plaintext highlighter-rouge">superagent</code>å­˜æ”¾æ‰€æœ‰çš„æ•°æ®è¯·æ±‚ã€æ¥å£å°è£…éƒ½åœ¨æ­¤</p>

<p><code class="language-plaintext highlighter-rouge">utils</code>å…¬ç”¨æ–¹æ³•çš„å°è£…</p>

<p><code class="language-plaintext highlighter-rouge">app.js</code>å…¥å£æ–‡ä»¶</p>

<h2 id="å››å¦‚ä½•æœ¬åœ°åŒ–">å››ã€å¦‚ä½•æœ¬åœ°åŒ–</h2>

<p>éœ€ä¿®æ”¹<code class="language-plaintext highlighter-rouge">config</code>é…ç½®ï¼Œå°†é‡Œé¢çš„é…ç½®æ”¹ä¸ºè‡ªå·±çš„ã€‚æ‰“å¼€<code class="language-plaintext highlighter-rouge">config/index.js</code>æ–‡ä»¶ï¼Œ æ“ä½œå¦‚ä¸‹ï¼š</p>

<p>å®˜ç½‘æ³¨å†Œè´¦å·</p>

<p>wechaty-puppet-padlocalä¾›åº”å•†ï¼š<a href="http://pad-local.com/">http://pad-local.com/</a>
å¤©è¡Œæ•°æ®å®˜ç½‘ï¼š<a href="https://tianapi.com/">https://www.tianapi.com/</a>
èšåˆæ•°æ®å®˜ç½‘ï¼š<a href="https://www.juhe.cn/">https://www.juhe.cn/</a>
å¾®ä¿¡å¯¹è¯å¼€æ”¾å¹³å°ï¼š<a href="https://openai.weixin.qq.com/">https://openai.weixin.qq.com/</a></p>

<p>æ³¨å†ŒæˆåŠŸåï¼Œç”³è¯·ä»¥ä¸‹æ¥å£</p>

<p>å¤©è¡Œæ•°æ®
<a href="https://www.tianapi.com/apiview/62">æ¯æ—¥è‹±è¯­ä¸€å¥è¯</a>
<a href="https://www.tianapi.com/apiview/39">ç¥å›å¤</a>
<a href="https://www.tianapi.com/apiview/223">å…¨ç½‘çƒ­æœæ¦œ</a></p>

<p>èšåˆæ•°æ®
<a href="https://www.juhe.cn/docs/api/id/73">å¤©æ°”é¢„æŠ¥</a></p>

<p>æ³¨å†Œåè¯·æ‰“å¼€<code class="language-plaintext highlighter-rouge">config/index.js</code>ï¼Œå°†é¡¶éƒ¨<code class="language-plaintext highlighter-rouge">PUPPET_TOKEN</code>ã€<code class="language-plaintext highlighter-rouge">TXAPI_TOKEN</code>ã€<code class="language-plaintext highlighter-rouge">JUHEAPI_TOKEN</code>ã€<code class="language-plaintext highlighter-rouge">WXAI_TOKEN</code>æ”¹ä¸ºè‡ªå·±çš„å³å¯</p>

<p>å…¶ä»–å…è´¹æ¥å£å¯éšæ„ç”³è¯·ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œæ›´æ¢APIæœåŠ¡å•†ã€‚</p>

<h2 id="äº”è¿è¡Œ">äº”ã€è¿è¡Œ</h2>

<p>è®°å¾—å®‰è£…ä¾èµ–</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cnpm <span class="nb">install</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cnpm start
</code></pre></div></div>

<p>ç»ˆç«¯ä¼šå‡ºç°ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç ç™»å½•å³å¯ã€‚</p>

<p>è‹¥äºŒç»´ç æ˜¾ç¤ºçš„å¾ˆè¯¡å¼‚ï¼Œæ— æ³•æ‰«æï¼Œè¯·æ›´æ¢ç»ˆç«¯ï¼ˆå»å¾®è½¯å•†åº—ä¸‹è½½<code class="language-plaintext highlighter-rouge">Windows Terminal</code>ï¼‰ã€‚</p>

<p>æœ‰é—®é¢˜å¯é‚®ç®±å’¨è¯¢ <code class="language-plaintext highlighter-rouge">01@yizhihang.club</code></p>]]></content><author><name>yzh1255245824</name></author><category term="article" /><category term="assistant" /><category term="wechat" /><category term="improve-efficiency" /><category term="against-involution" /><summary type="html"><![CDATA[é¡¹ç›®åœ°å€]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/01-wechaty-assistant-bot-opensource/roll.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/01-wechaty-assistant-bot-opensource/roll.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">å°† wechaty-puppet å‡çº§ä¸º1.0ä»¥ä¸Šç‰ˆæœ¬</title><link href="https://wechaty.js.org/2022/01/11/upgrade-to-wechaty-puppet-1.0/" rel="alternate" type="text/html" title="å°† wechaty-puppet å‡çº§ä¸º1.0ä»¥ä¸Šç‰ˆæœ¬" /><published>2022-01-11T00:00:00+00:00</published><updated>2022-01-11T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/01/11/upgrade-to-wechaty-puppet-1.0</id><content type="html" xml:base="https://wechaty.js.org/2022/01/11/upgrade-to-wechaty-puppet-1.0/"><![CDATA[<h2 id="å°†-wechaty-puppet-å‡çº§ä¸º10ä»¥ä¸Šç‰ˆæœ¬">å°† wechaty-puppet å‡çº§ä¸º1.0ä»¥ä¸Šç‰ˆæœ¬</h2>

<h2 id="å‰è¨€">å‰è¨€</h2>

<p>éšç€ Wechaty 1.0 ç‰ˆæœ¬çš„å‘å¸ƒï¼ŒWechaty çš„å‘å±•æ­£å¼è¿›å…¥æ–°çš„é˜¶æ®µï¼Œä½†è¦å‡çº§æ•´å¥—å·¥å…·åˆ°1.0ç‰ˆæœ¬ä»¥ä¸Šå¹¶ä¸å®¹æ˜“ã€‚è¿™ç¯‡åšå®¢å°†ç®€å•ä»‹ç» wechaty-puppet å‡çº§çš„ä¸»è¦æ³¨æ„äº‹é¡¹ï¼Œå¹¶æä¾›ä¸€ä¸ªç®€å•çš„è¿‡æ¸¡æ–¹æ¡ˆã€‚</p>

<h2 id="æ€»ä½“æ€è·¯">æ€»ä½“æ€è·¯</h2>

<p>Wechaty 1.0é‡‡å–äº†æ¨¡å—åŒ–ã€ç®¡é“åŒ–çš„è®¾è®¡ï¼Œå°†åŸºç¡€åŠŸèƒ½å†™åœ¨éª¨æ¶ï¼ˆskeletonï¼‰ä¸­ï¼Œç„¶åé€šè¿‡mixinæŒ‚åœ¨ç™»å½•ã€æ¶ˆæ¯ã€io ç­‰åŠŸèƒ½ã€‚è¿™æ ·åšçš„ä¸»è¦ç›®çš„æ˜¯é¿å…å›è°ƒè¿‡å¤šï¼Œä»¥åŠæ–¹ä¾¿æµ‹è¯•ã€‚wechaty-puppetä¹Ÿé‡‡ç”¨è¿™ä¸€æ€è·¯é‡æ–°è®¾è®¡ï¼Œä¸åŒçš„å¯¼å‡ºè¢«æ”¾åœ¨ä¸åŒçš„æ¨¡å—ä¸­ï¼Œè€Œä¸æ˜¯ä¸€è‚¡è„‘å¡åœ¨ puppet ä¸­ã€‚åŒæ—¶ï¼Œpuppet å®ç°åº”è¯¥è‡ªå·±å¼•ç”¨éœ€è¦ç‰ˆæœ¬çš„å…¶ä»–åŒ…ä¾‹å¦‚ file-box ç­‰ã€‚è¿™ä¹Ÿæ˜¯é™ä½è€¦åˆåº¦çš„è®¾è®¡ã€‚</p>

<h2 id="æ•°æ®ç±»å‹å¯¼å‡º">æ•°æ®ç±»å‹å¯¼å‡º</h2>

<p>å¦‚ä¸Šä¸€èŠ‚æ‰€è¯´ï¼Œæ•°æ®ç±»å‹ä¸å†èƒ½ç›´æ¥ä» wechaty-puppet ä¸­å¯¼å‡ºï¼Œè€Œæ˜¯éœ€è¦ä»ä¸åŒçš„æ¨¡å—ä¸­å¯¼å‡ºï¼Œå¹¶ä¸”åå­—ä¹Ÿæœ‰æ‰€ä¿®æ”¹ã€‚ä¾‹å¦‚ï¼š</p>

<p>æ—§ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Puppet</span><span class="p">,</span> <span class="nx">ScanStatus</span><span class="p">,</span> <span class="nx">EventMessagePayload</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">wechaty-puppet</span><span class="dl">'</span>

<span class="kd">class</span> <span class="nx">xxxPuppet</span> <span class="k">implements</span> <span class="nx">Puppet</span> <span class="p">{</span>
  <span class="c1">// ...</span>

  <span class="k">async</span> <span class="nx">onScan</span> <span class="p">(</span><span class="nx">status</span><span class="p">:</span> <span class="nx">ScanStatus</span><span class="p">,</span> <span class="nx">qrcode</span><span class="p">?:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    
  <span class="p">}</span>

  <span class="nx">foo</span> <span class="p">(</span><span class="nx">message</span><span class="p">:</span> <span class="nx">EventMessagePayload</span><span class="p">)</span> <span class="p">{</span>

  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>åº”è¯¥æ”¹ä¸ºï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">payloads</span><span class="p">,</span> <span class="nx">types</span><span class="p">,</span> <span class="nx">Puppet</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">wechaty-puppet</span><span class="dl">'</span>

<span class="kd">class</span> <span class="nx">xxxPuppet</span> <span class="k">implements</span> <span class="nx">Puppet</span> <span class="p">{</span>
  <span class="c1">// ...</span>
  <span class="k">async</span> <span class="nx">onScan</span> <span class="p">(</span><span class="nx">status</span><span class="p">:</span> <span class="nx">types</span><span class="p">.</span><span class="nx">ScanStatus</span><span class="p">,</span> <span class="nx">qrcode</span><span class="p">?:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>

  <span class="p">}</span>

  <span class="nx">foo</span> <span class="p">(</span><span class="nx">message</span><span class="p">:</span> <span class="nx">payloads</span><span class="p">.</span><span class="nx">EventMessage</span><span class="p">)</span> <span class="p">{</span>

  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="çŠ¶æ€ç®¡ç†">çŠ¶æ€ç®¡ç†</h2>

<p>wechaty-puppet å°†ä¸å†å…è®¸ puppet ä¿®æ”¹çŠ¶æ€ï¼ˆè‡³å°‘æ˜¯ä¸å»ºè®®çš„ï¼‰ã€‚åŒæ—¶ï¼Œ this.state çš„å±æ€§ä¹Ÿæœ‰æ‰€æ”¹å˜ã€‚åº”åˆ©ç”¨ä»¥ä¸‹apiè·å–çŠ¶æ€ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">isLoggedIn</span>
<span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">active</span><span class="p">()</span>
<span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">inactive</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="å¯åŠ¨åœæ­¢">å¯åŠ¨ã€åœæ­¢</h2>

<p>ä»ä»£ç å¤ç”¨çš„è§’åº¦è€ƒè™‘ï¼Œwechaty-puppet å°†æ¥ç®¡ <code class="language-plaintext highlighter-rouge">start</code> å’Œ <code class="language-plaintext highlighter-rouge">stop</code> æ–¹æ³•ï¼Œè€Œ puppet åº”è¯¥åšçš„æ˜¯é‡å†™ <code class="language-plaintext highlighter-rouge">onStart()</code> å’Œ <code class="language-plaintext highlighter-rouge">onStop()</code> ä»¥æ‰§è¡Œå¯åŠ¨åœæ­¢æ‰€éœ€è¦çš„é€»è¾‘ã€‚</p>

<h2 id="å…¶ä»–">å…¶ä»–</h2>

<p>å°½ç®¡åœ¨ wechaty-puppet@1.10 ç‰ˆæœ¬ä¸­ï¼Œhelpers æ¨¡å—ä¾æ—§æä¾›äº† file-box çš„å¯¼å‡ºï¼Œä½†å»ºè®®è‡ªå·±å¦è¡Œå¯¼å…¥ file-box ç­‰å…¶ä»–æ¨¡å—ï¼Œè¿™æ ·å¦‚æœéœ€è¦ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">FileBoxTypes</code> ç±»å‹æšä¸¾ä¹Ÿèƒ½æ–¹ä¾¿ä½¿ç”¨ã€‚
åŒæ—¶å¦‚æœ puppet è¦é…åˆ wechaty-io-client å’Œ puppet-service æ¥æä¾›è¿œç¨‹æœåŠ¡ï¼Œéœ€è¦æ³¨æ„æ–°ç‰ˆæœ¬å¯¹ token çš„ç”Ÿæˆæœ‰ä¸€äº›æ–°çš„è¦æ±‚ã€‚token éœ€è¦ä»¥ä¸€ä¸ª Server Name Indication (SNI) ä½œä¸ºå‰ç¼€ï¼Œä¾‹å¦‚ SNI ä¸º somesni ï¼Œåˆ™tokenåº”ä¸º somesni_xxxx-xxx çš„æ ¼å¼ã€‚åŒæ—¶ï¼Œè¦æœ‰ä¸€ä¸ªç­¾åè®¤è¯çš„ CA ,å¦åˆ™æ— æ³•å»ºç«‹ TLS ã€‚ï¼ˆå¯ä»¥é€šè¿‡å°† insecure ä½œä¸ºå‰ç¼€æ¥ç»•è¿‡è¿™ä¸€æ£€æŸ¥ï¼Œä½†æ­£å¦‚å…¶åï¼Œè¿™æ˜¯ä¸å®‰å…¨çš„ã€‚ï¼‰ã€‚å‚è€ƒ <a href="https://github.com/wechaty/puppet-service/issues/190">TLS &amp; SNI Problem: cannot connect to Puppet Server after Wechaty 1.0 migiration</a></p>

<h2 id="è¿‡æ¸¡æ–¹æ¡ˆ">è¿‡æ¸¡æ–¹æ¡ˆ</h2>

<p><a href="https://github.com/hcfw007/wechaty-puppet-1.0-migration">wechaty-puppet-1.0-migration</a></p>

<p>wechaty-puppet-1.0-migration åŒ…æä¾›äº†ä¸€ä¸ªè¿‡æ¸¡æ–¹æ¡ˆï¼Œä½¿å¾—ä½ å¯ä»¥åƒä»¥å‰ä» wechaty-puppet å¼•ç”¨ä¸€æ ·ä» wechaty-puppet-1.0-migration å¼•ç”¨æ‰€éœ€çš„æ¨¡å—ï¼Œä»¥ç¬¬ä¸€æ®µæ‰€è¯´çš„ä»£ç ä¸ºä¾‹ï¼š</p>

<p>ä» wechaty-puppet-1.0-migration å¯¼å…¥ï¼š</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Puppet</span><span class="p">,</span> <span class="nx">ScanStatus</span><span class="p">,</span> <span class="nx">EventMessagePayload</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">wechaty-puppet-1.0-migration</span><span class="dl">'</span>

<span class="kd">class</span> <span class="nx">xxxPuppet</span> <span class="k">implements</span> <span class="nx">Puppet</span> <span class="p">{</span>
  <span class="c1">// ...</span>

  <span class="k">async</span> <span class="nx">onScan</span> <span class="p">(</span><span class="nx">status</span><span class="p">:</span> <span class="nx">ScanStatus</span><span class="p">,</span> <span class="nx">qrcode</span><span class="p">?:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    
  <span class="p">}</span>

  <span class="nx">foo</span><span class="p">(</span><span class="nx">message</span><span class="p">:</span> <span class="nx">EventMessagePayload</span><span class="p">)</span> <span class="p">{</span>

  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>æ³¨æ„ï¼Œä½ ä»éœ€è‡ªå·±å®‰è£… wechaty-puppet å’Œ file-box ï¼Œè¿™æ ·å°±å¯ä»¥é€‰æ‹©è‡ªå·±æ‰€éœ€çš„ç‰ˆæœ¬ã€‚åŒæ—¶ï¼Œä½ ä»éœ€é‡å†™ Puppet ç±»ä¸­ä¿®æ”¹çš„æ–¹æ³•ï¼Œä¾‹å¦‚ <code class="language-plaintext highlighter-rouge">start()</code> æ”¹ä¸º <code class="language-plaintext highlighter-rouge">onStart()</code>ã€‚è¿™ä¸€é¡¹ç›®çš„ç›®çš„æ˜¯æ˜¯ä½ æ›´å°‘çš„ä¿®æ”¹ä»£ç ä»¥ä½¿ç”¨ wechaty-puppet æ–°ç‰ˆæœ¬çš„æ–°ç‰¹æ€§ï¼Œå»ºè®®ä¸è¦ä½œä¸ºé•¿æœŸè§£å†³æ–¹æ¡ˆï¼Œå¹¶å°½å¿«è¿ç§»åˆ°æ–°ç‰ˆæœ¬ã€‚</p>]]></content><author><name>wang-nan</name></author><category term="article" /><category term="wechaty-puppet" /><category term="wechaty-1.0" /><summary type="html"><![CDATA[å°† wechaty-puppet å‡çº§ä¸º1.0ä»¥ä¸Šç‰ˆæœ¬]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/01-upgrade-to-wechaty-puppet-1.0/cover.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/01-upgrade-to-wechaty-puppet-1.0/cover.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">åŒ—äº¬GDG|ç¤¾åŒºè¯´ï½œNG+|èŠå¤©æœºå™¨äººä¸Angular</title><link href="https://wechaty.js.org/2022/01/06/angular-tensorflow-js/" rel="alternate" type="text/html" title="åŒ—äº¬GDG|ç¤¾åŒºè¯´ï½œNG+|èŠå¤©æœºå™¨äººä¸Angular" /><published>2022-01-06T00:00:00+00:00</published><updated>2022-01-06T00:00:00+00:00</updated><id>https://wechaty.js.org/2022/01/06/angular-tensorflow-js</id><content type="html" xml:base="https://wechaty.js.org/2022/01/06/angular-tensorflow-js/"><![CDATA[<blockquote>
  <p>AI, Wechaty, Angular, and mix them altogether in JavaScript</p>
</blockquote>

<h2 id="èŠå¤©æœºå™¨äººä¸-angular">èŠå¤©æœºå™¨äººä¸ Angular</h2>

<p>äººå·¥æ™ºèƒ½çš„å‘å±•å¸¦åŠ¨äº†å¯¹è¯å¼äº¤äº’é¢†åŸŸç ”ç©¶çš„æ·±å…¥ï¼Œä»¥åŠéšç€ç§»åŠ¨äº’è”ç½‘å³æ—¶é€šè®¯å·¥å…·çš„å¤§ä¼—æ™®åŠï¼ŒChatbot çš„åº”ç”¨åœºæ™¯è¶Šæ¥è¶Šä¸°å¯Œã€‚å¦‚ä½•åŸºäºç°æœ‰çš„äººå·¥æ™ºèƒ½æŠ€æœ¯ï¼Œæ„å»ºä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Ÿ</p>

<p>Chatbot çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå’Œä¼ ç»Ÿçš„ç½‘é¡µå’ŒAPPäº§å“æœ‰é‚£äº›åŒºåˆ«ï¼ŸML GDE Huan å°†åŸºäºè‡ªå·±å¯¹ Chatbot çš„ä¸°å¯Œå®è·µï¼Œåˆ†äº«å’Œå±•æœ›è¿™ç±»æ–°å‹å¯¹è¯å¼äº¤äº’æ–¹å¼åŸºäºäººå·¥æ™ºèƒ½çš„æœªæ¥å‘å±•æœºä¼šã€‚</p>

<p>The development of artificial intelligence has driven the in-depth research in the field of conversational interaction, and with the popularization of mobile Internet instant messaging tools, the application scenarios of Chatbot have become more and more abundant. How to build a chatbot based on existing artificial intelligence technology? What are the differences between the entire life cycle of Chatbot and traditional web and APP products? ML GDE Huan will share his thoughts on the new opportunities that Conversational AI can bring.</p>

<ol>
  <li>Conversational User Interface (CUI) ä»‹ç»</li>
  <li>äººå·¥æ™ºèƒ½å‘å±•å›é¡¾</li>
  <li>Wechaty å¼€æºé¡¹ç›®ä»‹ç»</li>
  <li>TensorFlow.js ä»‹ç»</li>
  <li>Live Demo: åŸºäº Angular é€šè¿‡ TensorFlow.js å¯¹å¾®ä¿¡æ¶ˆæ¯åœ¨æµè§ˆå™¨ä¸­è¿›è¡Œå®æ—¶åˆ†æ</li>
  <li>20:45-21:00 äº’åŠ¨é—®ç­”</li>
</ol>

<h2 id="è®²å¸ˆä»‹ç»">è®²å¸ˆä»‹ç»</h2>

<p>æå“æ¡“ï¼Œè°·æ­Œå¼€å‘è€…ä¸“å®¶ï¼ˆæœºå™¨å­¦ä¹ æ–¹å‘ï¼‰</p>

<ul>
  <li>TensorFlow.js å¸ƒé“å¸ˆï¼ŒAngularçˆ±å¥½è€…</li>
  <li>PreAngel å¤©ä½¿æŠ•èµ„äººï¼Œä¸“æ³¨ AI/Chatbot é¢†åŸŸåˆ›ä¸šå›¢é˜Ÿå’Œé¡¹ç›®</li>
  <li>ã€ŠChatbot ä» 0 åˆ° 1ã€‹ã€Šç®€æ˜çš„ TensorFlow 2ã€‹è”åˆä½œè€…</li>
  <li>GitHub ä¸‡æ˜Ÿå¼€æº Conversational SDK Wechaty ä½œè€…</li>
</ul>

<p>GDE (Machine Learning); Angel Investor</p>

<p>GDE (Machine Learning) and AI MVP. PreAngel Partner, Plug and Play Venture Partner in China. Active Angel Investor for AI Startups, Serial Entrepreneur with Strong Technical Background.</p>

<h2 id="presentation">Presentation</h2>

<h3 id="slides">Slides</h3>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://docs.google.com/presentation/d/1Gd3D8bS6OifXDsdSe0x5i6XsP_uISX3W9tR8yBA0mYs/edit?usp=sharing" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<h3 id="source-code">Source Code</h3>

<p>GitHub: <a href="https://github.com/huan/ng-plus-wechaty">https://github.com/huan/ng-plus-wechaty</a></p>

<h2 id="tutorials">Tutorials</h2>

<h3 id="wechaty-token-apply-a-token-from-wechaty-puppet-service-providers">Wechaty Token: apply a token from Wechaty Puppet Service Providers</h3>

<p>You can apply a Windows / Pad protocol token from our puppet service providers:</p>

<ol>
  <li><a href="https://github.com/wechaty/puppet-supports/issues/new/choose">Apply Wechaty Puppet Service Token</a></li>
  <li><a href="https://wechaty.js.org/docs/puppet-services/faq">Wechaty Puppet Service FAQ</a></li>
</ol>

<h4 id="create-a-wechaty-puppet-service-token-by-yourself-diy">Create a Wechaty Puppet Service Token by yourself (DIY)</h4>

<p>Copy the following shell script and then paste it into the term of your server, to setup your Wechaty token:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># learn how to DIY a Wechaty Puppet Service token at http://wechaty.js.org/docs/puppet-services/diy</span>
<span class="nb">export </span><span class="nv">WECHATY_TOKEN</span><span class="o">=</span>insecure_wechaty_puppet_service_token_diy

<span class="c"># Set port for your hostie service: must be published accessible on the internet</span>
<span class="c"># Wechaty IO Client use this port to publish the Puppet Service</span>
<span class="nb">export </span><span class="nv">WECHATY_PUPPET_SERVER_PORT</span><span class="o">=</span>48788

<span class="c"># learn more about Wechaty Puppet PadLocal at https://wechaty.js.org/docs/puppet-services/padlocal</span>
<span class="nb">export </span><span class="nv">WECHATY_PUPPET</span><span class="o">=</span>wechaty-puppet-padlocal
<span class="c"># get a 7 days free token at PadLocal official website: http://pad-local.com/</span>
<span class="nb">export </span><span class="nv">WECHATY_PUPPET_PADLOCAL_TOKEN</span><span class="o">=</span>YOUR_PADLOCAL_TOKEN_AT_HERE

<span class="nb">export </span><span class="nv">WECHATY_LOG</span><span class="o">=</span>verbose

docker run <span class="se">\</span>
  <span class="nt">--rm</span> <span class="se">\</span>
  <span class="nt">-ti</span> <span class="se">\</span>
  <span class="nt">-e</span> WECHATY_LOG <span class="se">\</span>
  <span class="nt">-e</span> WECHATY_PUPPET <span class="se">\</span>
  <span class="nt">-e</span> WECHATY_PUPPET_PADLOCAL_TOKEN <span class="se">\</span>
  <span class="nt">-e</span> WECHATY_PUPPET_SERVER_PORT <span class="se">\</span>
  <span class="nt">-e</span> WECHATY_TOKEN <span class="se">\</span>
  <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$WECHATY_PUPPET_SERVER_PORT</span><span class="s2">"</span> <span class="se">\</span>
  wechaty/wechaty:0.78
</code></pre></div></div>

<blockquote>
  <p>Learn more: <a href="https://wechaty.js.org/docs/puppet-services/diy/">Puppet Service: DIY</a> This guide will help you generate a Wechaty Token for connecting to the Wechaty Puppet Service.</p>
</blockquote>

<h2 id="live-coding-explanation">Live Coding Explanation</h2>

<p>We have four steps in our live coding, they are saved in four separate branches for easy loading and testing.</p>

<h3 id="step-1-ng-new-my-app">Step 1. <code class="language-plaintext highlighter-rouge">ng new my-app</code></h3>

<p>Branch: <a href="https://github.com/huan/ng2020-wechaty/tree/ng_china_2020_step_1_ng_new_my-app">ng_china_2020_step_1_ng_new_my-app</a></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx <span class="nt">--package</span> @angular/cli ng new my-app
<span class="nb">cd </span>my-app
ng serve <span class="nt">--open</span>
</code></pre></div></div>

<p>Learn more from <a href="https://angular.io/guide/setup-local">https://angular.io/guide/setup-local</a></p>

<h3 id="step-2-wechaty">Step 2. Wechaty</h3>

<p>Branch: <a href="https://github.com/huan/ng2020-wechaty/tree/ng_china_2020_step_2_wechaty">ng_china_2020_step_2_wechaty</a></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm i @chatie/angular brolog
</code></pre></div></div>

<h4 id="appmodulets"><code class="language-plaintext highlighter-rouge">app.module.ts</code></h4>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">WechatyModule</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@chatie/angular</span><span class="dl">'</span>
<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">WechatyModule</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">],</span>
  <span class="p">...</span>
</code></pre></div></div>

<h4 id="appcomponenthtml"><code class="language-plaintext highlighter-rouge">app.component.html</code></h4>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;wechaty</span>
  <span class="na">#wechaty</span>
  <span class="na">token=</span><span class="s">"insecure_wechaty_puppet_service_token_diy"</span>

  <span class="na">(heartbeat) = </span><span class="s">"onHeartbeat($event)"</span>
  <span class="na">(scan)      = </span><span class="s">"onScan($event)"</span>
  <span class="na">(login)     = </span><span class="s">"wechaty.startSyncMessage(); onLogin($event)"</span>
  <span class="na">(message)   = </span><span class="s">"onMessage($event)"</span>
<span class="nt">&gt;</span>
<span class="nt">&lt;/wechaty&gt;</span>
</code></pre></div></div>

<h3 id="step-3-tensorflowjs-toxicity">Step 3. TensorFlow.js Toxicity</h3>

<p>Branch: <a href="https://github.com/huan/ng2020-wechaty/tree/ng_china_2020_step_3_toxicity">ng_china_2020_step_3_toxicity</a></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> @tensorflow/tfjs
npm <span class="nb">install</span> @tensorflow-models/toxicity

ng generate service toxicity
</code></pre></div></div>

<p><a href="https://storage.googleapis.com/tfjs-models/demos/toxicity/index.html"><img src="/assets/2022/01-angular-tensorflow-js/toxicity.webp" alt="TensorFlow.js Toxicity Model" /></a></p>

<p>Learn more:</p>

<ol>
  <li><a href="https://github.com/tensorflow/tfjs-models/tree/master/toxicity">TensorFlow.js models: toxicity classifier source</a></li>
  <li><a href="https://storage.googleapis.com/tfjs-models/demos/toxicity/index.html">TensorFlow.js toxicity classifier demo</a>: This is a demo of the TensorFlow.js toxicity model, which classifies text according to whether it exhibits offensive attributes (i.e. profanity, sexual explicitness).</li>
  <li><a href="https://medium.com/tensorflow/text-classification-using-tensorflow-js-an-example-of-detecting-offensive-language-in-browser-e2b94e3565ce">Text classification using TensorFlow.js: An example of detecting offensive language in browser</a></li>
</ol>

<p>The traffic light code is copy/pasted from this great tutorial: <a href="https://medium.com/@robhitt/stop-in-the-name-of-the-traffic-light-c5f4d8a9d2e6">Stop in the Name of the Traffic Light</a></p>

<h2 id="resources">Resources</h2>

<ol>
  <li><a href="https://www.tensorflow.org/js/tutorials">TensorFlow.js Tutorials</a></li>
  <li><a href="https://www.tensorflow.org/js/models">TensorFlow.js Models</a></li>
  <li><a href="https://www.tensorflow.org/js/demos">TensorFlow.js Demos</a></li>
  <li><a href="https://github.com/tensorflow/tfjs-examples/">TensorFlow.js Examples</a></li>
  <li><a href="https://github.com/tensorflow/tfjs/blob/master/GALLERY.md">TensorFlow.js Gallery</a></li>
</ol>

<h2 id="about-ng">About NG+</h2>

<p>Knowledge, ideas, and insights for the Next Generation.</p>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://www.youtube.com/embed/SACugbTNQnc" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<p><img src="/assets/2022/01-angular-tensorflow-js/huan-ng-2020.webp" alt="NG2020 Conference Huan Wechaty Angular TensorFlow.js" /></p>

<blockquote>
  <p>Source: <a href="https://ng-plus.dev/#/conferences?year=2020">NG+ Developers Conference</a></p>
</blockquote>

<h2 id="å…³äºç¤¾åŒºè¯´">å…³äºç¤¾åŒºè¯´</h2>

<div style="
    position: relative;
    padding-bottom: 56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://www.youtube.com/embed/XGBBx3_pLdg" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<blockquote>
  <p>Bilibili: <a href="https://www.bilibili.com/video/BV1Ha411q7RF">https://www.bilibili.com/video/BV1Ha411q7RF</a></p>
</blockquote>

<p>ã€Œç¤¾åŒºè¯´ã€æ˜¯ç”±è°·æ­Œå¼€å‘è€…ç¤¾åŒº (Google Developer Group)ä¸è°·æ­Œå¼€å‘è€…ä¸“å®¶è®¡åˆ’ (Google Developer Expert) è”åˆæ¨å‡ºçš„ï¼Œä¸çƒ­çˆ±æŠ€æœ¯çš„å¼€å‘è€…ä»¬äº¤æµæŠ€æœ¯ï¼Œç›´æ’­ä»£ç ï¼Œè®¨è®ºäº§å“ï¼Œåˆ†äº«å¿ƒå¾—çš„å°å‹çº¿ä¸Šä¼šè®®ï¼Œæ¯æ¬¡æ—¶é•¿45åˆ†é’Ÿåˆ°1å°æ—¶ã€‚</p>

<p><img src="/assets/2022/01-angular-tensorflow-js/huan-gdg-2021-community-talk.webp" alt="GDG Community Talk Huan Wechaty Angular TensorFlow.js" /></p>

<p>æ´»åŠ¨å°†ç”±ä¸åŒçš„è°·æ­Œå¼€å‘è€…ç¤¾åŒºä¸¾åŠï¼Œå¹¶é‚€è¯·å›½å†…ç›¸å…³æŠ€æœ¯æ–¹å‘çš„è°·æ­Œå¼€å‘è€…ä¸“å®¶ä»¥åŠå¯¹æŠ€æœ¯æœ‰çƒ­æƒ…ã€æ„¿æ„åˆ†äº«çš„å˜‰å®¾ï¼Œä¸€èµ·èŠèŠæœ€è¿‘åšçš„é¡¹ç›®ã€å†™çš„ä»£ç ï¼Œæˆ–è€…ä¸‰äº”æŠ€æœ¯å¥½å‹æ¢è®¨èŠå¤©ã€‚</p>

<blockquote>
  <p>Source: <a href="https://mp.weixin.qq.com/s/cluw2QQepzacuZFA1pJvcw">ç¤¾åŒºè¯´ï½œèŠå¤©æœºå™¨äººä¸ Angular</a></p>
</blockquote>]]></content><author><name>huan</name></author><category term="talk" /><category term="angular" /><category term="tensorflow.js" /><category term="gdg" /><summary type="html"><![CDATA[AI, Wechaty, Angular, and mix them altogether in JavaScript]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://wechaty.js.org/assets/2022/01-angular-tensorflow-js/ai-angular-tensorflow-js.webp" /><media:content medium="image" url="https://wechaty.js.org/assets/2022/01-angular-tensorflow-js/ai-angular-tensorflow-js.webp" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>